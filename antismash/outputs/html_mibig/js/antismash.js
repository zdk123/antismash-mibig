/*! antismash-js, version: 0.5.0 */
var viewer=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=18)}([function(t,e,n){"use strict";n.r(e);var r="http://www.w3.org/1999/xhtml",i={svg:"http://www.w3.org/2000/svg",xhtml:r,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},o=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),i.hasOwnProperty(e)?{space:i[e],local:t}:t};var s=function(t){var e=o(t);return(e.local?function(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}:function(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===r&&e.documentElement.namespaceURI===r?e.createElement(t):e.createElementNS(n,t)}})(e)};function a(){}var l=function(t){return null==t?a:function(){return this.querySelector(t)}};function u(){return[]}var h=function(t){return null==t?u:function(){return this.querySelectorAll(t)}},c=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var g=document.documentElement;if(!g.matches){var d=g.webkitMatchesSelector||g.msMatchesSelector||g.mozMatchesSelector||g.oMatchesSelector;c=function(t){return function(){return d.call(this,t)}}}}var f=c,p=function(t){return new Array(t.length)};function v(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}v.prototype={constructor:v,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var m="$";function y(t,e,n,r,i,o){for(var s,a=0,l=e.length,u=o.length;a<u;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new v(t,o[a]);for(;a<l;++a)(s=e[a])&&(i[a]=s)}function b(t,e,n,r,i,o,s){var a,l,u,h={},c=e.length,g=o.length,d=new Array(c);for(a=0;a<c;++a)(l=e[a])&&(d[a]=u=m+s.call(l,l.__data__,a,e),u in h?i[a]=l:h[u]=l);for(a=0;a<g;++a)(l=h[u=m+s.call(t,o[a],a,o)])?(r[a]=l,l.__data__=o[a],h[u]=null):n[a]=new v(t,o[a]);for(a=0;a<c;++a)(l=e[a])&&h[d[a]]===l&&(i[a]=l)}function w(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var x=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function A(t,e){return t.style.getPropertyValue(e)||x(t).getComputedStyle(t,null).getPropertyValue(e)}function C(t){return t.trim().split(/^|\s+/)}function S(t){return t.classList||new M(t)}function M(t){this._node=t,this._names=C(t.getAttribute("class")||"")}function _(t,e){for(var n=S(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function $(t,e){for(var n=S(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}M.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function T(){this.textContent=""}function R(){this.innerHTML=""}function k(){this.nextSibling&&this.parentNode.appendChild(this)}function N(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function P(){return null}function I(){var t=this.parentNode;t&&t.removeChild(this)}function L(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function D(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}var O={},E=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(O={mouseenter:"mouseover",mouseleave:"mouseout"}));function B(t,e,n){return t=F(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function F(t,e,n){return function(r){var i=E;E=r;try{t.call(this,this.__data__,e,n)}finally{E=i}}}function j(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function z(t,e,n){var r=O.hasOwnProperty(t.type)?B:F;return function(i,o,s){var a,l=this.__on,u=r(e,o,s);if(l)for(var h=0,c=l.length;h<c;++h)if((a=l[h]).type===t.type&&a.name===t.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=u,a.capture=n),void(a.value=e);this.addEventListener(t.type,u,n),a={type:t.type,name:t.name,value:e,listener:u,capture:n},l?l.push(a):this.__on=[a]}}function H(t,e,n,r){var i=E;t.sourceEvent=E,E=t;try{return e.apply(n,r)}finally{E=i}}function U(t,e,n){var r=x(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}var V=[null];function q(t,e){this._groups=t,this._parents=e}function W(){return new q([[document.documentElement]],V)}q.prototype=W.prototype={constructor:q,select:function(t){"function"!=typeof t&&(t=l(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s,a=e[i],u=a.length,h=r[i]=new Array(u),c=0;c<u;++c)(o=a[c])&&(s=t.call(o,o.__data__,c,a))&&("__data__"in o&&(s.__data__=o.__data__),h[c]=s);return new q(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=h(t));for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s,a=e[o],l=a.length,u=0;u<l;++u)(s=a[u])&&(r.push(t.call(s,s.__data__,u,a)),i.push(s));return new q(r,i)},filter:function(t){"function"!=typeof t&&(t=f(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s=e[i],a=s.length,l=r[i]=[],u=0;u<a;++u)(o=s[u])&&t.call(o,o.__data__,u,s)&&l.push(o);return new q(r,this._parents)},data:function(t,e){if(!t)return f=new Array(this.size()),h=-1,this.each(function(t){f[++h]=t}),f;var n,r=e?b:y,i=this._parents,o=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var s=o.length,a=new Array(s),l=new Array(s),u=new Array(s),h=0;h<s;++h){var c=i[h],g=o[h],d=g.length,f=t.call(c,c&&c.__data__,h,i),p=f.length,v=l[h]=new Array(p),m=a[h]=new Array(p);r(c,g,v,m,u[h]=new Array(d),f,e);for(var w,x,A=0,C=0;A<p;++A)if(w=v[A]){for(A>=C&&(C=A+1);!(x=m[C])&&++C<p;);w._next=x||null}}return(a=new q(a,i))._enter=l,a._exit=u,a},enter:function(){return new q(this._enter||this._groups.map(p),this._parents)},exit:function(){return new q(this._exit||this._groups.map(p),this._parents)},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var l,u=e[a],h=n[a],c=u.length,g=s[a]=new Array(c),d=0;d<c;++d)(l=u[d]||h[d])&&(g[d]=l);for(;a<r;++a)s[a]=e[a];return new q(s,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,s=i[o];--o>=0;)(r=i[o])&&(s&&s!==r.nextSibling&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=w);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s,a=n[o],l=a.length,u=i[o]=new Array(l),h=0;h<l;++h)(s=a[h])&&(u[h]=s);u.sort(e)}return new q(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null},size:function(){var t=0;return this.each(function(){++t}),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],s=0,a=o.length;s<a;++s)(i=o[s])&&t.call(i,i.__data__,s,o);return this},attr:function(t,e){var n=o(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}}:"function"==typeof e?n.local?function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}:function(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}:n.local?function(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}:function(t,e){return function(){this.setAttribute(t,e)}})(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?function(t){return function(){this.style.removeProperty(t)}}:"function"==typeof e?function(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}:function(t,e,n){return function(){this.style.setProperty(t,e,n)}})(t,e,null==n?"":n)):A(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?function(t){return function(){delete this[t]}}:"function"==typeof e?function(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}:function(t,e){return function(){this[t]=e}})(t,e)):this.node()[t]},classed:function(t,e){var n=C(t+"");if(arguments.length<2){for(var r=S(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?function(t,e){return function(){(e.apply(this,arguments)?_:$)(this,t)}}:e?function(t){return function(){_(this,t)}}:function(t){return function(){$(this,t)}})(n,e))},text:function(t){return arguments.length?this.each(null==t?T:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}:function(t){return function(){this.textContent=t}})(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?R:("function"==typeof t?function(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}:function(t){return function(){this.innerHTML=t}})(t)):this.node().innerHTML},raise:function(){return this.each(k)},lower:function(){return this.each(N)},append:function(t){var e="function"==typeof t?t:s(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:s(t),r=null==e?P:"function"==typeof e?e:l(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(I)},clone:function(t){return this.select(t?D:L)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?z:j,null==n&&(n=!1),r=0;r<s;++r)this.each(a(o[r],e,n));return this}var a=this.node().__on;if(a)for(var l,u=0,h=a.length;u<h;++u)for(r=0,l=a[u];r<s;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?function(t,e){return function(){return U(this,t,e.apply(this,arguments))}}:function(t,e){return function(){return U(this,t,e)}})(t,e))}};var Y=W,X=function(t){return"string"==typeof t?new q([[document.querySelector(t)]],[document.documentElement]):new q([[t]],V)},Z=function(t){return X(s(t).call(document.documentElement))},G=0;function K(){return new Q}function Q(){this._="@"+(++G).toString(36)}Q.prototype=K.prototype={constructor:Q,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var J=function(){for(var t,e=E;t=e.sourceEvent;)e=t;return e},tt=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]},et=function(t){var e=J();return e.changedTouches&&(e=e.changedTouches[0]),tt(t,e)},nt=function(t){return"string"==typeof t?new q([document.querySelectorAll(t)],[document.documentElement]):new q([null==t?[]:t],V)},rt=function(t,e,n){arguments.length<3&&(n=e,e=J().changedTouches);for(var r,i=0,o=e?e.length:0;i<o;++i)if((r=e[i]).identifier===n)return tt(t,r);return null},it=function(t,e){null==e&&(e=J().touches);for(var n=0,r=e?e.length:0,i=new Array(r);n<r;++n)i[n]=tt(t,e[n]);return i};n.d(e,"create",function(){return Z}),n.d(e,"creator",function(){return s}),n.d(e,"local",function(){return K}),n.d(e,"matcher",function(){return f}),n.d(e,"mouse",function(){return et}),n.d(e,"namespace",function(){return o}),n.d(e,"namespaces",function(){return i}),n.d(e,"clientPoint",function(){return tt}),n.d(e,"select",function(){return X}),n.d(e,"selectAll",function(){return nt}),n.d(e,"selection",function(){return Y}),n.d(e,"selector",function(){return l}),n.d(e,"selectorAll",function(){return h}),n.d(e,"style",function(){return A}),n.d(e,"touch",function(){return rt}),n.d(e,"touches",function(){return it}),n.d(e,"window",function(){return x}),n.d(e,"event",function(){return E}),n.d(e,"customEvent",function(){return H})},function(t,e,n){"use strict";var r=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function i(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function o(){}var s="\\s*([+-]?\\d+)\\s*",a="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",u=/^#([0-9a-f]{3})$/,h=/^#([0-9a-f]{6})$/,c=new RegExp("^rgb\\("+[s,s,s]+"\\)$"),g=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),d=new RegExp("^rgba\\("+[s,s,s,a]+"\\)$"),f=new RegExp("^rgba\\("+[l,l,l,a]+"\\)$"),p=new RegExp("^hsl\\("+[a,l,l]+"\\)$"),v=new RegExp("^hsla\\("+[a,l,l,a]+"\\)$"),m={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function y(t){var e;return t=(t+"").trim().toLowerCase(),(e=u.exec(t))?new C((e=parseInt(e[1],16))>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):(e=h.exec(t))?b(parseInt(e[1],16)):(e=c.exec(t))?new C(e[1],e[2],e[3],1):(e=g.exec(t))?new C(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=d.exec(t))?w(e[1],e[2],e[3],e[4]):(e=f.exec(t))?w(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=p.exec(t))?M(e[1],e[2]/100,e[3]/100,1):(e=v.exec(t))?M(e[1],e[2]/100,e[3]/100,e[4]):m.hasOwnProperty(t)?b(m[t]):"transparent"===t?new C(NaN,NaN,NaN,0):null}function b(t){return new C(t>>16&255,t>>8&255,255&t,1)}function w(t,e,n,r){return r<=0&&(t=e=n=NaN),new C(t,e,n,r)}function x(t){return t instanceof o||(t=y(t)),t?new C((t=t.rgb()).r,t.g,t.b,t.opacity):new C}function A(t,e,n,r){return 1===arguments.length?x(t):new C(t,e,n,null==r?1:r)}function C(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function S(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function M(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new $(t,e,n,r)}function _(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof $)return new $(t.h,t.s,t.l,t.opacity);if(t instanceof o||(t=y(t)),!t)return new $;if(t instanceof $)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),a=NaN,l=s-i,u=(s+i)/2;return l?(a=e===s?(n-r)/l+6*(n<r):n===s?(r-e)/l+2:(e-n)/l+4,l/=u<.5?s+i:2-s-i,a*=60):l=u>0&&u<1?0:a,new $(a,l,u,t.opacity)}(t):new $(t,e,n,null==r?1:r)}function $(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function T(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}r(o,y,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),r(C,A,i(o,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new C(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new C(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+S(this.r)+S(this.g)+S(this.b)},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),r($,_,i(o,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new $(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new $(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new C(T(t>=240?t-240:t+120,i,r),T(t,i,r),T(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var R=Math.PI/180,k=180/Math.PI,N=.96422,P=1,I=.82521,L=4/29,D=6/29,O=3*D*D,E=D*D*D;function B(t){if(t instanceof j)return new j(t.l,t.a,t.b,t.opacity);if(t instanceof Y){if(isNaN(t.h))return new j(t.l,0,0,t.opacity);var e=t.h*R;return new j(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof C||(t=x(t));var n,r,i=V(t.r),o=V(t.g),s=V(t.b),a=z((.2225045*i+.7168786*o+.0606169*s)/P);return i===o&&o===s?n=r=a:(n=z((.4360747*i+.3850649*o+.1430804*s)/N),r=z((.0139322*i+.0971045*o+.7141733*s)/I)),new j(116*a-16,500*(n-a),200*(a-r),t.opacity)}function F(t,e,n,r){return 1===arguments.length?B(t):new j(t,e,n,null==r?1:r)}function j(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function z(t){return t>E?Math.pow(t,1/3):t/O+L}function H(t){return t>D?t*t*t:O*(t-L)}function U(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function V(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function q(t){if(t instanceof Y)return new Y(t.h,t.c,t.l,t.opacity);if(t instanceof j||(t=B(t)),0===t.a&&0===t.b)return new Y(NaN,0,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*k;return new Y(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function W(t,e,n,r){return 1===arguments.length?q(t):new Y(t,e,n,null==r?1:r)}function Y(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}r(j,F,i(o,{brighter:function(t){return new j(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new j(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new C(U(3.1338561*(e=N*H(e))-1.6168667*(t=P*H(t))-.4906146*(n=I*H(n))),U(-.9787684*e+1.9161415*t+.033454*n),U(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),r(Y,W,i(o,{brighter:function(t){return new Y(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new Y(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return B(this).rgb()}}));var X=-.14861,Z=1.78277,G=-.29227,K=-.90649,Q=1.97294,J=Q*K,tt=Q*Z,et=Z*G-K*X;function nt(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof rt)return new rt(t.h,t.s,t.l,t.opacity);t instanceof C||(t=x(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(et*r+J*e-tt*n)/(et+J-tt),o=r-i,s=(Q*(n-i)-G*o)/K,a=Math.sqrt(s*s+o*o)/(Q*i*(1-i)),l=a?Math.atan2(s,o)*k-120:NaN;return new rt(l<0?l+360:l,a,i,t.opacity)}(t):new rt(t,e,n,null==r?1:r)}function rt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}r(rt,nt,i(o,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new rt(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new rt(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*R,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new C(255*(e+n*(X*r+Z*i)),255*(e+n*(G*r+K*i)),255*(e+n*(Q*r)),this.opacity)}})),n.d(e,"a",function(){return y}),n.d(e,"f",function(){return A}),n.d(e,"d",function(){return _}),n.d(e,"e",function(){return F}),n.d(e,"c",function(){return W}),n.d(e,"b",function(){return nt})},function(t,e,n){"use strict";var r=n(1);function i(t,e,n,r,i){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*n+(1+3*t+3*o-3*s)*r+s*i)/6}var o=function(t){return function(){return t}};function s(t,e){return function(n){return t+n*e}}function a(t,e){var n=e-t;return n?s(t,n>180||n<-180?n-360*Math.round(n/360):n):o(isNaN(t)?e:t)}function l(t){return 1==(t=+t)?u:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):o(isNaN(e)?n:e)}}function u(t,e){var n=e-t;return n?s(t,n):o(isNaN(t)?e:t)}var h=function t(e){var n=l(e);function i(t,e){var i=n((t=Object(r.f)(t)).r,(e=Object(r.f)(e)).r),o=n(t.g,e.g),s=n(t.b,e.b),a=u(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=o(e),t.b=s(e),t.opacity=a(e),t+""}}return i.gamma=t,i}(1);function c(t){return function(e){var n,i,o=e.length,s=new Array(o),a=new Array(o),l=new Array(o);for(n=0;n<o;++n)i=Object(r.f)(e[n]),s[n]=i.r||0,a[n]=i.g||0,l[n]=i.b||0;return s=t(s),a=t(a),l=t(l),i.opacity=1,function(t){return i.r=s(t),i.g=a(t),i.b=l(t),i+""}}}c(function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=t[r],s=t[r+1],a=r>0?t[r-1]:2*o-s,l=r<e-1?t[r+2]:2*s-o;return i((n-r/e)*e,a,o,s,l)}}),c(function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),o=t[(r+e-1)%e],s=t[r%e],a=t[(r+1)%e],l=t[(r+2)%e];return i((n-r/e)*e,o,s,a,l)}});var g=function(t,e){return e-=t=+t,function(n){return t+e*n}},d=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,f=new RegExp(d.source,"g");var p,v,m,y,b=function(t,e){var n,r,i,o=d.lastIndex=f.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(n=d.exec(t))&&(r=f.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:g(n,r)})),o=f.lastIndex;return o<e.length&&(i=e.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)a[(n=l[r]).i]=n.x(t);return a.join("")})},w=function(t,e){var n,i=typeof e;return null==e||"boolean"===i?o(e):("number"===i?g:"string"===i?(n=Object(r.a)(e))?(e=n,h):b:e instanceof r.a?h:e instanceof Date?function(t,e){var n=new Date;return e-=t=+t,function(r){return n.setTime(t+e*r),n}}:Array.isArray(e)?function(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),s=new Array(r);for(n=0;n<i;++n)o[n]=w(t[n],e[n]);for(;n<r;++n)s[n]=e[n];return function(t){for(n=0;n<i;++n)s[n]=o[n](t);return s}}:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=w(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}:g)(t,e)},x=function(t,e){return e-=t=+t,function(n){return Math.round(t+e*n)}},A=180/Math.PI,C={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},S=function(t,e,n,r,i,o){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*A,skewX:Math.atan(l)*A,scaleX:s,scaleY:a}};function M(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],l=[];return o=t(o),s=t(s),function(t,r,i,o,s,a){if(t!==i||r!==o){var l=s.push("translate(",null,e,null,n);a.push({i:l-4,x:g(t,i)},{i:l-2,x:g(r,o)})}else(i||o)&&s.push("translate("+i+e+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:g(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,s.rotate,a,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:g(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,s.skewX,a,l),function(t,e,n,r,o,s){if(t!==n||e!==r){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:g(t,n)},{i:a-2,x:g(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(t){for(var e,n=-1,r=l.length;++n<r;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var _=M(function(t){return"none"===t?C:(p||(p=document.createElement("DIV"),v=document.documentElement,m=document.defaultView),p.style.transform=t,t=m.getComputedStyle(v.appendChild(p),null).getPropertyValue("transform"),v.removeChild(p),t=t.slice(7,-1).split(","),S(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))},"px, ","px)","deg)"),$=M(function(t){return null==t?C:(y||(y=document.createElementNS("http://www.w3.org/2000/svg","g")),y.setAttribute("transform",t),(t=y.transform.baseVal.consolidate())?(t=t.matrix,S(t.a,t.b,t.c,t.d,t.e,t.f)):C)},", ",")",")");Math.SQRT2;function T(t){return function(e,n){var i=t((e=Object(r.d)(e)).h,(n=Object(r.d)(n)).h),o=u(e.s,n.s),s=u(e.l,n.l),a=u(e.opacity,n.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=s(t),e.opacity=a(t),e+""}}}T(a),T(u);function R(t){return function(e,n){var i=t((e=Object(r.c)(e)).h,(n=Object(r.c)(n)).h),o=u(e.c,n.c),s=u(e.l,n.l),a=u(e.opacity,n.opacity);return function(t){return e.h=i(t),e.c=o(t),e.l=s(t),e.opacity=a(t),e+""}}}R(a),R(u);function k(t){return function e(n){function i(e,i){var o=t((e=Object(r.b)(e)).h,(i=Object(r.b)(i)).h),s=u(e.s,i.s),a=u(e.l,i.l),l=u(e.opacity,i.opacity);return function(t){return e.h=o(t),e.s=s(t),e.l=a(Math.pow(t,n)),e.opacity=l(t),e+""}}return n=+n,i.gamma=e,i}(1)}k(a),k(u);n.d(e,"a",function(){return w}),n.d(e,"b",function(){return g}),n.d(e,"d",function(){return x}),n.d(e,"e",function(){return b}),n.d(e,"f",function(){return _}),n.d(e,"g",function(){return $}),n.d(e,"c",function(){return h})},function(t,e){class n{constructor(t,e){0==arguments.length?(this.x=0,this.y=0):1==arguments.length?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}clone(){return new n(this.x,this.y)}toString(){return"("+this.x+","+this.y+")"}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}divide(t){return this.x/=t,this.y/=t,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}invert(){return this.x=-this.x,this.y=-this.y,this}angle(){return Math.atan2(this.y,this.x)}distance(t){return Math.sqrt((t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y))}distanceSq(t){return(t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y)}clockwise(t){let e=this.y*t.x,n=this.x*t.y;return e>n?-1:e===n?0:1}relativeClockwise(t,e){let n=(this.y-t.y)*(e.x-t.x),r=(this.x-t.x)*(e.y-t.y);return n>r?-1:n===r?0:1}rotate(t){let e=new n(0,0),r=Math.cos(t),i=Math.sin(t);return e.x=this.x*r-this.y*i,e.y=this.x*i+this.y*r,this.x=e.x,this.y=e.y,this}rotateAround(t,e){let n=Math.sin(t),r=Math.cos(t);this.x-=e.x,this.y-=e.y;let i=this.x*r-this.y*n,o=this.x*n+this.y*r;return this.x=i+e.x,this.y=o+e.y,this}rotateTo(t,e,r=0){this.x+=.001,this.y-=.001;let i=n.subtract(this,e),o=n.subtract(t,e),s=n.angle(o,i);return this.rotateAround(s+r,e),this}rotateAwayFrom(t,e,n){this.rotateAround(n,e);let r=this.distanceSq(t);this.rotateAround(-2*n,e),this.distanceSq(t)<r&&this.rotateAround(2*n,e)}getRotateAwayFromAngle(t,e,n){let r=this.clone();r.rotateAround(n,e);let i=r.distanceSq(t);return r.rotateAround(-2*n,e),r.distanceSq(t)<i?n:-n}getRotateTowardsAngle(t,e,n){let r=this.clone();r.rotateAround(n,e);let i=r.distanceSq(t);return r.rotateAround(-2*n,e),r.distanceSq(t)>i?n:-n}getRotateToAngle(t,e){let r=n.subtract(this,e),i=n.subtract(t,e),o=n.angle(i,r);return Number.isNaN(o)?0:o}isInPolygon(t){let e=!1;for(let n=0,r=t.length-1;n<t.length;r=n++)t[n].y>this.y!=t[r].y>this.y&&this.x<(t[r].x-t[n].x)*(this.y-t[n].y)/(t[r].y-t[n].y)+t[n].x&&(e=!e);return e}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSq(){return this.x*this.x+this.y*this.y}normalize(){return this.divide(this.length()),this}normalized(){return n.divideScalar(this,this.length())}whichSide(t,e){return(this.x-t.x)*(e.y-t.y)-(this.y-t.y)*(e.x-t.x)}sameSideAs(t,e,n){let r=this.whichSide(t,e),i=n.whichSide(t,e);return r<0&&i<0||0==r&&0==i||r>0&&i>0}static add(t,e){return new n(t.x+e.x,t.y+e.y)}static subtract(t,e){return new n(t.x-e.x,t.y-e.y)}static multiply(t,e){return new n(t.x*e.x,t.y*e.y)}static multiplyScalar(t,e){return new n(t.x,t.y).multiplyScalar(e)}static midpoint(t,e){return new n((t.x+e.x)/2,(t.y+e.y)/2)}static normals(t,e){let r=n.subtract(e,t);return[new n(-r.y,r.x),new n(r.y,-r.x)]}static units(t,e){let r=n.subtract(e,t);return[new n(-r.y,r.x).normalize(),new n(r.y,-r.x).normalize()]}static divide(t,e){return new n(t.x/e.x,t.y/e.y)}static divideScalar(t,e){return new n(t.x/e,t.y/e)}static dot(t,e){return t.x*e.x+t.y*e.y}static angle(t,e){let r=n.dot(t,e);return Math.acos(r/(t.length()*e.length()))}static threePointangle(t,e,r){let i=n.subtract(e,t),o=n.subtract(r,e),s=t.distance(e),a=e.distance(r);return Math.acos(n.dot(i,o)/(s*a))}static scalarProjection(t,e){let r=e.normalized();return n.dot(t,r)}static averageDirection(t){let e=new n(0,0);for(var r=0;r<t.length;r++){let n=t[r];e.add(n)}return e.normalize()}}t.exports=n},function(t,e,n){const r=n(6),i=n(7),o=n(3);n(10);class s{constructor(t,e=0,n=0){this.id=null,this.value=t,this.position=new o(e||0,n||0),this.previousPosition=new o(0,0),this.parentVertexId=null,this.children=Array(),this.spanningTreeChildren=Array(),this.edges=Array(),this.positioned=!1,this.angle=null,this.dir=1,this.neighbourCount=0,this.neighbours=Array(),this.neighbouringElements=Array(),this.forcePositioned=!1}setPosition(t,e){this.position.x=t,this.position.y=e}setPositionFromVector(t){this.position.x=t.x,this.position.y=t.y}addChild(t){this.children.push(t),this.neighbours.push(t),this.neighbourCount++}addRingbondChild(t,e){if(this.children.push(t),this.value.bracket){let n=1;0===this.id&&0===this.value.bracket.hcount&&(n=0),1===this.value.bracket.hcount&&0===e&&(n=2),1===this.value.bracket.hcount&&1===e&&(n=this.neighbours.length<3?2:3),null===this.value.bracket.hcount&&0===e&&(n=1),null===this.value.bracket.hcount&&1===e&&(n=this.neighbours.length<3?1:2),this.neighbours.splice(n,0,t)}else this.neighbours.push(t);this.neighbourCount++}setParentVertexId(t){this.neighbourCount++,this.parentVertexId=t,this.neighbours.push(t)}isTerminal(){return!!this.value.hasAttachedPseudoElements||(null===this.parentVertexId&&this.children.length<2||0===this.children.length)}clone(){let t=new s(this.value,this.position.x,this.position.y);return t.id=this.id,t.previousPosition=new o(this.previousPosition.x,this.previousPosition.y),t.parentVertexId=this.parentVertexId,t.children=i.clone(this.children),t.spanningTreeChildren=i.clone(this.spanningTreeChildren),t.edges=i.clone(this.edges),t.positioned=this.positioned,t.angle=this.angle,t.forcePositioned=this.forcePositioned,t}equals(t){return this.id===t.id}getAngle(t=null,e=!1){let n=null;return n=t?o.subtract(this.position,t):o.subtract(this.position,this.previousPosition),e?r.toDeg(n.angle()):n.angle()}getTextDirection(t){let e=this.getDrawnNeighbours(t),n=Array();for(let r=0;r<e.length;r++)n.push(this.getAngle(t[e[r]].position));let i=r.meanAngle(n),o=Math.PI/2;return 2===(i=Math.round(Math.round(i/o)*o))?"down":-2===i?"up":0===i||-0===i?"right":3===i||-3===i?"left":"down"}getNeighbours(t=null){if(null===t)return this.neighbours.slice();let e=Array();for(let n=0;n<this.neighbours.length;n++)this.neighbours[n]!==t&&e.push(this.neighbours[n]);return e}getDrawnNeighbours(t){let e=Array();for(let n=0;n<this.neighbours.length;n++)t[this.neighbours[n]].value.isDrawn&&e.push(this.neighbours[n]);return e}getNeighbourCount(){return this.neighbourCount}getSpanningTreeNeighbours(t=null){let e=Array();for(let n=0;n<this.spanningTreeChildren.length;n++)void 0!==t&&t==this.spanningTreeChildren[n]||e.push(this.spanningTreeChildren[n]);return null!=this.parentVertexId&&(void 0!==t&&t==this.parentVertexId||e.push(this.parentVertexId)),e}getNextInRing(t,e,n){let r=this.getNeighbours();for(let o=0;o<r.length;o++)if(i.contains(t[r[o]].value.rings,{value:e})&&r[o]!=n)return r[o];return null}}t.exports=s},function(t,e,n){const r=n(7),i=n(3),o=(n(4),n(15));class s{constructor(t){this.id=null,this.members=t,this.edges=[],this.insiders=[],this.neighbours=[],this.positioned=!1,this.center=new i(0,0),this.rings=[],this.isBridged=!1,this.isPartOfBridged=!1,this.isSpiro=!1,this.isFused=!1,this.centralAngle=0,this.canFlip=!0}clone(){let t=new s(this.members);return t.id=this.id,t.insiders=r.clone(this.insiders),t.neighbours=r.clone(this.neighbours),t.positioned=this.positioned,t.center=this.center.clone(),t.rings=r.clone(this.rings),t.isBridged=this.isBridged,t.isPartOfBridged=this.isPartOfBridged,t.isSpiro=this.isSpiro,t.isFused=this.isFused,t.centralAngle=this.centralAngle,t.canFlip=this.canFlip,t}getSize(){return this.members.length}getPolygon(t){let e=[];for(let n=0;n<this.members.length;n++)e.push(t[this.members[n]].position);return e}getAngle(){return Math.PI-this.centralAngle}eachMember(t,e,n,r){let i=n=n||0===n?n:this.members[0],o=0;for(;null!=i&&o<100;){let s=i;e(s),i=t[i].getNextInRing(t,this.id,r),r=s,i==n&&(i=null),o++}}getOrderedNeighbours(t){let e=Array(this.neighbours.length);for(let n=0;n<this.neighbours.length;n++){let r=o.getVertices(t,this.id,this.neighbours[n]);e[n]={n:r.length,neighbour:this.neighbours[n]}}return e.sort(function(t,e){return e.n-t.n}),e}isBenzeneLike(t){let e=this.getDoubleBondCount(t),n=this.members.length;return 3===e&&6===n||2===e&&5===n}getDoubleBondCount(t){let e=0;for(let n=0;n<this.members.length;n++){let r=t[this.members[n]].value;"="!==r.bondType&&"="!==r.branchBond||e++}return e}contains(t){for(let e=0;e<this.members.length;e++)if(this.members[e]==t)return!0;return!1}}t.exports=s},function(t,e){class n{static round(t,e){return e=e||1,Number(Math.round(t+"e"+e)+"e-"+e)}static meanAngle(t){let e=0,n=0;for(var r=0;r<t.length;r++)e+=Math.sin(t[r]),n+=Math.cos(t[r]);return Math.atan2(e/t.length,n/t.length)}static innerAngle(t){return n.toRad(180*(t-2)/t)}static polyCircumradius(t,e){return t/(2*Math.sin(Math.PI/e))}static apothem(t,e){return t*Math.cos(Math.PI/e)}static apothemFromSideLength(t,e){let r=n.polyCircumradius(t,e);return n.apothem(r,e)}static centralAngle(t){return n.toRad(360/t)}static toDeg(t){return t*n.degFactor}static toRad(t){return t*n.radFactor}static parityOfPermutation(t){let e=new Uint8Array(t.length),n=0,r=function(n,i=0){return 1===e[n]?i:(i++,e[n]=1,r(t[n],i))};for(var i=0;i<t.length;i++){if(1===e[i])continue;n+=1-r(i)%2}return n%2?-1:1}static get radFactor(){return Math.PI/180}static get degFactor(){return 180/Math.PI}static get twoPI(){return 2*Math.PI}}t.exports=n},function(t,e){class n{static clone(t){let e=Array.isArray(t)?Array():{};for(let r in t){let i=t[r];"function"==typeof i.clone?e[r]=i.clone():e[r]="object"==typeof i?n.clone(i):i}return e}static equals(t,e){if(t.length!==e.length)return!1;let n=t.slice().sort(),r=e.slice().sort();for(var i=0;i<n.length;i++)if(n[i]!==r[i])return!1;return!0}static print(t){if(0==t.length)return"";let e="(";for(let n=0;n<t.length;n++)e+=t[n].id?t[n].id+", ":t[n]+", ";return(e=e.substring(0,e.length-2))+")"}static each(t,e){for(let n=0;n<t.length;n++)e(t[n])}static get(t,e,n){for(let r=0;r<t.length;r++)if(t[r][e]==n)return t[r]}static contains(t,e){if(e.property||e.func){if(e.func){for(let n=0;n<t.length;n++)if(e.func(t[n]))return!0}else for(let n=0;n<t.length;n++)if(t[n][e.property]==e.value)return!0}else for(let n=0;n<t.length;n++)if(t[n]==e.value)return!0;return!1}static intersection(t,e){let n=new Array;for(let r=0;r<t.length;r++)for(let i=0;i<e.length;i++)t[r]===e[i]&&n.push(t[r]);return n}static unique(t){let e={};return t.filter(function(t){return void 0===e[t]&&(e[t]=!0)})}static count(t,e){let n=0;for(let r=0;r<t.length;r++)t[r]===e&&n++;return n}static toggle(t,e){let n=Array(),r=!1;for(let i=0;i<t.length;i++)t[i]!==e?n.push(t[i]):r=!0;return r||n.push(e),n}static remove(t,e){let n=Array();for(let r=0;r<t.length;r++)t[r]!==e&&n.push(t[r]);return n}static removeUnique(t,e){let n=t.indexOf(e);return n>-1&&t.splice(n,1),t}static removeAll(t,e){return t.filter(function(t){return-1===e.indexOf(t)})}static merge(t,e){let n=new Array(t.length+e.length);for(let e=0;e<t.length;e++)n[e]=t[e];for(let r=0;r<e.length;r++)n[t.length+r]=e[r];return n}static containsAll(t,e){let n=0;for(let r=0;r<t.length;r++)for(let i=0;i<e.length;i++)t[r]===e[i]&&n++;return n===e.length}static sortByAtomicNumberDesc(t){let e=t.map(function(t,e){return{index:e,value:t.atomicNumber.split(".").map(Number)}});return e.sort(function(t,e){let n=Math.min(e.value.length,t.value.length),r=0;for(;r<n&&e.value[r]===t.value[r];)r++;return r===n?e.value.length-t.value.length:e.value[r]-t.value[r]}),e.map(function(e){return t[e.index]})}static deepCopy(t){let e=Array();for(let r=0;r<t.length;r++){let i=t[r];i instanceof Array?e[r]=n.deepCopy(i):e[r]=i}return e}}t.exports=n},function(t,e,n){"use strict";var r={value:function(){}};function i(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r)throw new Error("illegal type: "+t);r[t]=[]}return new o(r)}function o(t){this._=t}function s(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function a(t,e,n){for(var i=0,o=t.length;i<o;++i)if(t[i].name===e){t[i]=r,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}o.prototype=i.prototype={constructor:o,on:function(t,e){var n,r,i=this._,o=(r=i,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),l=-1,u=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++l<u;)if(n=(t=o[l]).type)i[n]=a(i[n],t.name,e);else if(null==e)for(n in i)i[n]=a(i[n],t.name,null);return this}for(;++l<u;)if((n=(t=o[l]).type)&&(n=s(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new o(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};var l=i;n.d(e,"a",function(){return l})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.copyToClipboard=function(){const t=document.createElement("textarea");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="1px",t.style.height="1px",t.value=$(this).attr("data-seq")||"",document.body.appendChild(t),t.select();try{document.execCommand("copy"),alert("Sequence copied to clipboard")}finally{document.body.removeChild(t)}},e.clipboardCopyConstruct=function(t){return`<span class="clipboard-copy" data-seq="${t}">Copy to clipboard</span>`}},function(t,e,n){const r=n(7);n(4),n(5);class i{constructor(t,e="-"){this.element=1===t.length?t.toUpperCase():t,this.drawExplicit=!1,this.ringbonds=Array(),this.rings=Array(),this.bondType=e,this.branchBond=null,this.isBridge=!1,this.isBridgeNode=!1,this.originalRings=Array(),this.bridgedRing=null,this.anchoredRings=Array(),this.bracket=null,this.plane=0,this.attachedPseudoElements={},this.hasAttachedPseudoElements=!1,this.isDrawn=!0,this.isConnectedToRing=!1,this.neighbouringElements=Array(),this.isPartOfAromaticRing=t!==this.element,this.bondCount=0,this.chirality="",this.isStereoCenter=!1,this.priority=0,this.mainChain=!1,this.hydrogenDirection="down",this.subtreeDepth=1,this.hasHydrogen=!1}addNeighbouringElement(t){this.neighbouringElements.push(t)}attachPseudoElement(t,e,n=0,r=0){null===n&&(n=0),null===r&&(r=0);let i=n+t+r;this.attachedPseudoElements[i]?this.attachedPseudoElements[i].count+=1:this.attachedPseudoElements[i]={element:t,count:1,hydrogenCount:n,previousElement:e,charge:r},this.hasAttachedPseudoElements=!0}getAttachedPseudoElements(){let t={},e=this;return Object.keys(this.attachedPseudoElements).sort().forEach(function(n){t[n]=e.attachedPseudoElements[n]}),t}getAttachedPseudoElementsCount(){return Object.keys(this.attachedPseudoElements).length}isHeteroAtom(){return"C"!==this.element&&"H"!==this.element}addAnchoredRing(t){r.contains(this.anchoredRings,{value:t})||this.anchoredRings.push(t)}getRingbondCount(){return this.ringbonds.length}backupRings(){this.originalRings=Array(this.rings.length);for(let t=0;t<this.rings.length;t++)this.originalRings[t]=this.rings[t]}restoreRings(){this.rings=Array(this.originalRings.length);for(let t=0;t<this.originalRings.length;t++)this.rings[t]=this.originalRings[t]}haveCommonRingbond(t,e){for(let n=0;n<t.ringbonds.length;n++)for(let r=0;r<e.ringbonds.length;r++)if(t.ringbonds[n].id==e.ringbonds[r].id)return!0;return!1}neighbouringElementsEqual(t){if(t.length!==this.neighbouringElements.length)return!1;t.sort(),this.neighbouringElements.sort();for(var e=0;e<this.neighbouringElements.length;e++)if(t[e]!==this.neighbouringElements[e])return!1;return!0}getAtomicNumber(){return i.atomicNumbers[this.element]}getMaxBonds(){return i.maxBonds[this.element]}static get maxBonds(){return{H:1,C:4,N:3,O:2,P:3,S:2,B:3,F:1,I:1,Cl:1,Br:1}}static get atomicNumbers(){return{H:1,He:2,Li:3,Be:4,B:5,b:5,C:6,c:6,N:7,n:7,O:8,o:8,F:9,Ne:10,Na:11,Mg:12,Al:13,Si:14,P:15,p:15,S:16,s:16,Cl:17,Ar:18,K:19,Ca:20,Sc:21,Ti:22,V:23,Cr:24,Mn:25,Fe:26,Co:27,Ni:28,Cu:29,Zn:30,Ga:31,Ge:32,As:33,Se:34,Br:35,Kr:36,Rb:37,Sr:38,Y:39,Zr:40,Nb:41,Mo:42,Tc:43,Ru:44,Rh:45,Pd:46,Ag:47,Cd:48,In:49,Sn:50,Sb:51,Te:52,I:53,Xe:54,Cs:55,Ba:56,La:57,Ce:58,Pr:59,Nd:60,Pm:61,Sm:62,Eu:63,Gd:64,Tb:65,Dy:66,Ho:67,Er:68,Tm:69,Yb:70,Lu:71,Hf:72,Ta:73,W:74,Re:75,Os:76,Ir:77,Pt:78,Au:79,Hg:80,Tl:81,Pb:82,Bi:83,Po:84,At:85,Rn:86,Fr:87,Ra:88,Ac:89,Th:90,Pa:91,U:92,Np:93,Pu:94,Am:95,Cm:96,Bk:97,Cf:98,Es:99,Fm:100,Md:101,No:102,Lr:103,Rf:104,Db:105,Sg:106,Bh:107,Hs:108,Mt:109,Ds:110,Rg:111,Cn:112,Uut:113,Uuq:114,Uup:115,Uuh:116,Uus:117,Uuo:118}}static get mass(){return{H:1,He:2,Li:3,Be:4,B:5,b:5,C:6,c:6,N:7,n:7,O:8,o:8,F:9,Ne:10,Na:11,Mg:12,Al:13,Si:14,P:15,p:15,S:16,s:16,Cl:17,Ar:18,K:19,Ca:20,Sc:21,Ti:22,V:23,Cr:24,Mn:25,Fe:26,Co:27,Ni:28,Cu:29,Zn:30,Ga:31,Ge:32,As:33,Se:34,Br:35,Kr:36,Rb:37,Sr:38,Y:39,Zr:40,Nb:41,Mo:42,Tc:43,Ru:44,Rh:45,Pd:46,Ag:47,Cd:48,In:49,Sn:50,Sb:51,Te:52,I:53,Xe:54,Cs:55,Ba:56,La:57,Ce:58,Pr:59,Nd:60,Pm:61,Sm:62,Eu:63,Gd:64,Tb:65,Dy:66,Ho:67,Er:68,Tm:69,Yb:70,Lu:71,Hf:72,Ta:73,W:74,Re:75,Os:76,Ir:77,Pt:78,Au:79,Hg:80,Tl:81,Pb:82,Bi:83,Po:84,At:85,Rn:86,Fr:87,Ra:88,Ac:89,Th:90,Pa:91,U:92,Np:93,Pu:94,Am:95,Cm:96,Bk:97,Cf:98,Es:99,Fm:100,Md:101,No:102,Lr:103,Rf:104,Db:105,Sg:106,Bh:107,Hs:108,Mt:109,Ds:110,Rg:111,Cn:112,Uut:113,Uuq:114,Uup:115,Uuh:116,Uus:117,Uuo:118}}}t.exports=i},function(t,e,n){"use strict";n.r(e);var r=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},i=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return r(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}};var o=i(r),s=o.right,a=(o.left,s);var l=function(t){return null===t?NaN:+t},u=Array.prototype,h=(u.slice,u.map,function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}),c=Math.sqrt(50),g=Math.sqrt(10),d=Math.sqrt(2),f=function(t,e,n){var r,i,o,s,a=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(s=p(t,e,n))||!isFinite(s))return[];if(s>0)for(t=Math.ceil(t/s),e=Math.floor(e/s),o=new Array(i=Math.ceil(e-t+1));++a<i;)o[a]=(t+a)*s;else for(t=Math.floor(t*s),e=Math.ceil(e*s),o=new Array(i=Math.ceil(t-e+1));++a<i;)o[a]=(t-a)/s;return r&&o.reverse(),o};function p(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=c?10:o>=g?5:o>=d?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=c?10:o>=g?5:o>=d?2:1)}function v(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=c?i*=10:o>=g?i*=5:o>=d&&(i*=2),e<t?-i:i}var m=function(t,e,n){if(null==n&&(n=l),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),s=+n(t[o],o,t);return s+(+n(t[o+1],o+1,t)-s)*(i-o)}};function y(){}function b(t,e){var n=new y;if(t instanceof y)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e(r=t[i],i,t),r)}else if(t)for(var s in t)n.set(s,t[s]);return n}y.prototype=b.prototype={constructor:y,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var w=b;function x(){}var A=w.prototype;function C(t,e){var n=new x;if(t instanceof x)t.each(function(t){n.add(t)});else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}x.prototype=C.prototype={constructor:x,has:A.has,add:function(t){return this["$"+(t+="")]=t,this},remove:A.remove,clear:A.clear,values:A.keys,size:A.size,empty:A.empty,each:A.each};var S=Array.prototype,M=S.map,_=S.slice,$={name:"implicit"};function T(t){var e=w(),n=[],r=$;function i(i){var o=i+"",s=e.get(o);if(!s){if(r!==$)return r;e.set(o,s=n.push(i))}return t[(s-1)%t.length]}return t=null==t?[]:_.call(t),i.domain=function(t){if(!arguments.length)return n.slice();n=[],e=w();for(var r,o,s=-1,a=t.length;++s<a;)e.has(o=(r=t[s])+"")||e.set(o,n.push(r));return i},i.range=function(e){return arguments.length?(t=_.call(e),i):t.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return T().domain(n).range(t).unknown(r)},i}function R(){var t,e,n=T().unknown(void 0),r=n.domain,i=n.range,o=[0,1],s=!1,a=0,l=0,u=.5;function c(){var n=r().length,c=o[1]<o[0],g=o[c-0],d=o[1-c];t=(d-g)/Math.max(1,n-a+2*l),s&&(t=Math.floor(t)),g+=(d-g-t*(n-a))*u,e=t*(1-a),s&&(g=Math.round(g),e=Math.round(e));var f=h(n).map(function(e){return g+t*e});return i(c?f.reverse():f)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),c()):r()},n.range=function(t){return arguments.length?(o=[+t[0],+t[1]],c()):o.slice()},n.rangeRound=function(t){return o=[+t[0],+t[1]],s=!0,c()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(s=!!t,c()):s},n.padding=function(t){return arguments.length?(a=l=Math.max(0,Math.min(1,t)),c()):a},n.paddingInner=function(t){return arguments.length?(a=Math.max(0,Math.min(1,t)),c()):a},n.paddingOuter=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),c()):l},n.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),c()):u},n.copy=function(){return R().domain(r()).range(o).round(s).paddingInner(a).paddingOuter(l).align(u)},c()}function k(){return function t(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return t(n())},e}(R().paddingInner(1))}var N=n(2),P=function(t){return function(){return t}},I=function(t){return+t},L=[0,1];function D(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:P(e)}function O(t,e,n,r){var i=t[0],o=t[1],s=e[0],a=e[1];return o<i?(i=n(o,i),s=r(a,s)):(i=n(i,o),s=r(s,a)),function(t){return s(i(t))}}function E(t,e,n,r){var i=Math.min(t.length,e.length)-1,o=new Array(i),s=new Array(i),l=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++l<i;)o[l]=n(t[l],t[l+1]),s[l]=r(e[l],e[l+1]);return function(e){var n=a(t,e,1,i)-1;return s[n](o[n](e))}}function B(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp())}function F(t,e){var n,r,i,o=L,s=L,a=N.a,l=!1;function u(){return n=Math.min(o.length,s.length)>2?E:O,r=i=null,h}function h(e){return(r||(r=n(o,s,l?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=e?0:t>=n?1:r(t)}}}(t):t,a)))(+e)}return h.invert=function(t){return(i||(i=n(s,o,D,l?function(t){return function(e,n){var r=t(e=+e,n=+n);return function(t){return t<=0?e:t>=1?n:r(t)}}}(e):e)))(+t)},h.domain=function(t){return arguments.length?(o=M.call(t,I),u()):o.slice()},h.range=function(t){return arguments.length?(s=_.call(t),u()):s.slice()},h.rangeRound=function(t){return s=_.call(t),a=N.d,u()},h.clamp=function(t){return arguments.length?(l=!!t,u()):l},h.interpolate=function(t){return arguments.length?(a=t,u()):a},u()}var j=function(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]},z=function(t){return(t=j(Math.abs(t)))?t[1]:NaN},H=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function U(t){return new V(t)}function V(t){if(!(e=H.exec(t)))throw new Error("invalid format: "+t);var e;this.fill=e[1]||" ",this.align=e[2]||">",this.sign=e[3]||"-",this.symbol=e[4]||"",this.zero=!!e[5],this.width=e[6]&&+e[6],this.comma=!!e[7],this.precision=e[8]&&+e[8].slice(1),this.trim=!!e[9],this.type=e[10]||""}U.prototype=V.prototype,V.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var q,W,Y,X,Z=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(i>0){if(!+t[r])break t;i=0}}return i>0?t.slice(0,i)+t.slice(e+1):t},G=function(t,e){var n=j(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},K={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return G(100*t,e)},r:G,s:function(t,e){var n=j(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(q=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+j(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Q=function(t){return t},J=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];W=function(t){var e,n,r=t.grouping&&t.thousands?(e=t.grouping,n=t.thousands,function(t,r){for(var i=t.length,o=[],s=0,a=e[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(t.substring(i-=a,i+a)),!((l+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(n)}):Q,i=t.currency,o=t.decimal,s=t.numerals?function(t){return function(e){return e.replace(/[0-9]/g,function(e){return t[+e]})}}(t.numerals):Q,a=t.percent||"%";function l(t){var e=(t=U(t)).fill,n=t.align,l=t.sign,u=t.symbol,h=t.zero,c=t.width,g=t.comma,d=t.precision,f=t.trim,p=t.type;"n"===p?(g=!0,p="g"):K[p]||(null==d&&(d=12),f=!0,p="g"),(h||"0"===e&&"="===n)&&(h=!0,e="0",n="=");var v="$"===u?i[0]:"#"===u&&/[boxX]/.test(p)?"0"+p.toLowerCase():"",m="$"===u?i[1]:/[%p]/.test(p)?a:"",y=K[p],b=/[defgprs%]/.test(p);function w(t){var i,a,u,w=v,x=m;if("c"===p)x=y(t)+x,t="";else{var A=(t=+t)<0;if(t=y(Math.abs(t),d),f&&(t=Z(t)),A&&0==+t&&(A=!1),w=(A?"("===l?l:"-":"-"===l||"("===l?"":l)+w,x=("s"===p?J[8+q/3]:"")+x+(A&&"("===l?")":""),b)for(i=-1,a=t.length;++i<a;)if(48>(u=t.charCodeAt(i))||u>57){x=(46===u?o+t.slice(i+1):t.slice(i))+x,t=t.slice(0,i);break}}g&&!h&&(t=r(t,1/0));var C=w.length+t.length+x.length,S=C<c?new Array(c-C+1).join(e):"";switch(g&&h&&(t=r(S+t,S.length?c-x.length:1/0),S=""),n){case"<":t=w+t+x+S;break;case"=":t=w+S+t+x;break;case"^":t=S.slice(0,C=S.length>>1)+w+t+x+S.slice(C);break;default:t=S+w+t+x}return s(t)}return d=null==d?6:/[gprs]/.test(p)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d)),w.toString=function(){return t+""},w}return{format:l,formatPrefix:function(t,e){var n=l(((t=U(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(z(e)/3))),i=Math.pow(10,-r),o=J[8+r/3];return function(t){return n(i*t)+o}}}}({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),Y=W.format,X=W.formatPrefix;var tt=function(t,e,n){var r,i=t[0],o=t[t.length-1],s=v(i,o,null==e?10:e);switch((n=U(null==n?",f":n)).type){case"s":var a=Math.max(Math.abs(i),Math.abs(o));return null!=n.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(z(e)/3)))-z(Math.abs(t)))}(s,a))||(n.precision=r),X(n,a);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,z(e)-z(t))+1}(s,Math.max(Math.abs(i),Math.abs(o))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=function(t){return Math.max(0,-z(Math.abs(t)))}(s))||(n.precision=r-2*("%"===n.type))}return Y(n)};function et(t){var e=t.domain;return t.ticks=function(t){var n=e();return f(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){return tt(e(),t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),o=0,s=i.length-1,a=i[o],l=i[s];return l<a&&(r=a,a=l,l=r,r=o,o=s,s=r),(r=p(a,l,n))>0?r=p(a=Math.floor(a/r)*r,l=Math.ceil(l/r)*r,n):r<0&&(r=p(a=Math.ceil(a*r)/r,l=Math.floor(l*r)/r,n)),r>0?(i[o]=Math.floor(a/r)*r,i[s]=Math.ceil(l/r)*r,e(i)):r<0&&(i[o]=Math.ceil(a*r)/r,i[s]=Math.floor(l*r)/r,e(i)),t},t}function nt(){var t=F(D,N.b);return t.copy=function(){return B(t,nt())},et(t)}function rt(){var t=[0,1];function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=M.call(n,I),e):t.slice()},e.copy=function(){return rt().domain(t)},et(e)}var it=function(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],s=t[i];return s<o&&(n=r,r=i,i=n,n=o,o=s,s=n),t[r]=e.floor(o),t[i]=e.ceil(s),t};function ot(t,e){return(e=Math.log(e/t))?function(n){return Math.log(n/t)/e}:P(e)}function st(t,e){return t<0?function(n){return-Math.pow(-e,n)*Math.pow(-t,1-n)}:function(n){return Math.pow(e,n)*Math.pow(t,1-n)}}function at(t){return isFinite(t)?+("1e"+t):t<0?0:t}function lt(t){return 10===t?at:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function ut(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function ht(t){return function(e){return-t(-e)}}function ct(){var t=F(ot,st).domain([1,10]),e=t.domain,n=10,r=ut(10),i=lt(10);function o(){return r=ut(n),i=lt(n),e()[0]<0&&(r=ht(r),i=ht(i)),t}return t.base=function(t){return arguments.length?(n=+t,o()):n},t.domain=function(t){return arguments.length?(e(t),o()):e()},t.ticks=function(t){var o,s=e(),a=s[0],l=s[s.length-1];(o=l<a)&&(g=a,a=l,l=g);var u,h,c,g=r(a),d=r(l),p=null==t?10:+t,v=[];if(!(n%1)&&d-g<p){if(g=Math.round(g)-1,d=Math.round(d)+1,a>0){for(;g<d;++g)for(h=1,u=i(g);h<n;++h)if(!((c=u*h)<a)){if(c>l)break;v.push(c)}}else for(;g<d;++g)for(h=n-1,u=i(g);h>=1;--h)if(!((c=u*h)<a)){if(c>l)break;v.push(c)}}else v=f(g,d,Math.min(d-g,p)).map(i);return o?v.reverse():v},t.tickFormat=function(e,o){if(null==o&&(o=10===n?".0e":","),"function"!=typeof o&&(o=Y(o)),e===1/0)return o;null==e&&(e=10);var s=Math.max(1,n*e/t.ticks().length);return function(t){var e=t/i(Math.round(r(t)));return e*n<n-.5&&(e*=n),e<=s?o(t):""}},t.nice=function(){return e(it(e(),{floor:function(t){return i(Math.floor(r(t)))},ceil:function(t){return i(Math.ceil(r(t)))}}))},t.copy=function(){return B(t,ct().base(n))},t}function gt(t,e){return t<0?-Math.pow(-t,e):Math.pow(t,e)}function dt(){var t=1,e=F(function(e,n){return(n=gt(n,t)-(e=gt(e,t)))?function(r){return(gt(r,t)-e)/n}:P(n)},function(e,n){return n=gt(n,t)-(e=gt(e,t)),function(r){return gt(e+n*r,1/t)}}),n=e.domain;return e.exponent=function(e){return arguments.length?(t=+e,n(n())):t},e.copy=function(){return B(e,dt().exponent(t))},et(e)}function ft(){return dt().exponent(.5)}function pt(){var t=[],e=[],n=[];function i(){var r=0,i=Math.max(1,e.length);for(n=new Array(i-1);++r<i;)n[r-1]=m(t,r/i);return o}function o(t){if(!isNaN(t=+t))return e[a(n,t)]}return o.invertExtent=function(r){var i=e.indexOf(r);return i<0?[NaN,NaN]:[i>0?n[i-1]:t[0],i<n.length?n[i]:t[t.length-1]]},o.domain=function(e){if(!arguments.length)return t.slice();t=[];for(var n,o=0,s=e.length;o<s;++o)null==(n=e[o])||isNaN(n=+n)||t.push(n);return t.sort(r),i()},o.range=function(t){return arguments.length?(e=_.call(t),i()):e.slice()},o.quantiles=function(){return n.slice()},o.copy=function(){return pt().domain(t).range(e)},o}function vt(){var t=0,e=1,n=1,r=[.5],i=[0,1];function o(t){if(t<=t)return i[a(r,t,0,n)]}function s(){var i=-1;for(r=new Array(n);++i<n;)r[i]=((i+1)*e-(i-n)*t)/(n+1);return o}return o.domain=function(n){return arguments.length?(t=+n[0],e=+n[1],s()):[t,e]},o.range=function(t){return arguments.length?(n=(i=_.call(t)).length-1,s()):i.slice()},o.invertExtent=function(o){var s=i.indexOf(o);return s<0?[NaN,NaN]:s<1?[t,r[0]]:s>=n?[r[n-1],e]:[r[s-1],r[s]]},o.copy=function(){return vt().domain([t,e]).range(i)},et(o)}function mt(){var t=[.5],e=[0,1],n=1;function r(r){if(r<=r)return e[a(t,r,0,n)]}return r.domain=function(i){return arguments.length?(t=_.call(i),n=Math.min(t.length,e.length-1),r):t.slice()},r.range=function(i){return arguments.length?(e=_.call(i),n=Math.min(t.length,e.length-1),r):e.slice()},r.invertExtent=function(n){var r=e.indexOf(n);return[t[r-1],t[r]]},r.copy=function(){return mt().domain(t).range(e)},r}var yt=new Date,bt=new Date;function wt(t,e,n,r){function i(e){return t(e=new Date(+e)),e}return i.floor=i,i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,o){var s,a=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return a;do{a.push(s=new Date(+n)),e(n,o),t(n)}while(s<n&&n<r);return a},i.filter=function(n){return wt(function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)},function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})},n&&(i.count=function(e,r){return yt.setTime(+e),bt.setTime(+r),t(yt),t(bt),Math.floor(n(yt,bt))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var xt=wt(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});xt.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?wt(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):xt:null};var At=xt,Ct=(xt.range,6e4),St=6048e5,Mt=wt(function(t){t.setTime(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}),_t=Mt,$t=(Mt.range,wt(function(t){t.setTime(Math.floor(t/Ct)*Ct)},function(t,e){t.setTime(+t+e*Ct)},function(t,e){return(e-t)/Ct},function(t){return t.getMinutes()})),Tt=$t,Rt=($t.range,wt(function(t){var e=t.getTimezoneOffset()*Ct%36e5;e<0&&(e+=36e5),t.setTime(36e5*Math.floor((+t-e)/36e5)+e)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getHours()})),kt=Rt,Nt=(Rt.range,wt(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ct)/864e5},function(t){return t.getDate()-1})),Pt=Nt;Nt.range;function It(t){return wt(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ct)/St})}var Lt=It(0),Dt=It(1),Ot=It(2),Et=It(3),Bt=It(4),Ft=It(5),jt=It(6),zt=(Lt.range,Dt.range,Ot.range,Et.range,Bt.range,Ft.range,jt.range,wt(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()})),Ht=zt,Ut=(zt.range,wt(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()}));Ut.every=function(t){return isFinite(t=Math.floor(t))&&t>0?wt(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)}):null};var Vt=Ut,qt=(Ut.range,wt(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*Ct)},function(t,e){return(e-t)/Ct},function(t){return t.getUTCMinutes()})),Wt=qt,Yt=(qt.range,wt(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+36e5*e)},function(t,e){return(e-t)/36e5},function(t){return t.getUTCHours()})),Xt=Yt,Zt=(Yt.range,wt(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1})),Gt=Zt;Zt.range;function Kt(t){return wt(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/St})}var Qt=Kt(0),Jt=Kt(1),te=Kt(2),ee=Kt(3),ne=Kt(4),re=Kt(5),ie=Kt(6),oe=(Qt.range,Jt.range,te.range,ee.range,ne.range,re.range,ie.range,wt(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()})),se=oe,ae=(oe.range,wt(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()}));ae.every=function(t){return isFinite(t=Math.floor(t))&&t>0?wt(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)}):null};var le=ae;ae.range;function ue(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function he(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function ce(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}var ge,de,fe,pe,ve={"-":"",_:" ",0:"0"},me=/^\s*\d+/,ye=/^%/,be=/[\\^$*+?|[\]().{}]/g;function we(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function xe(t){return t.replace(be,"\\$&")}function Ae(t){return new RegExp("^(?:"+t.map(xe).join("|")+")","i")}function Ce(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Se(t,e,n){var r=me.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Me(t,e,n){var r=me.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function _e(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function $e(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Te(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Re(t,e,n){var r=me.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function ke(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Ne(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Pe(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Ie(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Le(t,e,n){var r=me.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function De(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Oe(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Ee(t,e,n){var r=me.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Be(t,e,n){var r=me.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Fe(t,e,n){var r=me.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function je(t,e,n){var r=ye.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function ze(t,e,n){var r=me.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function He(t,e,n){var r=me.exec(e.slice(n));return r?(t.Q=1e3*+r[0],n+r[0].length):-1}function Ue(t,e){return we(t.getDate(),e,2)}function Ve(t,e){return we(t.getHours(),e,2)}function qe(t,e){return we(t.getHours()%12||12,e,2)}function We(t,e){return we(1+Pt.count(Vt(t),t),e,3)}function Ye(t,e){return we(t.getMilliseconds(),e,3)}function Xe(t,e){return Ye(t,e)+"000"}function Ze(t,e){return we(t.getMonth()+1,e,2)}function Ge(t,e){return we(t.getMinutes(),e,2)}function Ke(t,e){return we(t.getSeconds(),e,2)}function Qe(t){var e=t.getDay();return 0===e?7:e}function Je(t,e){return we(Lt.count(Vt(t),t),e,2)}function tn(t,e){var n=t.getDay();return t=n>=4||0===n?Bt(t):Bt.ceil(t),we(Bt.count(Vt(t),t)+(4===Vt(t).getDay()),e,2)}function en(t){return t.getDay()}function nn(t,e){return we(Dt.count(Vt(t),t),e,2)}function rn(t,e){return we(t.getFullYear()%100,e,2)}function on(t,e){return we(t.getFullYear()%1e4,e,4)}function sn(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+we(e/60|0,"0",2)+we(e%60,"0",2)}function an(t,e){return we(t.getUTCDate(),e,2)}function ln(t,e){return we(t.getUTCHours(),e,2)}function un(t,e){return we(t.getUTCHours()%12||12,e,2)}function hn(t,e){return we(1+Gt.count(le(t),t),e,3)}function cn(t,e){return we(t.getUTCMilliseconds(),e,3)}function gn(t,e){return cn(t,e)+"000"}function dn(t,e){return we(t.getUTCMonth()+1,e,2)}function fn(t,e){return we(t.getUTCMinutes(),e,2)}function pn(t,e){return we(t.getUTCSeconds(),e,2)}function vn(t){var e=t.getUTCDay();return 0===e?7:e}function mn(t,e){return we(Qt.count(le(t),t),e,2)}function yn(t,e){var n=t.getUTCDay();return t=n>=4||0===n?ne(t):ne.ceil(t),we(ne.count(le(t),t)+(4===le(t).getUTCDay()),e,2)}function bn(t){return t.getUTCDay()}function wn(t,e){return we(Jt.count(le(t),t),e,2)}function xn(t,e){return we(t.getUTCFullYear()%100,e,2)}function An(t,e){return we(t.getUTCFullYear()%1e4,e,4)}function Cn(){return"+0000"}function Sn(){return"%"}function Mn(t){return+t}function _n(t){return Math.floor(+t/1e3)}!function(t){ge=function(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,s=t.shortDays,a=t.months,l=t.shortMonths,u=Ae(i),h=Ce(i),c=Ae(o),g=Ce(o),d=Ae(s),f=Ce(s),p=Ae(a),v=Ce(a),m=Ae(l),y=Ce(l),b={a:function(t){return s[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return a[t.getMonth()]},c:null,d:Ue,e:Ue,f:Xe,H:Ve,I:qe,j:We,L:Ye,m:Ze,M:Ge,p:function(t){return i[+(t.getHours()>=12)]},Q:Mn,s:_n,S:Ke,u:Qe,U:Je,V:tn,w:en,W:nn,x:null,X:null,y:rn,Y:on,Z:sn,"%":Sn},w={a:function(t){return s[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return a[t.getUTCMonth()]},c:null,d:an,e:an,f:gn,H:ln,I:un,j:hn,L:cn,m:dn,M:fn,p:function(t){return i[+(t.getUTCHours()>=12)]},Q:Mn,s:_n,S:pn,u:vn,U:mn,V:yn,w:bn,W:wn,x:null,X:null,y:xn,Y:An,Z:Cn,"%":Sn},x={a:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.w=f[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.w=g[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=y[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=p.exec(e.slice(n));return r?(t.m=v[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return S(t,e,n,r)},d:Ie,e:Ie,f:Fe,H:De,I:De,j:Le,L:Be,m:Pe,M:Oe,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=h[r[0].toLowerCase()],n+r[0].length):-1},Q:ze,s:He,S:Ee,u:Me,U:_e,V:$e,w:Se,W:Te,x:function(t,e,r){return S(t,n,e,r)},X:function(t,e,n){return S(t,r,e,n)},y:ke,Y:Re,Z:Ne,"%":je};function A(t,e){return function(n){var r,i,o,s=[],a=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++a<u;)37===t.charCodeAt(a)&&(s.push(t.slice(l,a)),null!=(i=ve[r=t.charAt(++a)])?r=t.charAt(++a):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),s.push(r),l=a+1);return s.push(t.slice(l,a)),s.join("")}}function C(t,e){return function(n){var r,i,o=ce(1900);if(S(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("p"in o&&(o.H=o.H%12+12*o.p),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=he(ce(o.y))).getUTCDay(),r=i>4||0===i?Jt.ceil(r):Jt(r),r=Gt.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=e(ce(o.y))).getDay(),r=i>4||0===i?Dt.ceil(r):Dt(r),r=Pt.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?he(ce(o.y)).getUTCDay():e(ce(o.y)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,he(o)):e(o)}}function S(t,e,n,r){for(var i,o,s=0,a=e.length,l=n.length;s<a;){if(r>=l)return-1;if(37===(i=e.charCodeAt(s++))){if(i=e.charAt(s++),!(o=x[i in ve?e.charAt(s++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=A(n,b),b.X=A(r,b),b.c=A(e,b),w.x=A(n,w),w.X=A(r,w),w.c=A(e,w),{format:function(t){var e=A(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=C(t+="",ue);return e.toString=function(){return t},e},utcFormat:function(t){var e=A(t+="",w);return e.toString=function(){return t},e},utcParse:function(t){var e=C(t,he);return e.toString=function(){return t},e}}}(t),de=ge.format,ge.parse,fe=ge.utcFormat,pe=ge.utcParse}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Date.prototype.toISOString||fe("%Y-%m-%dT%H:%M:%S.%LZ");+new Date("2000-01-01T00:00:00.000Z")||pe("%Y-%m-%dT%H:%M:%S.%LZ");var $n=1e3,Tn=60*$n,Rn=60*Tn,kn=24*Rn,Nn=7*kn,Pn=30*kn,In=365*kn;function Ln(t){return new Date(t)}function Dn(t){return t instanceof Date?+t:+new Date(+t)}function On(t,e,n,r,o,s,a,l,u){var h=F(D,N.b),c=h.invert,g=h.domain,d=u(".%L"),f=u(":%S"),p=u("%I:%M"),m=u("%I %p"),y=u("%a %d"),b=u("%b %d"),w=u("%B"),x=u("%Y"),A=[[a,1,$n],[a,5,5*$n],[a,15,15*$n],[a,30,30*$n],[s,1,Tn],[s,5,5*Tn],[s,15,15*Tn],[s,30,30*Tn],[o,1,Rn],[o,3,3*Rn],[o,6,6*Rn],[o,12,12*Rn],[r,1,kn],[r,2,2*kn],[n,1,Nn],[e,1,Pn],[e,3,3*Pn],[t,1,In]];function C(i){return(a(i)<i?d:s(i)<i?f:o(i)<i?p:r(i)<i?m:e(i)<i?n(i)<i?y:b:t(i)<i?w:x)(i)}function S(e,n,r,o){if(null==e&&(e=10),"number"==typeof e){var s=Math.abs(r-n)/e,a=i(function(t){return t[2]}).right(A,s);a===A.length?(o=v(n/In,r/In,e),e=t):a?(o=(a=A[s/A[a-1][2]<A[a][2]/s?a-1:a])[1],e=a[0]):(o=Math.max(v(n,r,e),1),e=l)}return null==o?e:e.every(o)}return h.invert=function(t){return new Date(c(t))},h.domain=function(t){return arguments.length?g(M.call(t,Dn)):g().map(Ln)},h.ticks=function(t,e){var n,r=g(),i=r[0],o=r[r.length-1],s=o<i;return s&&(n=i,i=o,o=n),n=(n=S(t,i,o,e))?n.range(i,o+1):[],s?n.reverse():n},h.tickFormat=function(t,e){return null==e?C:u(e)},h.nice=function(t,e){var n=g();return(t=S(t,n[0],n[n.length-1],e))?g(it(n,t)):h},h.copy=function(){return B(h,On(t,e,n,r,o,s,a,l,u))},h}var En=function(){return On(Vt,Ht,Lt,Pt,kt,Tt,_t,At,de).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},Bn=function(){return On(le,se,Qt,Gt,Xt,Wt,_t,At,fe).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])};function Fn(t){var e=0,n=1,r=1,i=!1;function o(n){var o=(n-e)*r;return t(i?Math.max(0,Math.min(1,o)):o)}return o.domain=function(t){return arguments.length?(e=+t[0],n=+t[1],r=e===n?0:1/(n-e),o):[e,n]},o.clamp=function(t){return arguments.length?(i=!!t,o):i},o.interpolator=function(e){return arguments.length?(t=e,o):t},o.copy=function(){return Fn(t).domain([e,n]).clamp(i)},et(o)}function jn(t){var e=0,n=.5,r=1,i=1,o=1,s=!1;function a(e){var r=.5+((e=+e)-n)*(e<n?i:o);return t(s?Math.max(0,Math.min(1,r)):r)}return a.domain=function(t){return arguments.length?(e=+t[0],n=+t[1],r=+t[2],i=e===n?0:.5/(n-e),o=n===r?0:.5/(r-n),a):[e,n,r]},a.clamp=function(t){return arguments.length?(s=!!t,a):s},a.interpolator=function(e){return arguments.length?(t=e,a):t},a.copy=function(){return jn(t).domain([e,n,r]).clamp(s)},et(a)}n.d(e,"scaleBand",function(){return R}),n.d(e,"scalePoint",function(){return k}),n.d(e,"scaleIdentity",function(){return rt}),n.d(e,"scaleLinear",function(){return nt}),n.d(e,"scaleLog",function(){return ct}),n.d(e,"scaleOrdinal",function(){return T}),n.d(e,"scaleImplicit",function(){return $}),n.d(e,"scalePow",function(){return dt}),n.d(e,"scaleSqrt",function(){return ft}),n.d(e,"scaleQuantile",function(){return pt}),n.d(e,"scaleQuantize",function(){return vt}),n.d(e,"scaleThreshold",function(){return mt}),n.d(e,"scaleTime",function(){return En}),n.d(e,"scaleUtc",function(){return Bn}),n.d(e,"scaleSequential",function(){return Fn}),n.d(e,"scaleDiverging",function(){return jn})},function(t,e,n){"use strict";function r(t){t.toggleClass("expanded"),t.hasClass("expanded")?t.next().css("display","block"):t.next().removeAttr("style")}Object.defineProperty(e,"__esModule",{value:!0}),e.toggleCollapser=r,e.toggleCollapserHandler=function(t){r($(this))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(32),i=n(31),o=n(11),s=n(0);n(30);const a=n(9),l=n(12);let u=100;const h=14,c="svgene-selected-orf";function g(t){return L?`u${O-1}-region${L.idx}-${m(t)}`:`${m(t)}`}function d(t){const e=I+h+P,n=I+h+u-P,r=I+h+u/2;if(1===t.strand){const i=D(t.start),o=Math.max(D(t.end)-2*P,i);return`${i},${e} ${o},${e} ${D(t.end)},${r} ${o},${n} ${i},${n}`}if(-1===t.strand){const i=D(t.start),o=D(t.end),s=Math.min(D(t.start)+2*P,o);return`${i},${r} ${s},${e} ${o},${e} ${o},${n} ${s},${n}`}return`${t.start},${e} ${t.end},${e} ${t.end},${n} ${t.start},${n}`}function f(t,e,n,r){const i=n+h+e,o=n+2*h+e-r,s=Math.floor(D((t.start+t.end)/2));return`${s},${i} ${s-5},${o} ${s+5},${o}`}function p(t,e,n){return Math.max(t,Math.min(e,n))}function v(t,e){return"biosynthetic"!==t.type&&"biosynthetic"!==e.type||"biosynthetic"===t.type&&"biosynthetic"===e.type?t.start-e.start:"biosynthetic"===t.type?1:-1}function m(t){return t.replace(/(:|\.)/g,"-").replace(/-svgeneorf/g,"_orf")}function y(t){if(!L)return;if($(".legend-selected").removeClass("legend-selected"),t.ctrlKey||t.metaKey)return(e=$(this))[0].classList.contains(c)?(S(e),0===$(`.${c}`).length&&C()):(0===$(`.${c}`).length&&S(),C(e)),void w(e,"cds");var e;const n=s.selectAll($(this).toArray()),r=n.datum(),i=$(`.focus-panel-content-${L.anchor}`);i.html(r.description).find(".collapser").click(l.toggleCollapserHandler),$(".clipboard-copy",i).off("click").click(a.copyToClipboard),n.classed(c)&&1===$(`.svgene-orf.${c}`).length?C():(S(),C($(this))),w($(this),"cds")}function b(t){l.toggleCollapser($(".collapser-level-candidate.expanded"));const e=t.product.split(":")[0].split(" ")[1];l.toggleCollapser($(`.collapser-level-candidate.collapser-target-CC${e}`))}function w(t,e){const n=s.selectAll(t.toArray()).datum();l.toggleCollapser($(`.collapser-target-${m(n.locus_tag)}.collapser-level-${e}`))}function x(t,e){$(".legend-selected").removeClass("legend-selected"),$(".svgene-orf").each(function(n){const r=s.selectAll($(this).toArray()).datum();t<=r.start&&r.end<=e&&(C($(this)),w($(this),"candidate"),w($(this),"protocluster"))})}function A(t,e){const n=e?"1":"0.5";s.selectAll(t.toArray()).attr("opacity",n).classed(c,e).each(t=>{s.selectAll(`#svgene-minimap-orf-${m(t.locus_tag)}`).attr("opacity",n).classed(c,e),e?$(`#${g(t.locus_tag)}-domains`).show():$(`#${g(t.locus_tag)}-domains`).hide()})}function C(t){void 0===t&&(t=$(".svgene-orf, .svgene-minimap-orf")),A(t,!0)}function S(t){void 0===t&&(t=$(`.${c}`)),A(t,!1)}function M(t){const e=$(this).attr("data-id");if(void 0===e)return;let n=".contains-tta-codon";if(n="legend-tta-codon"===e?".contains-tta-codon":"legend-resistance"===e?".svgene-resistance-orf":`.${e.replace("legend-","svgene-")}`,$(this).hasClass("legend-selected"))return $(this).removeClass("legend-selected"),S($(n)),void(0===$(".legend-selected").length&&C());(t.ctrlKey||t.metaKey)&&0!==$(".legend-selected").length||($(".legend-selected").removeClass("legend-selected"),S()),$(this).addClass("legend-selected"),C($(n))}function _(t){let e=-1,n=-1;$(`.${c}`).each(function(t){const r=s.selectAll($(this).toArray()).datum();e=-1===e?Math.min(r.start,r.end):Math.min(e,r.start,r.end),n=-1===n?Math.max(r.start,r.end):Math.max(n,r.start,r.end)}),-1!==e&&-1!==n&&T(e,n)}function T(t,e,n){if(!L)return;let r=0;void 0===n&&(n=!1,r=500),t-=1,e+=1,D.domain([t,e]);const i=t+(e-t)/2;if(s.selectAll(".svgene-orf,.svgene-orf-bg").transition().duration(r).attr("points",t=>d(t)),s.selectAll(".svgene-locustag").transition().duration(r).attr("x",t=>t.start<i?D(t.start):D(t.end)).attr("text-anchor",t=>t.start<i?"start":"end"),s.selectAll(".cluster-background").transition().duration(r).attr("width",t=>D(t.neighbouring_end)-D(t.neighbouring_start)).attr("x",t=>D(t.neighbouring_start)),s.selectAll(".cluster-core").transition().duration(r).attr("width",t=>D(t.end)-D(t.start)).attr("x",t=>D(t.start)),s.selectAll(".cluster-line").transition().duration(r).attr("x1",t=>D(t.neighbouring_start)).attr("x2",t=>D(t.neighbouring_end)),s.selectAll(".clusterlabel").transition().duration(r).attr("x",n=>D((Math.max(n.start,t+1)+Math.min(n.end,e-1))/2)),s.selectAll(".svgene-resistance").filter(t=>t&&!0===t.resistance).attr("x",t=>D(t.start)).attr("width",t=>D(t.end)-D(t.start)),s.selectAll(".svgene-tta-codon").filter(t=>void 0!==t).transition().duration(r).attr("points",t=>f(t,u,I,P)),null!==k&&s.select(".svgene-axis").transition().duration(r).call(k),!n){0===$(`.${c}`).length&&C();const n=N(t),i=N(e);s.select(`#svgene-minimap-grabber-a-${L.anchor}`).transition().duration(r).attr("x",n),s.select(`#svgene-minimap-grabber-b-${L.anchor}`).transition().duration(r).attr("x",i),s.select(`#svgene-minimap-window-${L.anchor}`).transition().duration(r).attr("x",n).attr("width",i-n)}}function R(t){null!==L&&($(".legend-selected").removeClass("legend-selected"),C(),T(L.start,L.end),l.toggleCollapser($(".collapser-level-cds.expanded")))}e.locusToFullId=g,e.drawRegion=function(t,e,n,a,l){L&&(s.select(`#${L.anchor}-svg`).selectAll("*").remove(),$(".legend-selected").removeClass("legend-selected"));const g=e;if(null===(L=e))return;void 0===a&&(a=g.start),void 0===l&&(l=g.end);let w=!1;for(const t of g.orfs)if(t.resistance){w=!0;break}const A=12*Math.max.apply(Math,g.clusters.map(t=>t.height)),C=w||g.ttaCodons.length>0?Math.floor(2*n/3):0,E=n+2*h+A+40+20+C,B=(g.idx,s.select(`#${t}`)),F=$(`#${t}`).parent().width()||700;B.selectAll("svg").remove(),B.selectAll("div").remove();const j=B.append("svg").attr("height",E).attr("width","100%").attr("viewbox",`-1 0 ${F} ${E}`),z=[],H=[],U=[];z.push.apply(z,g.orfs.sort(v)),H.push.apply(H,g.clusters?g.clusters:[]),U.push.apply(U,g.ttaCodons?g.ttaCodons:[]);const V=O++;P=n/10,D=o.scaleLinear().domain([a,l]).range([0,F]),function(t,e,n,r,i,o,a,l,g,p){if(null===L)return;const v=L.idx;I=12*Math.max.apply(Math,n.map(t=>t.height))+h,u=o,t.append("line").attr("x1",0).attr("y1",I+h+o/2).attr("x2",a).attr("y2",I+h+o/2).attr("class","centerline");const y=t.selectAll("g.cluster-bar-group").data(n).enter().append("g").attr("class",t=>t.isCandidateCluster?`candidate-${t.product.split(" ")[2].replace("chemical_","")}`:`svgene-border-${t.tool}`).on("click",t=>{$(`.${c}`).length!==e.length&&(s.event.ctrlKey||s.event.metaKey)||S(),x(t.neighbouring_start,t.neighbouring_end),b(t)}).on("dblclick",t=>{x(t.neighbouring_start,t.neighbouring_end),b(t),T(t.neighbouring_start,t.neighbouring_end)});y.append("rect").attr("width",t=>D(t.neighbouring_end)-D(t.neighbouring_start)).attr("height",10).attr("x",t=>D(t.neighbouring_start)).attr("y",t=>12*t.height+l).attr("opacity","0.5").attr("class",t=>`cluster-background ${t.product}`).style("stroke-width","0"),y.append("line").attr("x1",t=>D(t.neighbouring_start)).attr("y1",t=>12*t.height+l+5).attr("x2",t=>D(t.neighbouring_end)).attr("y2",t=>12*t.height+l+5).attr("class","cluster-line"),y.append("rect").attr("width",t=>D(t.end)-D(t.start)).attr("height",10).attr("x",t=>D(t.start)).attr("y",t=>12*t.height+l).attr("class",t=>`cluster-core ${t.product}`).style("stroke","black"),y.append("text").attr("x",t=>D((t.start+t.end)/2)).attr("y",t=>"rule-based-clusters"===t.tool?12*(t.height-1)-2+10+l:12*t.height-2+10+l).style("font-size","xx-small").attr("class","clusterlabel").attr("text-anchor","middle").style("pointer-events","none").text(t=>t.product.replace("_"," "));const w=t.selectAll("g.orf-group").data(e).enter().append("g").attr("class","orf-group");w.append("polygon").attr("points",t=>d(t)).attr("class","svgene-orf-bg").attr("id",t=>`u${i}-region${v}-${m(t.locus_tag)}-svgeneorf-bg`).style("fill","white"),w.append("polygon").attr("points",t=>d(t)).attr("class",t=>`svgene-type-${t.type} svgene-orf ${c}`).attr("id",t=>`u${i}-region${v}-${m(t.locus_tag)}-svgeneorf`).attr("opacity","1");const A=I+h+o+2;t.selectAll("rect.svgene-resist").data(e.filter(t=>t.resistance)).enter().append("rect").attr("class","svgene-resistance").attr("width",t=>D(t.end)-D(t.start)).attr("height",7).attr("x",t=>D(t.start)).attr("y",A);for(const t of e.filter(t=>t.resistance)){const e=`#u${i}-region${v}-${m(t.locus_tag)}-svgeneorf`;s.select(e).classed("svgene-resistance-orf",!0)}t.selectAll("polyline.svgene-tta-codon").data(r).enter().append("polyline").attr("points",t=>f(t,o,I,l)).attr("class","svgene-tta-codon"),t.selectAll("text.svgene-locustag").data(e).enter().append("text").attr("x",t=>D(t.start)<a/2?D(t.start):D(t.end)).attr("text-anchor",t=>D(t.start)<a/2?"start":"end").attr("y",I+h).attr("class","svgene-locustag").attr("id",t=>`u${i}-region${v}-${m(t.locus_tag)}-label`).text(t=>t.locus_tag);for(const t of r)for(const e of t.containedBy){const t=`#u${i}-region${v}-${m(e)}-svgeneorf`;s.select(t).classed("contains-tta-codon",!0)}}(j,z,H,U,V,n,F,P),void 0!==g.label&&j.append("text").text(g.label).attr("class","svgene-regionlabel").attr("x",function(){const t=this.getComputedTextLength();return F-t-5}).attr("y",h).attr("font-size",h),k=r.axisBottom(D),j.append("g").attr("class","svgene-axis").attr("transform",`translate(0,${E-40-20})`).call(k),function(t,e,n,r,a,l,u){if(!L)return;N=o.scaleLinear().domain([e,n]).range([Math.floor(.25*u),Math.floor(.75*u)]).nice();const h=a/4;t.append("g").attr("class","svgene-minimap"),t.append("line").attr("x1",N(e)).attr("y1",r).attr("x2",N(n)).attr("y2",r).attr("class","centerline"),t.selectAll("rect.svgene-minimap-orf").data(l).enter().append("rect").attr("width",t=>N(t.end)-N(t.start)).attr("height",h).attr("x",t=>N(t.start)).attr("y",r-h/2).attr("class",t=>`svgene-type-${t.type} ${c} svgene-minimap-orf`).attr("id",t=>`svgene-minimap-orf-${m(t.locus_tag)}`);const g=N(e),d=N(n),f=N(Math.min(n,e+1e3)),v=N(Math.max(e,n-1e3));t.append("rect").attr("x",N(e)).attr("y",r-a/2).attr("width",N(n)-N(e)).attr("height",a).style("cursor","grab").attr("id",`svgene-minimap-window-${L.anchor}`).attr("opacity","0.2").style("fill","blue").call(i.drag().on("drag",function(){if(null===L)return;Math.max(0,s.event.x-parseInt(s.select(this).attr("x"),10));let t=parseInt(s.select(this).attr("width"),10);const e=parseInt(s.select(this).attr("x"),10),n=e+s.event.dx;let r=p(g,n,v);n<g?t=Math.max(f-g,t-(g-n)):n+t>d&&(r=Math.min(n,v),t=d-r),r=p(g,r,v);const i=Math.max(f,r+t);s.select(this).attr("x",r).attr("width",t),s.select(`#svgene-minimap-grabber-a-${L.anchor}`).attr("x",r),s.select(`#svgene-minimap-grabber-b-${L.anchor}`).attr("x",i),T(N.invert(r),N.invert(i),!0)})),t.append("rect").attr("x",N(e)).attr("y",r-a/2).attr("id",`svgene-minimap-grabber-a-${L.anchor}`).attr("width",2).attr("height",a).style("cursor","ew-resize").call(i.drag().on("drag",function(t,e){if(!L)return;const n=parseInt(s.select(`#svgene-minimap-grabber-b-${L.anchor}`).attr("x"),10),r=Math.min(N(N.invert(n)-1e3),d,Math.max(s.event.x,g));s.select(this).transition().duration(10).attr("x",r),s.select(`#svgene-minimap-window-${L.anchor}`).transition().duration(10).attr("x",r).attr("width",n-r),T(N.invert(r),N.invert(n),!0)})),t.append("rect").attr("x",N(n)).attr("y",r-a/2).attr("id",`svgene-minimap-grabber-b-${L.anchor}`).attr("width",2).attr("height",a).style("cursor","ew-resize").call(i.drag().on("drag",function(t,e){if(!L)return;const n=parseInt(s.select(`#svgene-minimap-grabber-a-${L.anchor}`).attr("x"),10),r=Math.max(N(N.invert(n)+1e3),f,Math.min(s.event.x,d));s.select(this).transition().duration(10).attr("x",r),s.select(`#svgene-minimap-window-${L.anchor}`).transition().duration(10).attr("width",r-n),T(N.invert(n),N.invert(r),!0)}))}(j,g.start,g.end,E-20,40,z,F),$(".svgene-orf").mouseover(function(t){let e=$(this).attr("id");void 0!==e&&(e=e.replace("-svgeneorf","-label"),$("#"+e).show())}).mouseout(function(t){let e=$(this).attr("id");void 0!==e&&(e=e.replace("-svgeneorf","-label"),$("#"+e).hide())}).click(y),$(".svgene-textarea").click(t=>t.stopPropagation()),$(".legend-selector").unbind("click").click(M),$(".zoom-in").unbind("click").click(_),$(".zoom-reset").unbind("click").click(R),1===O&&$(document).keyup(t=>{const e=t.keyCode;82===e?R(t):90===e&&_(t)})};let k=null,N=o.scaleLinear().domain([0,100]).range([0,100]),P=0,I=0,L=null,D=o.scaleLinear().domain([0,100]).range([0,100]),O=0},function(t,e,n){const r=n(3);class i{constructor(t=new r(0,0),e=new r(0,0),n=null,i=null,o=!1,s=!1){this.from=t,this.to=e,this.elementFrom=n,this.elementTo=i,this.chiralFrom=o,this.chiralTo=s}clone(){return new i(this.from.clone(),this.to.clone(),this.elementFrom,this.elementTo)}getLength(){return Math.sqrt(Math.pow(this.to.x-this.from.x,2)+Math.pow(this.to.y-this.from.y,2))}getAngle(){return r.subtract(this.getRightVector(),this.getLeftVector()).angle()}getRightVector(){return this.from.x<this.to.x?this.to:this.from}getLeftVector(){return this.from.x<this.to.x?this.from:this.to}getRightElement(){return this.from.x<this.to.x?this.elementTo:this.elementFrom}getLeftElement(){return this.from.x<this.to.x?this.elementFrom:this.elementTo}getRightChiral(){return this.from.x<this.to.x?this.chiralTo:this.chiralFrom}getLeftChiral(){return this.from.x<this.to.x?this.chiralFrom:this.chiralTo}setRightVector(t,e){return this.from.x<this.to.x?(this.to.x=t,this.to.y=e):(this.from.x=t,this.from.y=e),this}setLeftVector(t,e){return this.from.x<this.to.x?(this.from.x=t,this.from.y=e):(this.to.x=t,this.to.y=e),this}rotateToXAxis(){let t=this.getLeftVector();return this.setRightVector(t.x+this.getLength(),t.y),this}rotate(t){let e=this.getLeftVector(),n=this.getRightVector(),r=Math.sin(t),i=Math.cos(t),o=i*(n.x-e.x)-r*(n.y-e.y)+e.x,s=r*(n.x-e.x)-i*(n.y-e.y)+e.y;return this.setRightVector(o,s),this}shortenFrom(t){let e=r.subtract(this.to,this.from);return e.normalize(),e.multiplyScalar(t),this.from.add(e),this}shortenTo(t){let e=r.subtract(this.from,this.to);return e.normalize(),e.multiplyScalar(t),this.to.add(e),this}shortenRight(t){return this.from.x<this.to.x?this.shortenTo(t):this.shortenFrom(t),this}shortenLeft(t){return this.from.x<this.to.x?this.shortenFrom(t):this.shortenTo(t),this}shorten(t){let e=r.subtract(this.from,this.to);return e.normalize(),e.multiplyScalar(t/2),this.to.add(e),this.from.subtract(e),this}}t.exports=i},function(t,e,n){n(4),n(5);t.exports=class{constructor(t,e){this.id=null,this.firstRingId=t.id,this.secondRingId=e.id,this.vertices=new Set;for(var n=0;n<t.members.length;n++){let r=t.members[n];for(let t=0;t<e.members.length;t++)r===e.members[t]&&this.addVertex(r)}}addVertex(t){this.vertices.add(t)}updateOther(t,e){this.firstRingId===e?this.secondRingId=t:this.firstRingId=t}containsRing(t){return this.firstRingId===t||this.secondRingId===t}isBridge(t){if(this.vertices.size>2)return!0;for(let e of this.vertices)if(t[e].value.rings.length>2)return!0;return!1}static isBridge(t,e,n,r){let i=null;for(let o=0;o<t.length;o++)if((i=t[o]).firstRingId===n&&i.secondRingId===r||i.firstRingId===r&&i.secondRingId===n)return i.isBridge(e);return!1}static getNeighbours(t,e){let n=[];for(let r=0;r<t.length;r++){let i=t[r];i.firstRingId===e?n.push(i.secondRingId):i.secondRingId===e&&n.push(i.firstRingId)}return n}static getVertices(t,e,n){for(let r=0;r<t.length;r++){let i=t[r];if(i.firstRingId===e&&i.secondRingId===n||i.firstRingId===n&&i.secondRingId===e)return[...i.vertices]}}}},function(t,e){class n{constructor(t,e,n=1){this.id=null,this.sourceId=t,this.targetId=e,this.weight=n,this.bondType="-",this.isPartOfAromaticRing=!1,this.center=!1,this.wedge=""}setBondType(t){this.bondType=t,this.weight=n.bonds[t]}static get bonds(){return{"-":1,"/":1,"\\":1,"=":2,"#":3,$:4}}}t.exports=n},function(t,e,n){const r=n(6),i=(n(3),n(4)),o=n(16),s=(n(5),n(10));class a{constructor(t,e=!1){this.vertices=Array(),this.edges=Array(),this.vertexIdsToEdgeId={},this.isomeric=e,this._time=0,this._init(t)}_init(t,e=0,n=null,r=!1){let a=new s(t.atom.element?t.atom.element:t.atom,t.bond);a.branchBond=t.branchBond,a.ringbonds=t.ringbonds,a.bracket=t.atom.element?t.atom:null;let l=new i(a),u=this.vertices[n];if(this.addVertex(l),null!==n){l.setParentVertexId(n),l.value.addNeighbouringElement(u.value.element),u.addChild(l.id),u.value.addNeighbouringElement(a.element),u.spanningTreeChildren.push(l.id);let t=new o(n,l.id,1),e=null;r?(t.setBondType(l.value.branchBond||"-"),e=l.id,t.setBondType(l.value.branchBond||"-"),e=l.id):(t.setBondType(u.value.bondType||"-"),e=u.id);this.addEdge(t)}let h=t.ringbondCount+1;a.bracket&&(h+=a.bracket.hcount);let c=0;if(a.bracket&&a.bracket.chirality){a.isStereoCenter=!0,c=a.bracket.hcount;for(var g=0;g<c;g++)this._init({atom:"H",isBracket:"false",branches:Array(),branchCount:0,ringbonds:Array(),ringbondCount:!1,next:null,hasNext:!1,bond:"-"},g,l.id,!0)}for(g=0;g<t.branchCount;g++)this._init(t.branches[g],g+h,l.id,!0);t.hasNext&&this._init(t.next,t.branchCount+h,l.id)}clear(){this.vertices=Array(),this.edges=Array(),this.vertexIdsToEdgeId={}}addVertex(t){return t.id=this.vertices.length,this.vertices.push(t),t.id}addEdge(t){let e=this.vertices[t.sourceId],n=this.vertices[t.targetId];return t.id=this.edges.length,this.edges.push(t),this.vertexIdsToEdgeId[t.sourceId+"_"+t.targetId]=t.id,this.vertexIdsToEdgeId[t.targetId+"_"+t.sourceId]=t.id,t.isPartOfAromaticRing=e.value.isPartOfAromaticRing&&n.value.isPartOfAromaticRing,e.value.bondCount+=t.weight,n.value.bondCount+=t.weight,e.edges.push(t.id),n.edges.push(t.id),t.id}getEdge(t,e){let n=this.vertexIdsToEdgeId[t+"_"+e];return void 0===n?null:this.edges[n]}getEdges(t){let e=Array(),n=this.vertices[t];for(var r=0;r<n.neighbours.length;r++)e.push(this.vertexIdsToEdgeId[t+"_"+n.neighbours[r]]);return e}hasEdge(t,e){return void 0!==this.vertexIdsToEdgeId[t+"_"+e]}getVertexList(){let t=[this.vertices.length];for(var e=0;e<this.vertices.length;e++)t[e]=this.vertices[e].id;return t}getEdgeList(){let t=Array(this.edges.length);for(var e=0;e<this.edges.length;e++)t[e]=[this.edges[e].sourceId,this.edges[e].targetId];return t}getAdjacencyMatrix(){let t=this.vertices.length,e=Array(t);for(var n=0;n<t;n++)e[n]=new Array(t),e[n].fill(0);for(n=0;n<this.edges.length;n++){let t=this.edges[n];e[t.sourceId][t.targetId]=1,e[t.targetId][t.sourceId]=1}return e}getComponentsAdjacencyMatrix(){let t=this.vertices.length,e=Array(t),n=this.getBridges();for(var r=0;r<t;r++)e[r]=new Array(t),e[r].fill(0);for(r=0;r<this.edges.length;r++){let t=this.edges[r];e[t.sourceId][t.targetId]=1,e[t.targetId][t.sourceId]=1}for(r=0;r<n.length;r++)e[n[r][0]][n[r][1]]=0,e[n[r][1]][n[r][0]]=0;return e}getSubgraphAdjacencyMatrix(t){let e=t.length,n=Array(e);for(var r=0;r<e;r++){n[r]=new Array(e),n[r].fill(0);for(var i=0;i<e;i++)r!==i&&this.hasEdge(t[r],t[i])&&(n[r][i]=1)}return n}getDistanceMatrix(){let t=this.vertices.length,e=this.getAdjacencyMatrix(),n=Array(t);for(var r=0;r<t;r++)n[r]=Array(t),n[r].fill(1/0);for(r=0;r<t;r++)for(var i=0;i<t;i++)1===e[r][i]&&(n[r][i]=1);for(var o=0;o<t;o++)for(r=0;r<t;r++)for(i=0;i<t;i++)n[r][i]>n[r][o]+n[o][i]&&(n[r][i]=n[r][o]+n[o][i]);return n}getSubgraphDistanceMatrix(t){let e=t.length,n=this.getSubgraphAdjacencyMatrix(t),r=Array(e);for(var i=0;i<e;i++)r[i]=Array(e),r[i].fill(1/0);for(i=0;i<e;i++)for(var o=0;o<e;o++)1===n[i][o]&&(r[i][o]=1);for(var s=0;s<e;s++)for(i=0;i<e;i++)for(o=0;o<e;o++)r[i][o]>r[i][s]+r[s][o]&&(r[i][o]=r[i][s]+r[s][o]);return r}getAdjacencyList(){let t=this.vertices.length,e=Array(t);for(var n=0;n<t;n++){e[n]=[];for(var r=0;r<t;r++)n!==r&&this.hasEdge(this.vertices[n].id,this.vertices[r].id)&&e[n].push(r)}return e}getSubgraphAdjacencyList(t){let e=t.length,n=Array(e);for(var r=0;r<e;r++){n[r]=Array();for(var i=0;i<e;i++)r!==i&&this.hasEdge(t[r],t[i])&&n[r].push(i)}return n}getBridges(){let t=this.vertices.length,e=new Array(t),n=new Array(t),r=new Array(t),i=new Array(t),o=this.getAdjacencyList(),s=Array();e.fill(!1),i.fill(null),this._time=0;for(var a=0;a<t;a++)e[a]||this._bridgeDfs(a,e,n,r,i,o,s);return s}traverseBF(t,e){let n=this.vertices.length,r=new Array(n);r.fill(!1);for(var i=[t];i.length>0;){let t=i.shift(),n=this.vertices[t];e(n);for(var o=0;o<n.neighbours.length;o++){let t=n.neighbours[o];r[t]||(r[t]=!0,i.push(t))}}}getTreeDepth(t,e){if(null===t||null===e)return 0;let n=this.vertices[t].getSpanningTreeNeighbours(e),r=0;for(var i=0;i<n.length;i++){let e=n[i],o=this.getTreeDepth(e,t);o>r&&(r=o)}return r+1}traverseTree(t,e,n,r=Number.MAX_SAFE_INTEGER,i=!1,o=1,s=null){if(null===s&&(s=new Uint8Array(this.vertices.length)),o>r+1||1===s[t])return;s[t]=1;let a=this.vertices[t],l=a.getNeighbours(e);(!i||o>1)&&n(a);for(var u=0;u<l.length;u++)this.traverseTree(l[u],t,n,r,i,o+1,s)}kkLayout(t,e,n,i,o){let s=o;for(var a=t.length;a--;){var l=this.vertices[t[a]].neighbours.length}let u=this.getSubgraphDistanceMatrix(t),h=t.length,c=r.polyCircumradius(500,h),g=r.centralAngle(h),d=0,f=new Float32Array(h),p=new Float32Array(h),v=Array(h);for(a=h;a--;){let n=this.vertices[t[a]];n.positioned?(f[a]=n.position.x,p[a]=n.position.y):(f[a]=e.x+Math.cos(d)*c,p[a]=e.y+Math.sin(d)*c),v[a]=n.positioned,d+=g}let m=Array(h);for(a=h;a--;){m[a]=new Array(h);for(l=h;l--;)m[a][l]=o*u[a][l]}let y=Array(h);for(a=h;a--;){y[a]=Array(h);for(l=h;l--;)y[a][l]=s*Math.pow(u[a][l],-2)}let b,w,x,A,C,S,M,_=Array(h),$=new Float32Array(h),T=new Float32Array(h);for(a=h;a--;)_[a]=Array(h);for(a=h;a--;){b=f[a],w=p[a],x=0,A=0;let t=h;for(;t--;)a!==t&&(C=f[t],S=p[t],M=1/Math.sqrt((b-C)*(b-C)+(w-S)*(w-S)),_[a][t]=[y[a][t]*(b-C-m[a][t]*(b-C)*M),y[a][t]*(w-S-m[a][t]*(w-S)*M)],_[t][a]=_[a][t],x+=_[a][t][0],A+=_[a][t][1]);$[a]=x,T[a]=A}let R=function(t){return[$[t]*$[t]+T[t]*T[t],$[t],T[t]]},k=function(){let t=0,e=0,n=0,r=0;for(a=h;a--;){let[i,o,s]=R(a);i>t&&!1===v[a]&&(t=i,e=a,n=o,r=s)}return[e,t,n,r]},N=function(t,e,n){let r=0,i=0,o=0,s=f[t],l=p[t],u=m[t],c=y[t];for(a=h;a--;){if(a===t)continue;let e=f[a],n=p[a],h=u[a],g=c[a],d=(s-e)*(s-e),v=1/Math.pow(d+(l-n)*(l-n),1.5);r+=g*(1-h*(l-n)*(l-n)*v),i+=g*(1-h*d*v),o+=g*(h*(s-e)*(l-n)*v)}0===r&&(r=.1),0===i&&(i=.1),0===o&&(o=.1);let g=e/r+n/o,d=-(o*(g/=o/r-i/o)+e)/r;f[t]+=d,p[t]+=g;let v,b,w,x,A,C=_[t];for(e=0,n=0,s=f[t],l=p[t],a=h;a--;)t!==a&&(v=f[a],b=p[a],w=C[a][0],x=C[a][1],A=1/Math.sqrt((s-v)*(s-v)+(l-b)*(l-b)),d=c[a]*(s-v-u[a]*(s-v)*A),g=c[a]*(l-b-u[a]*(l-b)*A),C[a]=[d,g],e+=d,n+=g,$[a]+=d-w,T[a]+=g-x);$[t]=e,T[t]=n},P=1e9,I=0,L=0,D=0,O=0,E=0,B=0;for(;P>.1&&2e3>E;)for(E++,[I,P,L,D]=k(),O=P,B=0;O>.1&&50>B;)B++,N(I,L,D),[O,L,D]=R(I);for(a=h;a--;){let e=t[a],n=this.vertices[e];n.position.x=f[a],n.position.y=p[a],n.positioned=!0,n.forcePositioned=!0}}_bridgeDfs(t,e,n,r,i,o,s){e[t]=!0,n[t]=r[t]=++this._time;for(var a=0;a<o[t].length;a++){let l=o[t][a];e[l]?l!==i[t]&&(r[t]=Math.min(r[t],n[l])):(i[l]=t,this._bridgeDfs(l,e,n,r,i,o,s),r[t]=Math.min(r[t],r[l]),r[l]>n[t]&&s.push([t,l]))}}static getConnectedComponents(t){let e=t.length,n=new Array(e),r=new Array;n.fill(!1);for(var i=0;i<e;i++)if(!n[i]){let e=Array();n[i]=!0,e.push(i),0,a._ccGetDfs(i,n,t,e),e.length>1&&r.push(e)}return r}static getConnectedComponentCount(t){let e=t.length,n=new Array(e),r=0;n.fill(!1);for(var i=0;i<e;i++)n[i]||(n[i]=!0,r++,a._ccCountDfs(i,n,t));return r}static _ccCountDfs(t,e,n){for(var r=0;r<n[t].length;r++){n[t][r]&&!e[r]&&t!==r&&(e[r]=!0,a._ccCountDfs(r,e,n))}}static _ccGetDfs(t,e,n,r){for(var i=0;i<n[t].length;i++){n[t][i]&&!e[i]&&t!==i&&(e[i]=!0,r.push(i),a._ccGetDfs(i,e,n,r))}}}t.exports=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(9),i=n(19),o=n(12),s=n(20),a=n(21),l=n(22),u=n(23),h=n(24),c=n(13);let g=null,d=null;function f(t){t.preventDefault(),$("#downloadmenu").fadeToggle("fast","linear")}function p(){const t=window.location.hash.substring(1);return t||"overview"}function v(){setTimeout(()=>{$(".page").hide(),$(".regbutton").removeClass("active");const t=p();$(`#${t}`).show(),"overview"!==t&&$(`.regbutton.${t}`).addClass("active"),void 0!==g[t]&&c.drawRegion(`${t}-svg`,g[t],20),$(`#${t}-details-svg`).length>0&&a.drawDomains(`${t}-details-svg`,d[t],25),$(`#${t} .clusterblast-selector`).change()},1)}function m(){const t=g.order,e=p();let n="overview";if("overview"===e)n=t[0];else{const r=t.indexOf(e);r!==t.length-1&&(n=t[r+1])}window.location.href=`#${n}`,v()}function y(){const t=g.order,e=p();let n="";if("overview"===e)n=t[t.length-1];else{const r=t.indexOf(e);0!==r&&(n=t[r-1])}window.location.href=`#${n}`,v()}function b(t,e){const n=t+"-active",r=p(),i=$(`#${r}`).find(`.${t}`),o=$(`#${r}`).find(`.${n}`);i&&o&&o&&(e>0?o.is(i.last())?i.first().trigger("click"):o.next().trigger("click"):o.is(i.first())?i.last().trigger("click"):o.prev().trigger("click"))}function w(t){const e=t.keyCode;37===e||87===e?y():39!==e&&69!==e||m(),"overview"!==p()&&(65===e?b("body-details-header",-1):83===e?b("body-details-header",1):68===e?b("sidepanel-details-header",-1):70===e?b("sidepanel-details-header",1):77===e&&$("input.show-module-domains").first().click())}function x(t){t.preventDefault();const e=($(this).attr("id")||"").replace(/-header/,"");if(!e)return;const n=$(`#${e}`);"none"===n.css("display")?$(this).text("Hide pHMM detection rules used"):$(this).text("Show pHMM detection rules used"),n.fadeToggle("fast","linear")}e.getAnchor=p,e.start=function(t,e,n){u.createRecordOverviews(n),g=t,d=e,document.addEventListener("keyup",w,!1),$("#download").click(f),$("#next-region").click(m),$("#prev-region").click(y),$(".regbutton").click(function(){const t=$(this).children().first().attr("href");void 0!==t&&(window.location.href=t,v())}).mouseover(function(){const t=($(this).attr("class")||"").split(" ");if(t.length<2)return;if("separator"===t[1])return;const e=function(t){switch(t){case"nrps":return"NRPS";case"t1pks":return"Type I PKS";case"t2pks":return"Type II PKS";case"t3pks":return"Type III PKS";case"t4pks":return"Type IV PKS";default:return t}}(t[1]),n=$("#region-type");n.data("orig_text",n.text()),n.text(`${e}:`)}).mouseout(()=>{const t=$("#region-type");t.text(t.data("orig_text"))}),$(".clusterblast-selector").change(function(){const t=($(this).attr("id")||"nonexistant").replace("-select",""),e=""+$(this).val();e&&$.get(e,e=>{$(`#${t}-svg`).html(e),i.init(`${t}-svg`)},"html"),$(`#${t}-download`).off("click"),$(`#${t}-download`).click(()=>window.open(""+$(`#${t}-select`).val(),"_blank"))}),$(".cluster-rules-header").click(x),v(),$("input.overview-switch-compact").change(function(){$(this).prop("checked")?($("#single-record-tables").hide(),$("#compact-record-table").show()):($("#single-record-tables").show(),$("#compact-record-table").hide())}).trigger("change"),$(".linked-row").off("click").click(function(){const t=$(this).attr("data-anchor");t&&(window.location.href=t,v())}),a.createButtonHandlers(),h.drawStructures(),l.setupContributors(),s.setupDetails(t.order),$(".help-icon").off("click").click(function(){$(this).toggleClass("active"),$(this).next().toggle()}),$(".help-tooltip").off("click").click(function(){$(this).hide(),$(this).prev().removeClass("active")}),$(".clipboard-copy").off("click").click(r.copyToClipboard),$(".collapser").click(o.toggleCollapserHandler)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});let r=null;function i(t){const e=$(`#${$(this).attr("id")}-tooltip`);if(r&&(clearTimeout(e.data("timeout")),r.hide()),r=e,"none"!==e.css("display"))return void e.hide();let n=$(this).offset();void 0===n&&(n={left:0,top:0});let i=setTimeout(()=>e.slideUp("fast"),5e3);e.css("top",n.top+10).css("left",n.left+5).show().click(function(){$(this).hide()}).data("timeout",i).mouseover(()=>clearTimeout(e.data("timeout"))).mouseout(()=>{clearTimeout(e.data("timeout")),i=setTimeout(()=>e.slideUp("fast"),5e3),e.data("timeout",i)})}e.init=function(t){$(`#${t} .clusterblast-orf`).each(function(){const e=$(this);!function(t,e){const n=t.attr("id"),r=$("<div>");r.addClass("clusterblast-locustag"),r.attr("id",`${n}-label`);const i=t.attr("locus_tag");i?r.text(i):r.text("unknown"),$(`#${e}`).append(r),t.mouseover(e=>{let i=t.offset();void 0===i&&(i={left:0,top:32}),r.css("top",i.top-32),r.css("left",i.left),$(`#${n}-label`).show()}).mouseout(t=>{$(`#${n}-label`).hide()})}(e,t),function(t,e){const n=t.attr("id"),r=$("<div>");r.addClass("clusterblast-tooltip"),r.attr("id",`${n}-tooltip`),r.html((t.attr("description")||"").replace("[br]","<br>")),$(`#${e}`).append(r),t.click(i)}(e,t)})}},function(t,e,n){"use strict";function r(t,e){i($(this),t);const n=$(`#${t} * .sidepanel-details-header.${$(this).attr("data-name")}`);n.length>0&&s(n,t)}function i(t,e){$(`#${e} * .body-details-section`).hide(),$(`#${e} * .body-details-header-active`).toggleClass("body-details-header-active"),t.addClass("body-details-header-active"),$(`#${e} * .body-details-section.${t.attr("data-name")}`).show()}function o(t,e){s($(this),t);const n=$(`#${t} * .body-details-header.${$(this).attr("data-name")}`);n.length>0&&i(n,t)}function s(t,e){$(`#${e} * .sidepanel-details-section`).hide(),$(`#${e} * .sidepanel-details-header-active`).toggleClass("sidepanel-details-header-active"),t.addClass("sidepanel-details-header-active"),$(`#${e} * .sidepanel-details-section.${t.attr("data-name")}`).show()}function a(t,e){const n=$(`.${t}-mibig-compounds`),r=$(this).attr("data-name");i(n,t),setTimeout(()=>{if(r){const t=document.getElementById(r);t&&t.scrollIntoView()}},1)}Object.defineProperty(e,"__esModule",{value:!0}),e.setupDetails=function(t){$(".body-details-header").off("click"),$(".body-details-section").hide();for(const e of t)$(`#${e} * .body-details-header`).click($.proxy(r,null,e)).first().trigger("click");$(".sidepanel-details-header").off("click"),$(".sidepanel-details-section").hide();for(const e of t)$(`#${e} * .sidepanel-details-header`).click($.proxy(o,null,e)).first().trigger("click");$(".compound-link").off("click");for(const e of t)$(`#${e} * .compound-link`).click($.proxy(a,null,e))}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(33),i=n(11),o=n(0),s=n(9),a=n(13);let l;const u={text_height:14,unique_id:0,version:"0.0.1"};function h(t,e,n,i,o,s,a,l){const h=(s+o)*n+4,c=t.append("g").attr("class","domain-group");c.append("text").text(e.id).attr("x",0).attr("y",h+.7*s).attr("class","jsdomain-orflabel").attr("data-locus",e.id),c.selectAll("rect.jsdomain-module").data(e.modules).enter().append("rect").attr("x",t=>l(t.start)).attr("y",h-3).attr("width",t=>l(t.end)-l(t.start)).attr("height",s+6).attr("rx",5).attr("class",t=>t.complete?"jsdomain-module":"jsdomain-module jsdomain-incomplete-module"),c.append("line").attr("y1",h+s/2).attr("y2",h+s/2).attr("x1",l(0)).attr("x2",l(e.sequence.length)).attr("class","jsdomain-line"),c.append("line").attr("x1",l(0)).attr("x2",l(0)).attr("y1",h+s/4).attr("y2",h+3*s/4).attr("class","jsdomain-line"),c.append("line").attr("x1",l(e.sequence.length)).attr("x2",l(e.sequence.length)).attr("y1",h+s/4).attr("y2",h+3*s/4).attr("class","jsdomain-line"),c.selectAll("rect.jsdomain-domain").data(e.domains).enter().append("rect").attr("x",t=>l(t.start)).attr("y",h).attr("rx",17).attr("ry",17).attr("width",t=>l(t.end)-l(t.start)).attr("height",s).attr("data-id",(t,e)=>`details-orf-${i}-${e}-tooltip`).attr("class",t=>`jsdomain-domain ${t.html_class}`).attr("stroke-width",1),c.selectAll("text.jsdomain-text").data(e.domains).enter().append("text").text(t=>t.abbreviation).attr("x",t=>l((t.start+t.end)/2)).attr("text-anchor","middle").attr("y",h+.7*s).attr("class","jsdomain-text").attr("font-size",u.text_height).attr("font-weight","bold");const g=c.selectAll("g.jsdomain-module-lid").data(e.modules.filter(t=>t.complete)).enter().append("g").attr("class","jsdomain-module-lid");g.append("rect").attr("x",t=>l(t.start)).attr("y",h-3).attr("width",t=>l(t.end)-l(t.start)).attr("height",s+6).attr("rx",5).attr("class","jsdomain-module-lid-body"),g.append("text").text(t=>t.monomer||"no prediction").attr("x",t=>l((t.start+t.end)/2)).attr("y",t=>h+s*(t.iterative?.5:.7)).attr("text-anchor","middle").attr("class","jsdomain-text");const d=r.path();d.moveTo(50,50),d.arc(0,50,50,0,Math.PI/180*45,!0),d.moveTo(50,50),d.lineTo(10,40);const f=d.toString();g.append("path").attr("d",f).attr("stroke",t=>t.iterative?"black":"none").attr("stroke-width","5px").attr("fill","none").attr("stroke-linecap","round").attr("transform",t=>{return`translate(${l((t.start+t.end)/2)}, ${h+.6*s}) scale(0.1, 0.1)`})}function c(t,e){let n=`${t.type}<br>Location: ${t.start}-${t.end} AA<br>`;if(t.napdoslink.length>0&&(n+=`<a href="${t.napdoslink}" target="_blank">Analyze with NaPDoS</a><br>`),n+=`<a href="${t.blastlink}" target="_blank">Run BlastP on this domain</a><br>`,t.predictions.length>0){n+="<dl><dt>Substrate predictions:</dt>";for(const e of t.predictions)n+=`<dd>-${e[0]}: ${e[1]}</dd>`;n+="</dl>"}return n+=`AA sequence: ${s.clipboardCopyConstruct(t.sequence)}<br>`,t.dna_sequence&&(n+=`Nucleotide sequence: ${s.clipboardCopyConstruct(t.dna_sequence)}<br>`),n}function g(t){const e=$(this).attr("data-id");if(void 0===e)return;const n=$(`#${e}`);if(l&&(clearTimeout(n.data("timeout")),l.hide()),l=n,"none"!==n.css("display"))return void n.hide();let r=$(this).offset();void 0===r&&(r={left:0,top:0});let i=setTimeout(()=>n.slideUp("fast"),5e3);n.css("top",r.top+30).css("left",r.left+10).show().click(function(){$(this).hide()}).data("timeout",i).mouseover(()=>clearTimeout(n.data("timeout"))).mouseout(()=>{clearTimeout(n.data("timeout")),i=setTimeout(()=>n.slideUp("fast"),5e3),n.data("timeout",i)})}function d(t){if($(this).hide(),t.clientX&&t.clientY){const e=document.elementFromPoint(t.clientX,t.clientY);e&&$(e).click()}$(this).show()}function f(){$("input.domains-selected-only").prop("checked")?($(".jsdomain-svg").hide(),$(".jsdomain-svg-singles").show()):($(".jsdomain-svg").show(),$(".jsdomain-svg-singles").hide()),$("input.show-module-domains").prop("checked")?$(".jsdomain-module-lid").hide():$(".jsdomain-module-lid").show()}e.drawDomains=function(t,e,n){const r=o.select(`#${t}`),l=n,p=$(`#${t}`).width()||700;r.selectAll("svg.jsdomain-svg").remove(),r.selectAll("svg.jsdomain-svg-single").remove();const v=(l+10)*e.orfs.length,m=r.append("svg").attr("height",v).attr("width","100%").attr("viewbox",`-1 -1 ${p} ${v}`).attr("class","jsdomain-svg");let y=0,b="";for(const t of e.orfs)y=Math.max(y,t.sequence.length),b.length<t.id.length&&(b=t.id);const w=m.append("g").append("text").text(b).attr("x",0).attr("y",0).attr("id","dummy-label"),x=w.node().getComputedTextLength()||15*b.length;w.remove();const A=i.scaleLinear().domain([1,1.02*y]).range([x+10,p]),C=r.append("div").attr("class","jsdomain-svg-singles"),S=l+8;for(let t=0;t<e.orfs.length;t++){const n=e.orfs[t],i=u.unique_id++;h(C.append("svg").attr("height",S).attr("width","100%").attr("viewbox",`-1 -1 ${p} ${S}`).attr("class","jsdomain-svg-single").attr("id",`${a.locusToFullId(n.id)}-domains`),n,0,i,10,l,0,A),h(m,n,t,i,10,l,0,A),r.append("div").attr("id",`details-orf-${i}`).selectAll("div.jsdomain-tooltip").data(n.domains).enter().append("div").attr("class","jsdomain-tooltip").attr("id",(t,e)=>`details-orf-${i}-${e}-tooltip`).html(t=>c(t,n)),$(".jsdomain-tooltip .clipboard-copy").off("click").click(s.copyToClipboard)}$(".jsdomain-orflabel").off("click").click(function(t){$(`#${a.locusToFullId($(this).attr("data-locus")||"none")}-svgeneorf`).trigger(t)}),o.selectAll("g.domain-group").data(e.orfs),$(".jsdomain-domain").click(g),$(".jsdomain-module-lid").click(d),f()},e.redrawDomains=f,e.createButtonHandlers=function(){$(".nrps-pks-domain-buttons * .button-like").off("click"),$("input.domains-selected-only").change(function(){$("input.domains-selected-only").prop("checked",$(this).prop("checked")),f()}),$("input.show-module-domains").change(function(){$("input.show-module-domains").prop("checked",$(this).prop("checked")),f()})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.setupContributors=function(){const t=$(".contributor"),e=new Set;t.each((t,n)=>{const r=n.id;r&&e.add(r)}),$.get("/api/v1/contributors",{ids:Array.from(e)},e=>{for(const n of e){const e=n.id;e&&t.each((t,r)=>{r.id&&r.id===e&&$(r).html(`<svg class="icon"><use xlink:href="images/icons.svg#user"></use></svg>\n                             <a href="mailto:${n.email}">${n.name}</a> (${n.organisation})`)})}})}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const r=n(11),i=n(0);function o(t,e,n){if(0===e.length)return;const o=i.select(`#record-minimap-${t}`);o.attr("width",810).attr("height",40);const s=r.scaleLinear().domain([0,n]).range([0,800]);o.append("line").attr("x1",0).attr("y1",20).attr("x2",800).attr("y2",20).attr("class","minimap-record-end centerline"),o.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",40).attr("class","minimap-record-end centerline"),o.append("line").attr("x1",800).attr("y1",0).attr("x2",800).attr("y2",40).attr("class","centerline"),o.selectAll("line.minimap-region-label-line").data(e).enter().append("line").attr("class","minimap-region-label-line centerline").attr("x1",t=>s((t.start+t.end)/2)).attr("y1",t=>parseInt(t.anchor.split("c")[1],10)%2==0?25:15).attr("x2",t=>s((t.start+t.end)/2)).attr("y2",t=>parseInt(t.anchor.split("c")[1],10)%2==0?30:10),o.selectAll("rect.minimap-region").data(e).enter().append("rect").attr("class",t=>"minimap-region "+(t.products.length>1?"hybrid":t.products[0])).attr("y",15).attr("x",t=>s(t.start)).attr("width",t=>s(t.end-t.start)).attr("height",10).style("stroke","black"),o.selectAll("text.minimap-region-label").data(e).enter().append("text").attr("x",t=>s((t.start+t.end)/2)).attr("y",20).attr("font-size","xx-small").attr("class","minimap-region-label").attr("text-anchor","middle").attr("dy",t=>(parseInt(t.anchor.split("c")[1],10)%2==0?"2":"-1.2")+"em").text(t=>t.anchor.split("c")[1])}e.createRecordOverviews=function(t){let e=0;for(const n of t)e+=1,0!==n.regions.length&&o(e,n.regions,n.length)}},function(t,e,n){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=r(n(25));function o(){const t=this,e={experimentalSSSR:!0,height:200,padding:30,width:($(t).parent().width()||270)-20},n=$(t).parent(),r=$(t).is(":visible");r||(n.detach(t.id),$("body").append(t));const o=new i.default.Drawer(e);i.default.parse(t.getAttribute("data-smiles"),e=>o.draw(e,t,"light",!1)),r||n.prepend(t),$(this).click(function(t){$(`#${$(this).attr("id")}-modal`).show();const e=$(`#${$(this).attr("id")}-modal`).children(".modal-content").children(".smiles-canvas-modal").first();if(void 0===e)return;const n={experimentalSSSR:!0,height:e.height()||500,padding:30,width:(e.width()||700)+80},r=e.parent().parent().hasClass("expanded");r||e.parent().css("display","block");const o=new i.default.Drawer(n),s=e[0];i.default.parse(s.getAttribute("data-smiles"),t=>o.draw(t,s,"light",!1)),r||$(e).parent().removeAttr("style"),$(`#${$(this).attr("id")}-modal`).children(".modal-content").css("top",`${$(this).position().top-n.height/2}px`)})}e.drawStructure=o,e.drawStructures=function(){$(".smiles-canvas").each(o),$(".modal-container").off("click").click(()=>$(".modal-container").hide())}},function(t,e,n){const r=n(26),i=n(29);var o=!("undefined"==typeof window||!window.document||!window.document.createElement),s={Version:"1.0.0"};s.Drawer=r,s.Parser=i,s.clean=function(t){return t.replace(/[^A-Za-z0-9@\.\+\-\?!\(\)\[\]\{\}\/\\=#\$:\*]/g,"")},s.apply=function(t,e="canvas[data-smiles]",n="light",i=null){let o=new r(t),a=document.querySelectorAll(e);for(var l=0;l<a.length;l++){let t=a[l];s.parse(t.getAttribute("data-smiles"),function(e){o.draw(e,t,n,!1)},function(t){i&&i(t)})}},s.parse=function(t,e,n){try{e&&e(i.parse(t))}catch(t){n&&n(t)}},o&&(window.SmilesDrawer=s),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(t){if(null==this)throw new TypeError("this is null or not defined");for(var e=Object(this),n=e.length>>>0,r=arguments[1]>>0,i=r<0?Math.max(n+r,0):Math.min(r,n),o=arguments[2],s=void 0===o?n:o>>0,a=s<0?Math.max(n+s,0):Math.min(s,n);i<a;)e[i]=t,i++;return e}}),t.exports=s},function(t,e,n){const r=n(6),i=n(7),o=n(3),s=n(14),a=(n(4),n(16)),l=n(10),u=n(5),h=n(15),c=n(27),g=n(17),d=n(28);t.exports=class{constructor(t){this.graph=null,this.doubleBondConfigCount=0,this.doubleBondConfig=null,this.ringIdCounter=0,this.ringConnectionIdCounter=0,this.canvasWrapper=null,this.totalOverlapScore=0,this.defaultOptions={width:500,height:500,bondThickness:.6,bondLength:15,shortBondLength:.85,bondSpacing:.18*15,atomVisualization:"default",isomeric:!0,debug:!1,terminalCarbons:!1,explicitHydrogens:!1,overlapSensitivity:.42,overlapResolutionIterations:1,compactDrawing:!0,fontSizeLarge:5,fontSizeSmall:3,padding:20,themes:{dark:{C:"#fff",O:"#e74c3c",N:"#3498db",F:"#27ae60",CL:"#16a085",BR:"#d35400",I:"#8e44ad",P:"#d35400",S:"#f1c40f",B:"#e67e22",SI:"#e67e22",H:"#fff",BACKGROUND:"#141414"},light:{C:"#222",O:"#e74c3c",N:"#3498db",F:"#27ae60",CL:"#16a085",BR:"#d35400",I:"#8e44ad",P:"#d35400",S:"#f1c40f",B:"#e67e22",SI:"#e67e22",H:"#222",BACKGROUND:"#fff"}}},this.opts=this.extend(!0,this.defaultOptions,t),this.opts.halfBondSpacing=this.opts.bondSpacing/2,this.opts.bondLengthSq=this.opts.bondLength*this.opts.bondLength,this.opts.halfFontSizeLarge=this.opts.fontSizeLarge/2,this.opts.quarterFontSizeLarge=this.opts.fontSizeLarge/4,this.opts.fifthFontSizeSmall=this.opts.fontSizeSmall/5,this.theme=this.opts.themes.dark}extend(){let t=this,e={},n=!1,r=0,i=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(n=arguments[0],r++);let o=function(r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n&&"[object Object]"===Object.prototype.toString.call(r[i])?e[i]=t.extend(!0,e[i],r[i]):e[i]=r[i])};for(;r<i;r++)o(arguments[r]);return e}draw(t,e,n="light",i=!1){if(this.data=t,this.infoOnly=i,this.infoOnly||(this.canvasWrapper=new c(e,this.opts.themes[n],this.opts)),this.ringIdCounter=0,this.ringConnectionIdCounter=0,this.graph=new g(t,this.opts.isomeric),this.rings=Array(),this.ringConnections=Array(),this.originalRings=Array(),this.originalRingConnections=Array(),this.bridgedRing=!1,this.doubleBondConfigCount=null,this.doubleBondConfig=null,this.initRings(),this.initHydrogens(),!this.infoOnly){this.position(),this.restoreRingInformation(),this.resolvePrimaryOverlaps();let t=this.getOverlapScore();this.totalOverlapScore=this.getOverlapScore().total;for(var o=0;o<this.opts.overlapResolutionIterations;o++)for(var s=0;s<this.graph.edges.length;s++){let e=this.graph.edges[s];if(this.isEdgeRotatable(e)){let n=this.graph.getTreeDepth(e.sourceId,e.targetId),i=this.graph.getTreeDepth(e.targetId,e.sourceId),o=e.targetId,s=e.sourceId;if(n>i&&(o=e.sourceId,s=e.targetId),this.getSubtreeOverlapScore(s,o,t.vertexScores).value>this.opts.overlapSensitivity){let e=this.graph.vertices[o],n=this.graph.vertices[s],i=n.getNeighbours(o);if(1===i.length){let t=this.graph.vertices[i[0]],o=t.position.getRotateAwayFromAngle(e.position,n.position,r.toRad(120));this.rotateSubtree(t.id,n.id,o,n.position);let s=this.getOverlapScore().total;s>this.totalOverlapScore?this.rotateSubtree(t.id,n.id,-o,n.position):this.totalOverlapScore=s}else if(2===i.length){if(0!==n.value.rings.length&&0!==e.value.rings.length)continue;let t=this.graph.vertices[i[0]],o=this.graph.vertices[i[1]];if(1===t.value.rings.length&&1===o.value.rings.length){if(t.value.rings[0]!==o.value.rings[0])continue}else{if(0!==t.value.rings.length||0!==o.value.rings.length)continue;{let i=t.position.getRotateAwayFromAngle(e.position,n.position,r.toRad(120)),s=o.position.getRotateAwayFromAngle(e.position,n.position,r.toRad(120));this.rotateSubtree(t.id,n.id,i,n.position),this.rotateSubtree(o.id,n.id,s,n.position);let a=this.getOverlapScore().total;a>this.totalOverlapScore?(this.rotateSubtree(t.id,n.id,-i,n.position),this.rotateSubtree(o.id,n.id,-s,n.position)):this.totalOverlapScore=a}}}t=this.getOverlapScore()}}}this.resolveSecondaryOverlaps(t.scores),this.opts.isomeric&&this.annotateStereochemistry(),this.opts.compactDrawing&&"default"===this.opts.atomVisualization&&this.initPseudoElements(),this.rotateDrawing(),this.canvasWrapper.scale(this.graph.vertices),this.drawEdges(this.opts.debug),this.drawVertices(this.opts.debug),this.canvasWrapper.reset()}}edgeRingCount(t){let e=this.graph.edges[t],n=this.graph.vertices[e.sourceId],r=this.graph.vertices[e.targetId];return Math.min(n.value.rings.length,r.value.rings.length)}getBridgedRings(){let t=Array();for(var e=0;e<this.rings.length;e++)this.rings[e].isBridged&&t.push(this.rings[e]);return t}getFusedRings(){let t=Array();for(var e=0;e<this.rings.length;e++)this.rings[e].isFused&&t.push(this.rings[e]);return t}getSpiros(){let t=Array();for(var e=0;e<this.rings.length;e++)this.rings[e].isSpiro&&t.push(this.rings[e]);return t}printRingInfo(){let t="";for(var e=0;e<this.rings.length;e++){const n=this.rings[e];t+=n.id+";",t+=n.members.length+";",t+=n.neighbours.length+";",t+=n.isSpiro?"true;":"false;",t+=n.isFused?"true;":"false;",t+=n.isBridged?"true;":"false;",t+=n.rings.length+";",t+="\n"}return t}rotateDrawing(){let t=0,e=0,n=0;for(var r=0;r<this.graph.vertices.length;r++){let o=this.graph.vertices[r];if(o.value.isDrawn)for(var i=r+1;i<this.graph.vertices.length;i++){let s=this.graph.vertices[i];if(!s.value.isDrawn)continue;let a=o.position.distanceSq(s.position);a>n&&(n=a,t=r,e=i)}}let s=-o.subtract(this.graph.vertices[t].position,this.graph.vertices[e].position).angle();if(!isNaN(s)){let t=s%.523599;for(t<.2617995?s-=t:s+=.523599-t,r=0;r<this.graph.vertices.length;r++)r!==e&&this.graph.vertices[r].position.rotateAround(s,this.graph.vertices[e].position);for(r=0;r<this.rings.length;r++)this.rings[r].center.rotateAround(s,this.graph.vertices[e].position)}}getTotalOverlapScore(){return this.totalOverlapScore}getRingCount(){return this.rings.length}hasBridgedRing(){return this.bridgedRing}getHeavyAtomCount(){let t=0;for(var e=0;e<this.graph.vertices.length;e++)"H"!==this.graph.vertices[e].value.element&&t++;return t}getMolecularFormula(){let t="",e=new Map;for(var n=0;n<this.graph.vertices.length;n++){let t=this.graph.vertices[n].value;if(e.has(t.element)?e.set(t.element,e.get(t.element)+1):e.set(t.element,1),t.bracket&&!t.bracket.chirality&&(e.has("H")?e.set("H",e.get("H")+t.bracket.hcount):e.set("H",t.bracket.hcount)),!t.bracket){let n=l.maxBonds[t.element]-t.bondCount;t.isPartOfAromaticRing&&n--,e.has("H")?e.set("H",e.get("H")+n):e.set("H",n)}}if(e.has("C")){let n=e.get("C");t+="C"+(n>1?n:""),e.delete("C")}if(e.has("H")){let n=e.get("H");t+="H"+(n>1?n:""),e.delete("H")}return Object.keys(l.atomicNumbers).sort().map(n=>{if(e.has(n)){let r=e.get(n);t+=n+(r>1?r:"")}}),t}getRingbondType(t,e){if(t.value.getRingbondCount()<1||e.value.getRingbondCount()<1)return null;for(var n=0;n<t.value.ringbonds.length;n++)for(var r=0;r<e.value.ringbonds.length;r++)if(t.value.ringbonds[n].id===e.value.ringbonds[r].id)return"-"===t.value.ringbonds[n].bondType?e.value.ringbonds[r].bond:t.value.ringbonds[n].bond;return null}initRings(){let t=new Map;for(var e=this.graph.vertices.length-1;e>=0;e--){let r=this.graph.vertices[e];if(0!==r.value.ringbonds.length)for(var n=0;n<r.value.ringbonds.length;n++){let e=r.value.ringbonds[n].id,i=r.value.ringbonds[n].bond;if(t.has(e)){let o=r.id,s=t.get(e)[0],l=t.get(e)[1],u=new a(o,s,1);u.setBondType(l||i||"-");let h=this.graph.addEdge(u),c=this.graph.vertices[s];r.addRingbondChild(s,n),r.value.addNeighbouringElement(c.value.element),c.addRingbondChild(o,n),c.value.addNeighbouringElement(r.value.element),r.edges.push(h),c.edges.push(h),t.delete(e)}else t.set(e,[r.id,i])}}let r=d.getRings(this.graph);if(null!==r){for(e=0;e<r.length;e++){let t=[...r[e]],i=this.addRing(new u(t));for(n=0;n<t.length;n++)this.graph.vertices[t[n]].value.rings.push(i)}for(e=0;e<this.rings.length-1;e++)for(n=e+1;n<this.rings.length;n++){let t=this.rings[e],r=this.rings[n],i=new h(t,r);i.vertices.size>0&&this.addRingConnection(i)}for(e=0;e<this.rings.length;e++){let t=this.rings[e];t.neighbours=h.getNeighbours(this.ringConnections,t.id)}for(e=0;e<this.rings.length;e++){let t=this.rings[e];this.graph.vertices[t.members[0]].value.addAnchoredRing(t.id)}for(this.backupRingInformation();this.rings.length>0;){let t=-1;for(e=0;e<this.rings.length;e++){let n=this.rings[e];this.isPartOfBridgedRing(n.id)&&!n.isBridged&&(t=n.id)}if(-1===t)break;let n=this.getRing(t),r=this.getBridgedRingRings(n.id);for(this.bridgedRing=!0,this.createBridgedRing(r,n.members[0]),e=0;e<r.length;e++)this.removeRing(r[e])}}}initHydrogens(){if(!this.opts.explicitHydrogens)for(var t=0;t<this.graph.vertices.length;t++){let e=this.graph.vertices[t];if("H"!==e.value.element)continue;let n=this.graph.vertices[e.neighbours[0]];n.value.hasHydrogen=!0,(!n.value.isStereoCenter||n.value.rings.length<2&&!n.value.bridgedRing||n.value.bridgedRing&&n.value.originalRings.length<2)&&(e.value.isDrawn=!1)}}getBridgedRingRings(t){let e=Array(),n=this,r=function(t){let i=n.getRing(t);e.push(t);for(var o=0;o<i.neighbours.length;o++){let s=i.neighbours[o];-1===e.indexOf(s)&&s!==t&&h.isBridge(n.ringConnections,n.graph.vertices,t,s)&&r(s)}};return r(t),i.unique(e)}isPartOfBridgedRing(t){for(var e=0;e<this.ringConnections.length;e++)if(this.ringConnections[e].containsRing(t)&&this.ringConnections[e].isBridge(this.graph.vertices))return!0;return!1}createBridgedRing(t,e){let n=new Set,r=new Set,o=new Set;for(var s=0;s<t.length;s++){let e=this.getRing(t[s]);e.isPartOfBridged=!0;for(var a=0;a<e.members.length;a++)r.add(e.members[a]);for(a=0;a<e.neighbours.length;a++){let n=e.neighbours[a];-1===t.indexOf(n)&&o.add(e.neighbours[a])}}let l=new Set;for(let e of r){let r=this.graph.vertices[e],o=i.intersection(t,r.value.rings);1===r.value.rings.length||1===o.length?n.add(r.id):l.add(r.id)}Array();let h=Array();for(let t of l){let e=this.graph.vertices[t],r=!1;for(let t=0;t<e.edges.length;t++)1===this.edgeRingCount(e.edges[t])&&(r=!0);r?(e.value.isBridgeNode=!0,n.add(e.id)):(e.value.isBridge=!0,n.add(e.id))}let c=new u([...n]);for(c.isBridged=!0,c.neighbours=[...o],s=0;s<t.length;s++)c.rings.push(this.getRing(t[s]).clone());for(this.addRing(c),s=0;s<c.members.length;s++)this.graph.vertices[c.members[s]].value.bridgedRing=c.id;for(s=0;s<h.length;s++)this.graph.vertices[h[s]].value.rings=Array();for(let e of n){let n=this.graph.vertices[e];n.value.rings=i.removeAll(n.value.rings,t),n.value.rings.push(c.id)}for(s=0;s<t.length;s++)for(a=s+1;a<t.length;a++)this.removeRingConnectionsBetween(t[s],t[a]);for(let e of o){let n=this.getRingConnections(e,t);for(a=0;a<n.length;a++)this.getRingConnection(n[a]).updateOther(c.id,e);this.getRing(e).neighbours.push(c.id)}return c}areVerticesInSameRing(t,e){for(var n=0;n<t.value.rings.length;n++)for(var r=0;r<e.value.rings.length;r++)if(t.value.rings[n]===e.value.rings[r])return!0;return!1}getCommonRings(t,e){let n=Array();for(var r=0;r<t.value.rings.length;r++)for(var i=0;i<e.value.rings.length;i++)t.value.rings[r]==e.value.rings[i]&&n.push(t.value.rings[r]);return n}getLargestOrAromaticCommonRing(t,e){let n=this.getCommonRings(t,e),r=0,i=null;for(var o=0;o<n.length;o++){let t=this.getRing(n[o]),e=t.getSize();if(t.isBenzeneLike(this.graph.vertices))return t;e>r&&(r=e,i=t)}return i}getVerticesAt(t,e,n){let r=Array();for(var i=0;i<this.graph.vertices.length;i++){let o=this.graph.vertices[i];o.id!==n&&o.positioned&&t.distanceSq(o.position)<=e*e&&r.push(o.id)}return r}getClosestVertex(t){let e=99999,n=null;for(var r=0;r<this.graph.vertices.length;r++){let i=this.graph.vertices[r];if(i.id===t.id)continue;let o=t.position.distanceSq(i.position);o<e&&(e=o,n=i)}return n}addRing(t){return t.id=this.ringIdCounter++,this.rings.push(t),t.id}removeRing(t){this.rings=this.rings.filter(function(e){return e.id!==t}),this.ringConnections=this.ringConnections.filter(function(e){return e.firstRingId!==t&&e.secondRingId!==t});for(var e=0;e<this.rings.length;e++){let n=this.rings[e];n.neighbours=n.neighbours.filter(function(e){return e!==t})}}getRing(t){for(var e=0;e<this.rings.length;e++)if(this.rings[e].id==t)return this.rings[e]}addRingConnection(t){return t.id=this.ringConnectionIdCounter++,this.ringConnections.push(t),t.id}removeRingConnection(t){this.ringConnections=this.ringConnections.filter(function(e){return e.id!==t})}removeRingConnectionsBetween(t,e){let n=Array();for(var r=0;r<this.ringConnections.length;r++){let i=this.ringConnections[r];(i.firstRingId===t&&i.secondRingId===e||i.firstRingId===e&&i.secondRingId===t)&&n.push(i.id)}for(r=0;r<n.length;r++)this.removeRingConnection(n[r])}getRingConnection(t){for(var e=0;e<this.ringConnections.length;e++)if(this.ringConnections[e].id==t)return this.ringConnections[e]}getRingConnections(t,e){let n=Array();for(var r=0;r<this.ringConnections.length;r++){let o=this.ringConnections[r];for(var i=0;i<e.length;i++){let r=e[i];(o.firstRingId===t&&o.secondRingId===r||o.firstRingId===r&&o.secondRingId===t)&&n.push(o.id)}}return n}getOverlapScore(){let t=0,e=new Float32Array(this.graph.vertices.length);for(var n=0;n<this.graph.vertices.length;n++)e[n]=0;for(n=0;n<this.graph.vertices.length;n++)for(var r=this.graph.vertices.length;--r>n;){let i=this.graph.vertices[n],s=this.graph.vertices[r];if(!i.value.isDrawn||!s.value.isDrawn)continue;let a=o.subtract(i.position,s.position).lengthSq();if(a<this.opts.bondLengthSq){let i=(this.opts.bondLength-Math.sqrt(a))/this.opts.bondLength;t+=i,e[n]+=i,e[r]+=i}}let i=Array();for(n=0;n<this.graph.vertices.length;n++)i.push({id:n,score:e[n]});return i.sort(function(t,e){return e.score-t.score}),{total:t,scores:i,vertexScores:e}}chooseSide(t,e,n){let r=t.getNeighbours(e.id),o=e.getNeighbours(t.id),s=r.length,a=o.length,l=i.merge(r,o),u=[0,0];for(var h=0;h<l.length;h++)this.graph.vertices[l[h]].position.sameSideAs(t.position,e.position,n[0])?u[0]++:u[1]++;let c=[0,0];for(h=0;h<this.graph.vertices.length;h++)this.graph.vertices[h].position.sameSideAs(t.position,e.position,n[0])?c[0]++:c[1]++;return{totalSideCount:c,totalPosition:c[0]>c[1]?0:1,sideCount:u,position:u[0]>u[1]?0:1,anCount:s,bnCount:a}}setRingCenter(t){let e=t.getSize(),n=new o(0,0);for(var r=0;r<e;r++)n.add(this.graph.vertices[t.members[r]].position);t.center=n.divide(e)}getSubringCenter(t,e){let n=e.value.originalRings,r=t.center,i=Number.MAX_VALUE;for(var o=0;o<n.length;o++)for(var s=0;s<t.rings.length;s++)n[o]===t.rings[s].id&&t.rings[s].getSize()<i&&(r=t.rings[s].center,i=t.rings[s].getSize());return r}drawEdges(t){let e=this,n=Array(this.graph.edges.length);if(n.fill(!1),this.graph.traverseBF(0,function(r){let i=e.graph.getEdges(r.id);for(var o=0;o<i.length;o++){let r=i[o];n[r]||(n[r]=!0,e.drawEdge(r,t))}}),!this.bridgedRing)for(var r=0;r<this.rings.length;r++){let t=this.rings[r];this.isRingAromatic(t)&&this.canvasWrapper.drawAromaticityRing(t)}}drawEdge(t,e){let n=this,r=this.graph.edges[t],a=this.graph.vertices[r.sourceId],l=this.graph.vertices[r.targetId],u=a.value.element,h=l.value.element;if(!(a.value.isDrawn&&l.value.isDrawn||"default"!==this.opts.atomVisualization))return;let c=a.position,g=l.position,d=this.getEdgeNormals(r),f=i.clone(d);if(f[0].multiplyScalar(10).add(c),f[1].multiplyScalar(10).add(c),"="===r.bondType||"="===this.getRingbondType(a,l)||r.isPartOfAromaticRing&&this.bridgedRing){let t=this.areVerticesInSameRing(a,l),e=this.chooseSide(a,l,f);if(t){let t=this.getLargestOrAromaticCommonRing(a,l).center;d[0].multiplyScalar(n.opts.bondSpacing),d[1].multiplyScalar(n.opts.bondSpacing);let e=null;(e=t.sameSideAs(a.position,l.position,o.add(c,d[0]))?new s(o.add(c,d[0]),o.add(g,d[0]),u,h):new s(o.add(c,d[1]),o.add(g,d[1]),u,h)).shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),r.isPartOfAromaticRing?this.canvasWrapper.drawLine(e,!0):this.canvasWrapper.drawLine(e),this.canvasWrapper.drawLine(new s(c,g,u,h))}else if(r.center||a.isTerminal()&&l.isTerminal()){d[0].multiplyScalar(n.opts.halfBondSpacing),d[1].multiplyScalar(n.opts.halfBondSpacing);let t=new s(o.add(c,d[0]),o.add(g,d[0]),u,h),e=new s(o.add(c,d[1]),o.add(g,d[1]),u,h);this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(e)}else if(0==e.anCount&&e.bnCount>1||0==e.bnCount&&e.anCount>1){d[0].multiplyScalar(n.opts.halfBondSpacing),d[1].multiplyScalar(n.opts.halfBondSpacing);let t=new s(o.add(c,d[0]),o.add(g,d[0]),u,h),e=new s(o.add(c,d[1]),o.add(g,d[1]),u,h);this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(e)}else if(e.sideCount[0]>e.sideCount[1]){d[0].multiplyScalar(n.opts.bondSpacing),d[1].multiplyScalar(n.opts.bondSpacing);let t=new s(o.add(c,d[0]),o.add(g,d[0]),u,h);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new s(c,g,u,h))}else if(e.sideCount[0]<e.sideCount[1]){d[0].multiplyScalar(n.opts.bondSpacing),d[1].multiplyScalar(n.opts.bondSpacing);let t=new s(o.add(c,d[1]),o.add(g,d[1]),u,h);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new s(c,g,u,h))}else if(e.totalSideCount[0]>e.totalSideCount[1]){d[0].multiplyScalar(n.opts.bondSpacing),d[1].multiplyScalar(n.opts.bondSpacing);let t=new s(o.add(c,d[0]),o.add(g,d[0]),u,h);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new s(c,g,u,h))}else if(e.totalSideCount[0]<=e.totalSideCount[1]){d[0].multiplyScalar(n.opts.bondSpacing),d[1].multiplyScalar(n.opts.bondSpacing);let t=new s(o.add(c,d[1]),o.add(g,d[1]),u,h);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new s(c,g,u,h))}}else if("#"===r.bondType){d[0].multiplyScalar(n.opts.bondSpacing/1.5),d[1].multiplyScalar(n.opts.bondSpacing/1.5);let t=new s(o.add(c,d[0]),o.add(g,d[0]),u,h),e=new s(o.add(c,d[1]),o.add(g,d[1]),u,h);this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(e),this.canvasWrapper.drawLine(new s(c,g,u,h))}else if("."===r.bondType);else{let t=a.value.isStereoCenter,e=l.value.isStereoCenter;"up"===r.wedge?this.canvasWrapper.drawWedge(new s(c,g,u,h,t,e)):"down"===r.wedge?this.canvasWrapper.drawDashedWedge(new s(c,g,u,h,t,e)):this.canvasWrapper.drawLine(new s(c,g,u,h,t,e))}if(e){let e=o.midpoint(c,g);this.canvasWrapper.drawDebugText(e.x,e.y,"e: "+t)}}drawVertices(t){var e=this.graph.vertices.length;for(e=0;e<this.graph.vertices.length;e++){let n=this.graph.vertices[e],r=n.value,s=0,a=0,u=n.value.bondCount,h=r.element,c=l.maxBonds[h]-u,g=n.getTextDirection(this.graph.vertices),d=!(!this.opts.terminalCarbons&&"C"===h&&!r.hasAttachedPseudoElements)&&n.isTerminal(),f="C"===r.element;if("N"===r.element&&r.isPartOfAromaticRing&&(c=0),r.bracket&&(c=r.bracket.hcount,s=r.bracket.charge,a=r.bracket.isotope),"allballs"===this.opts.atomVisualization)this.canvasWrapper.drawBall(n.position.x,n.position.y,h);else if(r.isDrawn&&(!f||r.drawExplicit||d||r.hasAttachedPseudoElements)||1===this.graph.vertices.length)"default"===this.opts.atomVisualization?this.canvasWrapper.drawText(n.position.x,n.position.y,h,c,g,d,s,a,r.getAttachedPseudoElements()):"balls"===this.opts.atomVisualization&&this.canvasWrapper.drawBall(n.position.x,n.position.y,h);else if(2===n.getNeighbourCount()&&1==n.forcePositioned){let t=this.graph.vertices[n.neighbours[0]].position,e=this.graph.vertices[n.neighbours[1]].position,r=o.threePointangle(n.position,t,e);Math.abs(Math.PI-r)<.1&&this.canvasWrapper.drawPoint(n.position.x,n.position.y,h)}if(t){let t="v: "+n.id+" "+i.print(r.ringbonds);this.canvasWrapper.drawDebugText(n.position.x,n.position.y,t)}}if(this.opts.debug)for(e=0;e<this.rings.length;e++){let t=this.rings[e].center;this.canvasWrapper.drawDebugPoint(t.x,t.y,"r: "+this.rings[e].id)}}position(){let t=null;for(var e=0;e<this.graph.vertices.length;e++)if(null!==this.graph.vertices[e].value.bridgedRing){t=this.graph.vertices[e];break}for(e=0;e<this.rings.length;e++)this.rings[e].isBridged&&(t=this.graph.vertices[this.rings[e].members[0]]);this.rings.length>0&&null===t&&(t=this.graph.vertices[this.rings[0].members[0]]),null===t&&(t=this.graph.vertices[0]),this.createNextBond(t,null,0)}backupRingInformation(){this.originalRings=Array(),this.originalRingConnections=Array();for(var t=0;t<this.rings.length;t++)this.originalRings.push(this.rings[t]);for(t=0;t<this.ringConnections.length;t++)this.originalRingConnections.push(this.ringConnections[t]);for(t=0;t<this.graph.vertices.length;t++)this.graph.vertices[t].value.backupRings()}restoreRingInformation(){let t=this.getBridgedRings();this.rings=Array(),this.ringConnections=Array();for(var e=0;e<t.length;e++){let r=t[e];for(var n=0;n<r.rings.length;n++){let t=r.rings[n];this.originalRings[t.id].center=t.center}}for(e=0;e<this.originalRings.length;e++)this.rings.push(this.originalRings[e]);for(e=0;e<this.originalRingConnections.length;e++)this.ringConnections.push(this.originalRingConnections[e]);for(e=0;e<this.graph.vertices.length;e++)this.graph.vertices[e].value.restoreRings()}createRing(t,e=null,n=null,i=null){if(t.positioned)return;e=e||new o(0,0);let s=t.getOrderedNeighbours(this.ringConnections),a=n?o.subtract(n.position,e).angle():0,l=r.polyCircumradius(this.opts.bondLength,t.getSize()),u=r.centralAngle(t.getSize());t.centralAngle=u;let c=a,g=this,d=n?n.id:null;if(-1===t.members.indexOf(d)&&(n&&(n.positioned=!1),d=t.members[0]),t.isBridged){this.graph.kkLayout(t.members.slice(),e,n.id,t,this.opts.bondLength),t.positioned=!0,this.setRingCenter(t),e=t.center;for(var f=0;f<t.rings.length;f++)this.setRingCenter(t.rings[f])}else t.eachMember(this.graph.vertices,function(n){let r=g.graph.vertices[n];r.positioned||r.setPosition(e.x+Math.cos(c)*l,e.y+Math.sin(c)*l),c+=u,(!t.isBridged||t.rings.length<3)&&(r.angle=c,r.positioned=!0)},d,i?i.id:null);for(t.positioned=!0,t.center=e,f=0;f<s.length;f++){let n=this.getRing(s[f].neighbour);if(n.positioned)continue;let i=h.getVertices(this.ringConnections,t.id,n.id);if(2===i.length){t.isFused=!0,n.isFused=!0;let s=this.graph.vertices[i[0]],a=this.graph.vertices[i[1]],l=o.midpoint(s.position,a.position),u=o.normals(s.position,a.position);u[0].normalize(),u[1].normalize();let h=r.polyCircumradius(this.opts.bondLength,n.getSize()),c=r.apothem(h,n.getSize());u[0].multiplyScalar(c).add(l),u[1].multiplyScalar(c).add(l);let g=u[0];o.subtract(e,u[1]).lengthSq()>o.subtract(e,u[0]).lengthSq()&&(g=u[1]);let d=o.subtract(s.position,g),f=o.subtract(a.position,g);-1===d.clockwise(f)?n.positioned||this.createRing(n,g,s,a):n.positioned||this.createRing(n,g,a,s)}else if(1===i.length){t.isSpiro=!0,n.isSpiro=!0;let s=this.graph.vertices[i[0]],a=o.subtract(e,s.position);a.invert(),a.normalize();let l=r.polyCircumradius(this.opts.bondLength,n.getSize());a.multiplyScalar(l),a.add(s.position),n.positioned||this.createRing(n,a,s)}}for(f=0;f<t.members.length;f++){let e=this.graph.vertices[t.members[f]],n=e.neighbours;for(var p=0;p<n.length;p++){let t=this.graph.vertices[n[p]];t.positioned||(t.value.isConnectedToRing=!0,this.createNextBond(t,e,0))}}}rotateSubtree(t,e,n,r){let i=this;this.graph.traverseTree(t,e,function(t){t.position.rotateAround(n,r);for(var e=0;e<t.value.anchoredRings.length;e++){let o=i.rings[t.value.anchoredRings[e]];o&&o.center.rotateAround(n,r)}})}getSubtreeOverlapScore(t,e,n){let r=this,i=0,s=new o(0,0),a=0;return this.graph.traverseTree(t,e,function(t){if(!t.value.isDrawn)return;let e=n[t.id];e>r.opts.overlapSensitivity&&(i+=e,a++);let o=r.graph.vertices[t.id].position.clone();o.multiplyScalar(e),s.add(o)}),s.divide(i),{value:i/a,center:s}}getCurrentCenterOfMass(){let t=new o(0,0),e=0;for(var n=0;n<this.graph.vertices.length;n++){let r=this.graph.vertices[n];r.positioned&&(t.add(r.position),e++)}return t.divide(e)}getCurrentCenterOfMassInNeigbourhood(t,e=2*this.opts.bondLength){let n=new o(0,0),r=0,i=e*e;for(var s=0;s<this.graph.vertices.length;s++){let e=this.graph.vertices[s];e.positioned&&t.distanceSq(e.position)<i&&(n.add(e.position),r++)}return n.divide(r)}resolvePrimaryOverlaps(){let t=Array(),e=Array(this.graph.vertices.length);for(var n=0;n<this.rings.length;n++){let o=this.rings[n];for(var r=0;r<o.members.length;r++){let n=this.graph.vertices[o.members[r]];if(e[n.id])continue;e[n.id]=!0;let s=this.getNonRingNeighbours(n.id);if(s.length>1){let e=Array();for(var i=0;i<n.value.rings.length;i++)e.push(n.value.rings[i]);t.push({common:n,rings:e,vertices:s})}else if(1===s.length&&2===n.value.rings.length){let e=Array();for(i=0;i<n.value.rings.length;i++)e.push(n.value.rings[i]);t.push({common:n,rings:e,vertices:s})}}}for(n=0;n<t.length;n++){let e=t[n];if(2===e.vertices.length){let t=e.vertices[0],n=e.vertices[1];if(!t.value.isDrawn||!n.value.isDrawn)continue;let r=(2*Math.PI-this.getRing(e.rings[0]).getAngle())/6;this.rotateSubtree(t.id,e.common.id,r,e.common.position),this.rotateSubtree(n.id,e.common.id,-r,e.common.position);let i=this.getOverlapScore(),o=this.getSubtreeOverlapScore(t.id,e.common.id,i.vertexScores),s=this.getSubtreeOverlapScore(n.id,e.common.id,i.vertexScores),a=o.value+s.value;this.rotateSubtree(t.id,e.common.id,-2*r,e.common.position),this.rotateSubtree(n.id,e.common.id,2*r,e.common.position),i=this.getOverlapScore(),o=this.getSubtreeOverlapScore(t.id,e.common.id,i.vertexScores),s=this.getSubtreeOverlapScore(n.id,e.common.id,i.vertexScores),o.value+s.value>a&&(this.rotateSubtree(t.id,e.common.id,2*r,e.common.position),this.rotateSubtree(n.id,e.common.id,-2*r,e.common.position))}else 1===e.vertices.length&&e.rings.length}}resolveSecondaryOverlaps(t){for(var e=0;e<t.length;e++)if(t[e].score>this.opts.overlapSensitivity){let n=this.graph.vertices[t[e].id];if(n.isTerminal()){let t=this.getClosestVertex(n);if(t){let e=null;e=t.isTerminal()?0===t.id?this.graph.vertices[1].position:t.previousPosition:0===t.id?this.graph.vertices[1].position:t.position;let i=0===n.id?this.graph.vertices[1].position:n.previousPosition;n.position.rotateAwayFrom(e,i,r.toRad(20))}}}}getLastVertexWithAngle(t){let e=0,n=null;for(;!e&&t;)e=(n=this.graph.vertices[t]).angle,t=n.parentVertexId;return n}createNextBond(t,e=null,n=0,s=!1,a=!1){if(t.positioned&&!a)return;let l=!1;if(e){let n=this.graph.getEdge(t.id,e.id);"/"!==n.bondType&&"\\"!==n.bondType||++this.doubleBondConfigCount%2!=1||null===this.doubleBondConfig&&(this.doubleBondConfig=n.bondType,l=!0,null===e.parentVertexId&&t.value.branchBond&&("/"===this.doubleBondConfig?this.doubleBondConfig="\\":"\\"===this.doubleBondConfig&&(this.doubleBondConfig="/")))}if(!a)if(e)if(e.value.rings.length>0){let n=e.neighbours,r=null,s=new o(0,0);if(null===e.value.bridgedRing&&e.value.rings.length>1)for(var u=0;u<n.length;u++){let t=this.graph.vertices[n[u]];if(i.containsAll(t.value.rings,e.value.rings)){r=t;break}}if(null===r){for(u=0;u<n.length;u++){let t=this.graph.vertices[n[u]];t.positioned&&this.areVerticesInSameRing(t,e)&&s.add(o.subtract(t.position,e.position))}s.invert().normalize().multiplyScalar(this.opts.bondLength).add(e.position)}else s=r.position.clone().rotateAround(Math.PI,e.position);t.previousPosition=e.position,t.setPositionFromVector(s),t.positioned=!0}else{let r=new o(this.opts.bondLength,0);r.rotate(n),r.add(e.position),t.setPositionFromVector(r),t.previousPosition=e.position,t.positioned=!0}else{let e=new o(this.opts.bondLength,0);e.rotate(r.toRad(-60)),t.previousPosition=e,t.setPosition(this.opts.bondLength,0),t.angle=r.toRad(-60),null===t.value.bridgedRing&&(t.positioned=!0)}if(null!==t.value.bridgedRing){let e=this.getRing(t.value.bridgedRing);if(!e.positioned){let n=o.subtract(t.previousPosition,t.position);n.invert(),n.normalize();let i=r.polyCircumradius(this.opts.bondLength,e.members.length);n.multiplyScalar(i),n.add(t.position),this.createRing(e,n,t)}}else if(t.value.rings.length>0){let e=this.getRing(t.value.rings[0]);if(!e.positioned){let n=o.subtract(t.previousPosition,t.position);n.invert(),n.normalize();let i=r.polyCircumradius(this.opts.bondLength,e.getSize());n.multiplyScalar(i),n.add(t.position),this.createRing(e,n,t)}}else{t.value.isStereoCenter;let n=t.getNeighbours(),a=Array();for(u=0;u<n.length;u++)this.graph.vertices[n[u]].value.isDrawn&&a.push(n[u]);e&&(a=i.remove(a,e.id));let h=t.getAngle();if(1===a.length){let n=this.graph.vertices[a[0]];if("#"===t.value.bondType||e&&"#"===e.value.bondType||"="===t.value.bondType&&e&&0===e.value.rings.length&&"="===e.value.bondType&&"-"!==t.value.branchBond)t.value.drawExplicit=!1,e&&(this.graph.getEdge(t.id,e.id).center=!0),this.graph.getEdge(t.id,n.id).center=!0,("#"===t.value.bondType||e&&"#"===e.value.bondType)&&(n.angle=0),n.drawExplicit=!0,this.createNextBond(n,t,h+n.angle);else if(e&&e.value.rings.length>0){let e=r.toRad(60),i=-e,s=new o(this.opts.bondLength,0),a=new o(this.opts.bondLength,0);s.rotate(e).add(t.position),a.rotate(i).add(t.position);let l=this.getCurrentCenterOfMass(),u=s.distanceSq(l),c=a.distanceSq(l);n.angle=u<c?i:e,this.createNextBond(n,t,h+n.angle)}else{let r=t.angle;if(e&&e.neighbours.length>3?r=r>0?Math.min(1.0472,r):r<0?Math.max(-1.0472,r):1.0472:r||(r=this.getLastVertexWithAngle(t.id).angle)||(r=1.0472),e&&!l){let e=this.graph.getEdge(t.id,n.id).bondType;"/"===e?("/"===this.doubleBondConfig||"\\"===this.doubleBondConfig&&(r=-r),this.doubleBondConfig=null):"\\"===e&&("/"===this.doubleBondConfig?r=-r:this.doubleBondConfig,this.doubleBondConfig=null)}n.angle=s?r:-r,this.createNextBond(n,t,h+n.angle)}}else if(2===a.length){let n=t.angle;n||(n=1.0472);let r=this.graph.getTreeDepth(a[0],t.id),i=this.graph.getTreeDepth(a[1],t.id),o=this.graph.vertices[a[0]],s=this.graph.vertices[a[1]];o.value.subtreeDepth=r,s.value.subtreeDepth=i;let l=this.graph.getTreeDepth(e?e.id:null,t.id);e&&(e.value.subtreeDepth=l);let u=0,c=1;"C"===s.value.element&&"C"!==o.value.element&&i>1&&r<5?(u=1,c=0):"C"!==s.value.element&&"C"===o.value.element&&r>1&&i<5?(u=0,c=1):i>r&&(u=1,c=0);let g=this.graph.vertices[a[u]],d=this.graph.vertices[a[c]],f=(this.graph.getEdge(t.id,g.id),this.graph.getEdge(t.id,d.id),!1);l<r&&l<i&&(f=!0),d.angle=n,g.angle=-n,"\\"===this.doubleBondConfig?"\\"===d.value.branchBond&&(d.angle=-n,g.angle=n):"/"===this.doubleBondConfig&&"/"===d.value.branchBond&&(d.angle=-n,g.angle=n),this.createNextBond(d,t,h+d.angle,f),this.createNextBond(g,t,h+g.angle,f)}else if(3===a.length){let n=this.graph.getTreeDepth(a[0],t.id),i=this.graph.getTreeDepth(a[1],t.id),o=this.graph.getTreeDepth(a[2],t.id),s=this.graph.vertices[a[0]],l=this.graph.vertices[a[1]],u=this.graph.vertices[a[2]];s.value.subtreeDepth=n,l.value.subtreeDepth=i,u.value.subtreeDepth=o,i>n&&i>o?(s=this.graph.vertices[a[1]],l=this.graph.vertices[a[0]],u=this.graph.vertices[a[2]]):o>n&&o>i&&(s=this.graph.vertices[a[2]],l=this.graph.vertices[a[0]],u=this.graph.vertices[a[1]]),e&&e.value.rings.length<1&&s.value.rings.length<1&&l.value.rings.length<1&&u.value.rings.length<1&&1===this.graph.getTreeDepth(l.id,t.id)&&1===this.graph.getTreeDepth(u.id,t.id)&&this.graph.getTreeDepth(s.id,t.id)>1?(s.angle=-t.angle,t.angle>=0?(l.angle=r.toRad(30),u.angle=r.toRad(90)):(l.angle=-r.toRad(30),u.angle=-r.toRad(90)),this.createNextBond(s,t,h+s.angle),this.createNextBond(l,t,h+l.angle),this.createNextBond(u,t,h+u.angle)):(s.angle=0,l.angle=r.toRad(90),u.angle=-r.toRad(90),this.createNextBond(s,t,h+s.angle),this.createNextBond(l,t,h+l.angle),this.createNextBond(u,t,h+u.angle))}else if(4===a.length){let e=this.graph.getTreeDepth(a[0],t.id),n=this.graph.getTreeDepth(a[1],t.id),i=this.graph.getTreeDepth(a[2],t.id),o=this.graph.getTreeDepth(a[3],t.id),s=this.graph.vertices[a[0]],l=this.graph.vertices[a[1]],u=this.graph.vertices[a[2]],c=this.graph.vertices[a[3]];s.value.subtreeDepth=e,l.value.subtreeDepth=n,u.value.subtreeDepth=i,c.value.subtreeDepth=o,n>e&&n>i&&n>o?(s=this.graph.vertices[a[1]],l=this.graph.vertices[a[0]],u=this.graph.vertices[a[2]],c=this.graph.vertices[a[3]]):i>e&&i>n&&i>o?(s=this.graph.vertices[a[2]],l=this.graph.vertices[a[0]],u=this.graph.vertices[a[1]],c=this.graph.vertices[a[3]]):o>e&&o>n&&o>i&&(s=this.graph.vertices[a[3]],l=this.graph.vertices[a[0]],u=this.graph.vertices[a[1]],c=this.graph.vertices[a[2]]),s.angle=-r.toRad(36),l.angle=r.toRad(36),u.angle=-r.toRad(108),c.angle=r.toRad(108),this.createNextBond(s,t,h+s.angle),this.createNextBond(l,t,h+l.angle),this.createNextBond(u,t,h+u.angle),this.createNextBond(c,t,h+c.angle)}}}getCommonRingbondNeighbour(t){let e=t.neighbours;for(var n=0;n<e.length;n++){let r=this.graph.vertices[e[n]];if(i.containsAll(r.value.rings,t.value.rings))return r}return null}isPointInRing(t){for(var e=0;e<this.rings.length;e++){let n=this.rings[e];if(!n.positioned)continue;let i=r.polyCircumradius(this.opts.bondLength,n.getSize()),o=i*i;if(t.distanceSq(n.center)<o)return!0}return!1}isEdgeInRing(t){let e=this.graph.vertices[t.sourceId],n=this.graph.vertices[t.targetId];return this.areVerticesInSameRing(e,n)}isEdgeRotatable(t){let e=this.graph.vertices[t.sourceId],n=this.graph.vertices[t.targetId];return!("-"!==t.bondType||e.isTerminal()||n.isTerminal()||e.value.rings.length>0&&n.value.rings.length>0&&this.areVerticesInSameRing(e,n))}isRingAromatic(t){for(var e=0;e<t.members.length;e++)if(!this.graph.vertices[t.members[e]].value.isPartOfAromaticRing)return!1;return!0}getEdgeNormals(t){let e=this.graph.vertices[t.sourceId].position,n=this.graph.vertices[t.targetId].position;return o.units(e,n)}getNonRingNeighbours(t){let e=Array(),n=this.graph.vertices[t],r=n.neighbours;for(var o=0;o<r.length;o++){let t=this.graph.vertices[r[o]];0===i.intersection(n.value.rings,t.value.rings).length&&0==t.value.isBridge&&e.push(t)}return e}annotateStereochemistry(){for(var t=0;t<this.graph.vertices.length;t++){let o=this.graph.vertices[t];if(!o.value.isStereoCenter)continue;let s=o.getNeighbours(),a=s.length,l=Array(a);for(var e=0;e<a;e++){let t=new Uint8Array(this.graph.vertices.length),r=Array(Array());t[o.id]=1,this.visitStereochemistry(s[e],o.id,t,r,10,0);for(var n=0;n<r.length;n++)r[n].sort(function(t,e){return e-t});l[e]=[e,r]}let u=0,h=0;for(e=0;e<l.length;e++)for(l[e][1].length>u&&(u=l[e][1].length),n=0;n<l[e][1].length;n++)l[e][1][n].length>h&&(h=l[e][1][n].length);for(e=0;e<l.length;e++){let t=u-l[e][1].length;for(n=0;n<t;n++)l[e][1].push([]);for(l[e][1].push([s[e]]),n=0;n<l[e][1].length;n++){let t=h-l[e][1][n].length;for(var i=0;i<t;i++)l[e][1][n].push(0)}}l.sort(function(t,e){for(var n=0;n<t[1].length;n++)for(var r=0;r<t[1][n].length;r++){if(t[1][n][r]>e[1][n][r])return-1;if(t[1][n][r]<e[1][n][r])return 1}return 0});let c=new Uint8Array(a);for(e=0;e<a;e++)c[e]=l[e][0],o.value.priority=e;let g=this.graph.vertices[s[c[0]]].position,d=this.graph.vertices[s[c[1]]].position,f=this.graph.vertices[s[c[2]]].position,p=g.relativeClockwise(d,o.position),v=(g.relativeClockwise(f,o.position),-1===p),m="@"===o.value.bracket.chirality?-1:1,y=r.parityOfPermutation(c)*m==1?"R":"S",b="down",w="up";(v&&"R"!==y||!v&&"S"!==y)&&(o.value.hydrogenDirection="up",b="up",w="down"),o.value.hasHydrogen&&(this.graph.getEdge(o.id,s[c[c.length-1]]).wedge=b);let x=new Array(s.length-1),A=o.value.rings.length>1&&o.value.hasHydrogen,C=o.value.hasHydrogen?1:0;for(e=0;e<c.length-C;e++){x[e]=new Uint32Array(2);let t=this.graph.vertices[s[c[e]]];x[e][0]+=t.value.isStereoCenter?0:1e5,x[e][0]+=this.areVerticesInSameRing(t,o)?0:1e4,x[e][0]+=t.value.isHeteroAtom()?1e3:0,x[e][0]-=0===t.value.subtreeDepth?1e3:0,x[e][0]+=1e3-t.value.subtreeDepth,x[e][1]=s[c[e]]}if(x.sort(function(t,e){return t[0]>e[0]?-1:t[0]<e[0]?1:0}),!A){let t=x[0][1];if(o.value.hasHydrogen)this.graph.getEdge(o.id,t).wedge=w;else{let n=w;for(e=c.length-1;e>=0&&(n=n===b?w:b,s[c[e]]!==t);e--);this.graph.getEdge(o.id,t).wedge=n}}o.value.chirality=y}}visitStereochemistry(t,e,n,r,i,o,s=0){n[t]=1;let a=this.graph.vertices[t],l=a.value.getAtomicNumber();r.length<=o&&r.push(Array());for(var u=0;u<this.graph.getEdge(t,e).weight;u++)r[o].push(1e3*s+l);let h=this.graph.vertices[t].neighbours;for(u=0;u<h.length;u++)1!==n[h[u]]&&o<i-1&&this.visitStereochemistry(h[u],t,n.slice(),r,i,o+1,l);if(o<i-1){let e=0;for(u=0;u<h.length;u++)e+=this.graph.getEdge(t,h[u]).weight;for(u=0;u<a.value.getMaxBonds()-e;u++)r.length<=o+1&&r.push(Array()),r[o+1].push(1e3*l+1)}}initPseudoElements(){for(var t=0;t<this.graph.vertices.length;t++){const n=this.graph.vertices[t],r=n.neighbours;let i=Array(r.length);for(var e=0;e<r.length;e++)i[e]=this.graph.vertices[r[e]];if(n.getNeighbourCount()<3||n.value.rings.length>0)continue;if("P"===n.value.element)continue;if("C"===n.value.element&&3===i.length&&"N"===i[0].value.element&&"N"===i[1].value.element&&"N"===i[2].value.element)continue;let o=0,s=0;for(e=0;e<i.length;e++){let t=i[e],n=t.value.element,r=t.getNeighbourCount();"C"!==n&&"H"!==n&&1===r&&o++,r>1&&s++}if(s>1||o<2)continue;let a=null;for(e=0;e<i.length;e++){let t=i[e];t.getNeighbourCount()>1&&(a=t)}for(e=0;e<i.length;e++){let t=i[e];if(t.getNeighbourCount()>1)continue;t.value.isDrawn=!1;let r=l.maxBonds[t.value.element]-t.value.bondCount,o="";t.value.bracket&&(r=t.value.bracket.hcount,o=t.value.bracket.charge||0),n.value.attachPseudoElement(t.value.element,a?a.value.element:null,r,o)}}for(t=0;t<this.graph.vertices.length;t++){const n=this.graph.vertices[t],r=n.value,i=r.element;if("C"===i||"H"===i||!r.isDrawn)continue;const o=n.neighbours;let s=Array(o.length);for(e=0;e<o.length;e++)s[e]=this.graph.vertices[o[e]];for(e=0;e<s.length;e++){let t=s[e].value;if(!t.hasAttachedPseudoElements||2!==t.getAttachedPseudoElementsCount())continue;const r=t.getAttachedPseudoElements();r.hasOwnProperty("0O")&&r.hasOwnProperty("3C")&&(t.isDrawn=!1,n.value.attachPseudoElement("Ac","",0))}}}}},function(t,e,n){const r=n(6),i=n(3);n(14),n(4),n(5);t.exports=class{constructor(t,e,n){"string"==typeof t||t instanceof String?this.canvas=document.getElementById(t):this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.colors=e,this.opts=n,this.drawingWidth=0,this.drawingHeight=0,this.offsetX=0,this.offsetY=0,this.fontLarge=this.opts.fontSizeLarge+"pt Helvetica, Arial, sans-serif",this.fontSmall=this.opts.fontSizeSmall+"pt Helvetica, Arial, sans-serif",this.updateSize(this.opts.width,this.opts.height),this.ctx.font=this.fontLarge,this.hydrogenWidth=this.ctx.measureText("H").width,this.halfHydrogenWidth=this.hydrogenWidth/2,this.halfBondThickness=this.opts.bondThickness/2}updateSize(t,e){this.devicePixelRatio=window.devicePixelRatio||1,this.backingStoreRatio=this.ctx.webkitBackingStorePixelRatio||this.ctx.mozBackingStorePixelRatio||this.ctx.msBackingStorePixelRatio||this.ctx.oBackingStorePixelRatio||this.ctx.backingStorePixelRatio||1,this.ratio=this.devicePixelRatio/this.backingStoreRatio,1!==this.ratio?(this.canvas.width=t*this.ratio,this.canvas.height=e*this.ratio,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px",this.ctx.setTransform(this.ratio,0,0,this.ratio,0,0)):(this.canvas.width=t*this.ratio,this.canvas.height=e*this.ratio)}setTheme(t){this.colors=t}scale(t){let e=-Number.MAX_VALUE,n=-Number.MAX_VALUE,r=Number.MAX_VALUE,i=Number.MAX_VALUE;for(var o=0;o<t.length;o++){if(!t[o].value.isDrawn)continue;let s=t[o].position;e<s.x&&(e=s.x),n<s.y&&(n=s.y),r>s.x&&(r=s.x),i>s.y&&(i=s.y)}var s=this.opts.padding;e+=s,n+=s,r-=s,i-=s,this.drawingWidth=e-r,this.drawingHeight=n-i;var a=this.canvas.offsetWidth/this.drawingWidth,l=this.canvas.offsetHeight/this.drawingHeight,u=a<l?a:l;this.ctx.scale(u,u),this.offsetX=-r,this.offsetY=-i,a<l?this.offsetY+=this.canvas.offsetHeight/(2*u)-this.drawingHeight/2:this.offsetX+=this.canvas.offsetWidth/(2*u)-this.drawingWidth/2}reset(){this.ctx.setTransform(1,0,0,1,0,0)}getColor(t){return(t=t.toUpperCase())in this.colors?this.colors[t]:this.colors.C}drawCircle(t,e,n,i,o=!0,s=!1,a=""){let l=this.ctx,u=this.offsetX,h=this.offsetY;l.save(),l.lineWidth=1.5,l.beginPath(),l.arc(t+u,e+h,n,0,r.twoPI,!0),l.closePath(),s?(o?(l.fillStyle="#f00",l.fill()):(l.strokeStyle="#f00",l.stroke()),this.drawDebugText(t,e,a)):o?(l.fillStyle=i,l.fill()):(l.strokeStyle=i,l.stroke()),l.restore()}drawLine(t,e=!1,n=1){let r=this.ctx,i=this.offsetX,o=this.offsetY,s=t.clone().shorten(4),a=s.getLeftVector().clone(),l=s.getRightVector().clone();a.x+=i,a.y+=o,l.x+=i,l.y+=o,e||(r.save(),r.globalCompositeOperation="destination-out",r.beginPath(),r.moveTo(a.x,a.y),r.lineTo(l.x,l.y),r.lineCap="round",r.lineWidth=this.opts.bondThickness+1.2,r.strokeStyle=this.getColor("BACKGROUND"),r.stroke(),r.globalCompositeOperation="source-over",r.restore()),a=t.getLeftVector().clone(),l=t.getRightVector().clone(),a.x+=i,a.y+=o,l.x+=i,l.y+=o,r.save(),r.beginPath(),r.moveTo(a.x,a.y),r.lineTo(l.x,l.y),r.lineCap="round",r.lineWidth=this.opts.bondThickness;let u=this.ctx.createLinearGradient(a.x,a.y,l.x,l.y);u.addColorStop(.4,this.getColor(t.getLeftElement())||this.getColor("C")),u.addColorStop(.6,this.getColor(t.getRightElement())||this.getColor("C")),e&&(r.setLineDash([1,1.5]),r.lineWidth=this.opts.bondThickness/1.5),n<1&&(r.globalAlpha=n),r.strokeStyle=u,r.stroke(),r.restore()}drawWedge(t,e=1){if(isNaN(t.from.x)||isNaN(t.from.y)||isNaN(t.to.x)||isNaN(t.to.y))return;let n=this.ctx,r=this.offsetX,o=this.offsetY,s=t.clone().shorten(5),a=s.getLeftVector().clone(),l=s.getRightVector().clone();a.x+=r,a.y+=o,l.x+=r,l.y+=o,a=t.getLeftVector().clone(),l=t.getRightVector().clone(),a.x+=r,a.y+=o,l.x+=r,l.y+=o,n.save();let u=i.normals(a,l);u[0].normalize(),u[1].normalize();let h=a,c=l;t.getRightChiral()&&(h=l,c=a);let g=i.add(h,i.multiplyScalar(u[0],this.halfBondThickness)),d=i.add(c,i.multiplyScalar(u[0],1.5+this.halfBondThickness)),f=i.add(c,i.multiplyScalar(u[1],1.5+this.halfBondThickness)),p=i.add(h,i.multiplyScalar(u[1],this.halfBondThickness));n.beginPath(),n.moveTo(g.x,g.y),n.lineTo(d.x,d.y),n.lineTo(f.x,f.y),n.lineTo(p.x,p.y);let v=this.ctx.createRadialGradient(l.x,l.y,this.opts.bondLength,l.x,l.y,0);v.addColorStop(.4,this.getColor(t.getLeftElement())||this.getColor("C")),v.addColorStop(.6,this.getColor(t.getRightElement())||this.getColor("C")),n.fillStyle=v,n.fill(),n.restore()}drawDashedWedge(t){if(isNaN(t.from.x)||isNaN(t.from.y)||isNaN(t.to.x)||isNaN(t.to.y))return;let e=this.ctx,n=this.offsetX,r=this.offsetY,o=t.getLeftVector().clone(),s=t.getRightVector().clone();o.x+=n,o.y+=r,s.x+=n,s.y+=r,e.save();let a=i.normals(o,s);a[0].normalize(),a[1].normalize();let l,u,h,c,g=t.getRightChiral(),d=t.clone();g?(l=s,u=o,d.shortenRight(1),h=d.getRightVector().clone(),c=d.getLeftVector().clone()):(l=o,u=s,d.shortenLeft(1),h=d.getLeftVector().clone(),c=d.getRightVector().clone()),h.x+=n,h.y+=r,c.x+=n,c.y+=r;let f=i.subtract(u,l).normalize();e.strokeStyle=this.getColor("C"),e.lineCap="round",e.lineWidth=this.opts.bondThickness,e.beginPath();let p=t.getLength(),v=1.25/(p/(3*this.opts.bondThickness)),m=!1;for(var y=0;y<1;y+=v){let n=i.multiplyScalar(f,y*p),r=i.add(l,n),o=1.5*y,s=i.multiplyScalar(a[0],o);!m&&y>.5&&(e.stroke(),e.beginPath(),e.strokeStyle=this.getColor(t.getRightElement())||this.getColor("C"),m=!0),r.subtract(s),e.moveTo(r.x,r.y),r.add(i.multiplyScalar(s,2)),e.lineTo(r.x,r.y)}e.stroke(),e.restore()}drawDebugText(t,e,n){let r=this.ctx;r.save(),r.font="5px Droid Sans, sans-serif",r.textAlign="start",r.textBaseline="top",r.fillStyle="#ff0000",r.fillText(n,t+this.offsetX,e+this.offsetY),r.restore()}drawBall(t,e,n){let i=this.ctx;i.save(),i.beginPath(),i.arc(t+this.offsetX,e+this.offsetY,this.opts.bondLength/4.5,0,r.twoPI,!1),i.fillStyle=this.getColor(n),i.fill(),i.restore()}drawPoint(t,e,n){let i=this.ctx,o=this.offsetX,s=this.offsetY;i.save(),i.globalCompositeOperation="destination-out",i.beginPath(),i.arc(t+o,e+s,1.5,0,r.twoPI,!0),i.closePath(),i.fill(),i.globalCompositeOperation="source-over",i.beginPath(),i.arc(t+this.offsetX,e+this.offsetY,.75,0,r.twoPI,!1),i.fillStyle=this.getColor(n),i.fill(),i.restore()}drawText(t,e,n,i,o,s,a,l,u={}){let h=this.ctx,c=this.offsetX,g=this.offsetY;h.save(),h.textAlign="start",h.textBaseline="alphabetic";let d="",f=0;a&&(d=this.getChargeText(a),h.font=this.fontSmall,f=h.measureText(d).width);let p="0",v=0;l>0&&(p=l.toString(),h.font=this.fontSmall,v=h.measureText(p).width),1===a&&"N"===n&&u.hasOwnProperty("0O")&&u.hasOwnProperty("0O-1")&&(u={"0O":{element:"O",count:2,hydrogenCount:0,previousElement:"C",charge:""}},a=0),h.font=this.fontLarge,h.fillStyle=this.getColor("BACKGROUND");let m=h.measureText(n);m.totalWidth=m.width+f,m.height=parseInt(this.fontLarge,10);let y=m.width>this.opts.fontSizeLarge?m.width:this.opts.fontSizeLarge;y/=1.5,h.globalCompositeOperation="destination-out",h.beginPath(),h.arc(t+c,e+g,y,0,r.twoPI,!0),h.closePath(),h.fill(),h.globalCompositeOperation="source-over";let b=-m.width/2,w=-m.width/2;h.fillStyle=this.getColor(n),h.fillText(n,t+c+b,e+this.opts.halfFontSizeLarge+g),b+=m.width,a&&(h.font=this.fontSmall,h.fillText(d,t+c+b,e-this.opts.fifthFontSizeSmall+g),b+=f),l>0&&(h.font=this.fontSmall,h.fillText(p,t+c+w-v,e-this.opts.fifthFontSizeSmall+g),w-=v),h.font=this.fontLarge;let x=0,A=0;if(1===i){let n=t+c,r=e+g+this.opts.halfFontSizeLarge;w-=x=this.hydrogenWidth,"left"===o?n+=w:"right"===o?n+=b:"up"===o&&s?n+=b:"down"===o&&s?n+=b:"up"!==o||s?"down"!==o||s||(r+=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,n-=this.halfHydrogenWidth):(r-=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,n-=this.halfHydrogenWidth),h.fillText("H",n,r),b+=x}else if(i>1){let n=t+c,r=e+g+this.opts.halfFontSizeLarge;x=this.hydrogenWidth,h.font=this.fontSmall,w-=x+(A=h.measureText(i).width),"left"===o?n+=w:"right"===o?n+=b:"up"===o&&s?n+=b:"down"===o&&s?n+=b:"up"!==o||s?"down"!==o||s||(r+=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,n-=this.halfHydrogenWidth):(r-=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,n-=this.halfHydrogenWidth),h.font=this.fontLarge,h.fillText("H",n,r),h.font=this.fontSmall,h.fillText(i,n+this.halfHydrogenWidth+A,r+this.opts.fifthFontSizeSmall),b+=x+this.halfHydrogenWidth+A}for(let n in u){if(!u.hasOwnProperty(n))continue;let r=0,i=0,s=u[n].element,a=u[n].count,l=u[n].hydrogenCount,d=u[n].charge;h.font=this.fontLarge,a>1&&l>0&&(r=h.measureText("(").width,i=h.measureText(")").width);let f=h.measureText(s).width,p=0,v="",m=0;x=0,l>0&&(x=this.hydrogenWidth),h.font=this.fontSmall,a>1&&(p=h.measureText(a).width),0!==d&&(v=this.getChargeText(d),m=h.measureText(v).width),A=0,l>1&&(A=h.measureText(l).width),h.font=this.fontLarge;let y=t+c,C=e+g+this.opts.halfFontSizeLarge;h.fillStyle=this.getColor(s),a>0&&(w-=p),a>1&&l>0&&("left"===o?(w-=i,h.fillText(")",y+w,C)):(h.fillText("(",y+b,C),b+=r)),"left"===o?(w-=f,h.fillText(s,y+w,C)):(h.fillText(s,y+b,C),b+=f),l>0&&("left"===o?(w-=x+A,h.fillText("H",y+w,C),l>1&&(h.font=this.fontSmall,h.fillText(l,y+w+x,C+this.opts.fifthFontSizeSmall))):(h.fillText("H",y+b,C),b+=x,l>1&&(h.font=this.fontSmall,h.fillText(l,y+b,C+this.opts.fifthFontSizeSmall),b+=A))),h.font=this.fontLarge,a>1&&l>0&&("left"===o?(w-=r,h.fillText("(",y+w,C)):(h.fillText(")",y+b,C),b+=i)),h.font=this.fontSmall,a>1&&("left"===o?h.fillText(a,y+w+r+i+x+A+f,C+this.opts.fifthFontSizeSmall):(h.fillText(a,y+b,C+this.opts.fifthFontSizeSmall),b+=p)),0!==d&&("left"===o?h.fillText(v,y+w+r+i+x+A+f,e-this.opts.fifthFontSizeSmall+g):(h.fillText(v,y+b,e-this.opts.fifthFontSizeSmall+g),b+=m))}h.restore()}getChargeText(t){return 1===t?"+":2===t?"2+":-1===t?"-":-2===t?"2-":""}drawDebugPoint(t,e,n="",r="#f00"){this.drawCircle(t,e,2,r,!0,!0,n)}drawAromaticityRing(t){let e=this.ctx,n=r.apothemFromSideLength(this.opts.bondLength,t.getSize());e.save(),e.strokeStyle=this.getColor("C"),e.lineWidth=this.opts.bondThickness,e.beginPath(),e.arc(t.center.x+this.offsetX,t.center.y+this.offsetY,n-this.opts.bondSpacing,0,2*Math.PI,!0),e.closePath(),e.stroke(),e.restore()}clear(){this.ctx.clearRect(0,0,this.canvas.offsetWidth,this.canvas.offsetHeight)}}},function(t,e,n){const r=n(17);class i{static getRings(t){let e=t.getComponentsAdjacencyMatrix();if(0===e.length)return null;let n=r.getConnectedComponents(e),o=Array();for(var s=0;s<n.length;s++){let e=n[s],r=t.getSubgraphAdjacencyMatrix([...e]),u=new Uint16Array(r.length),h=new Uint16Array(r.length);for(var a=0;a<r.length;a++){h[a]=0,u[a]=0;for(var l=0;l<r[a].length;l++)u[a]+=r[a][l]}let c=0;for(a=0;a<r.length;a++)for(l=a+1;l<r.length;l++)c+=r[a][l];let g=c-r.length+1,d=!0;for(a=0;a<u.length;a++)3!==u[a]&&(d=!1);if(d&&(g=2+c-r.length),1===g){o.push([...e]);continue}let{d:f,pe:p,pe_prime:v}=i.getPathIncludedDistanceMatrices(r),m=i.getRingCandidates(f,p,v),y=i.getSSSR(m,f,r,p,v,u,h,g);for(a=0;a<y.length;a++){let t=Array(y[a].size),n=0;for(let r of y[a])t[n++]=e[r];o.push(t)}}return o}static matrixToString(t){let e="";for(var n=0;n<t.length;n++){for(var r=0;r<t[n].length;r++)e+=t[n][r]+" ";e+="\n"}return e}static getPathIncludedDistanceMatrices(t){let e=t.length,n=Array(e),r=Array(e),i=Array(e);for(var o=0,s=0,a=0,l=e;l--;){n[l]=Array(e),r[l]=Array(e),i[l]=Array(e);for(var u=e;u--;)n[l][u]=l===u||1===t[l][u]?t[l][u]:Number.POSITIVE_INFINITY,1===n[l][u]?r[l][u]=[[[l,u]]]:r[l][u]=Array(),i[l][u]=Array()}for(var h=e;h--;)for(l=e;l--;)for(u=e;u--;){const t=n[l][u],e=n[l][h]+n[h][u];if(t>e){if(t===e+1)for(i[l][u]=[r[l][u].length],o=r[l][u].length;o--;)for(i[l][u][o]=[r[l][u][o].length],s=r[l][u][o].length;s--;)for(i[l][u][o][s]=[r[l][u][o][s].length],a=r[l][u][o][s].length;a--;)i[l][u][o][s][a]=[r[l][u][o][s][0],r[l][u][o][s][1]];else i[l][u]=Array();for(n[l][u]=e,r[l][u]=[[]],o=r[l][h][0].length;o--;)r[l][u][0].push(r[l][h][0][o]);for(o=r[h][u][0].length;o--;)r[l][u][0].push(r[h][u][0][o])}else if(t===e){if(r[l][h].length&&r[h][u].length)if(r[l][u].length){let t=Array();for(o=r[l][h][0].length;o--;)t.push(r[l][h][0][o]);for(o=r[h][u][0].length;o--;)t.push(r[h][u][0][o]);r[l][u].push(t)}else{let t=Array();for(o=r[l][h][0].length;o--;)t.push(r[l][h][0][o]);for(o=r[h][u][0].length;o--;)t.push(r[h][u][0][o]);r[l][u][0]=t}}else if(t===e-1){if(i[l][u].length){let t=Array();for(o=r[l][h][0].length;o--;)t.push(r[l][h][0][o]);for(o=r[h][u][0].length;o--;)t.push(r[h][u][0][o]);i[l][u].push(t)}else{let t=Array();for(o=r[l][h][0].length;o--;)t.push(r[l][h][0][o]);for(o=r[h][u][0].length;o--;)t.push(r[h][u][0][o]);i[l][u][0]=t}}}return{d:n,pe:r,pe_prime:i}}static getRingCandidates(t,e,n){let r=t.length,i=Array(),o=0;for(let s=0;s<r;s++)for(let a=0;a<r;a++)0===t[s][a]||1===e[s][a].length&&0===n[s][a]||(o=0!==n[s][a].length?2*(t[s][a]+.5):2*t[s][a])!==1/0&&i.push([o,e[s][a],n[s][a]]);return i.sort(function(t,e){return t[0]-e[0]}),i}static getSSSR(t,e,n,r,o,s,a,l){let u=Array(),h=Array();for(let e=0;e<t.length;e++)if(t[e][0]%2!=0)for(let r=0;r<t[e][2].length;r++){let o=t[e][1][0].concat(t[e][2][r]);for(var c=0;c<o.length;c++)o[c][0].constructor===Array&&(o[c]=o[c][0]);let g=i.bondsToAtoms(o);if(i.getBondCount(g,n)!==g.size||i.pathSetsContain(u,g,o,h,s,a)||(u.push(g),h=h.concat(o)),u.length>l)return u}else for(let r=0;r<t[e][1].length-1;r++){let o=t[e][1][r].concat(t[e][1][r+1]);for(c=0;c<o.length;c++)o[c][0].constructor===Array&&(o[c]=o[c][0]);let g=i.bondsToAtoms(o);if(i.getBondCount(g,n)!==g.size||i.pathSetsContain(u,g,o,h,s,a)||(u.push(g),h=h.concat(o)),u.length>l)return u}return u}static getEdgeCount(t){let e=0,n=t.length;for(var r=n-1;r--;)for(var i=n;i--;)1===t[r][i]&&e++;return e}static getEdgeList(t){let e=t.length,n=Array();for(var r=e-1;r--;)for(var i=e;i--;)1===t[r][i]&&n.push([r,i]);return n}static bondsToAtoms(t){let e=new Set;for(var n=t.length;n--;)e.add(t[n][0]),e.add(t[n][1]);return e}static getBondCount(t,e){let n=0;for(let r of t)for(let i of t)r!==i&&(n+=e[r][i]);return n/2}static pathSetsContain(t,e,n,r,o,s){for(var a=t.length;a--;){if(i.isSupersetOf(e,t[a]))return!0;if(t[a].size===e.size&&i.areSetsEqual(t[a],e))return!0}let l=0,u=!1;for(a=n.length;a--;)for(var h=r.length;h--;)(n[a][0]===r[h][0]&&n[a][1]===r[h][1]||n[a][1]===r[h][0]&&n[a][0]===r[h][1])&&l++,l===n.length&&(u=!0);let c=!1;if(u)for(let t of e)if(s[t]<o[t]){c=!0;break}if(u&&!c)return!0;for(let t of e)s[t]++;return!1}static areSetsEqual(t,e){if(t.size!==e.size)return!1;for(let n of t)if(!e.has(n))return!1;return!0}static isSupersetOf(t,e){for(var n of e)if(!t.has(n))return!1;return!0}}t.exports=i},function(t,e){t.exports=function(){"use strict";function t(e,n,r,i){this.message=e,this.expected=n,this.found=r,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(t,Error),t.buildMessage=function(t,e){var n={literal:function(t){return'"'+i(t.text)+'"'},class:function(t){var e,n="";for(e=0;e<t.parts.length;e++)n+=t.parts[e]instanceof Array?o(t.parts[e][0])+"-"+o(t.parts[e][1]):o(t.parts[e]);return"["+(t.inverted?"^":"")+n+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function i(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+r(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+r(t)})}function o(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+r(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+r(t)})}return"Expected "+function(t){var e,r,i,o=new Array(t.length);for(e=0;e<t.length;e++)o[e]=(i=t[e],n[i.type](i));if(o.sort(),o.length>0){for(e=1,r=1;e<o.length;e++)o[e-1]!==o[e]&&(o[r]=o[e],r++);o.length=r}switch(o.length){case 1:return o[0];case 2:return o[0]+" or "+o[1];default:return o.slice(0,-1).join(", ")+", or "+o[o.length-1]}}(t)+" but "+function(t){return t?'"'+i(t)+'"':"end of input"}(e)+" found."},{SyntaxError:t,parse:function(e,n){if(n=void 0!==n?n:{},e.split("(").length-1!=e.split(")").length-1)throw Ut("The number of opening parentheses does not match the number of closing parentheses.",0);var r,i={},o={chain:qt},s=qt,a=function(t){for(var e=[],n=[],r=0;r<t[1].length;r++)e.push(t[1][r]);for(r=0;r<t[2].length;r++){var i=t[2][r][0]?t[2][r][0]:"-";n.push({bond:i,id:t[2][r][1]})}for(r=0;r<t[3].length;r++)e.push(t[3][r]);for(r=0;r<t[6].length;r++)e.push(t[6][r]);return{atom:t[0],isBracket:!!t[0].element,branches:e,branchCount:e.length,ringbonds:n,ringbondCount:n.length,bond:t[4]?t[4]:"-",next:t[5],hasNext:!!t[5]}},l="(",u=Bt("(",!1),h=")",c=Bt(")",!1),g=function(t){var e=t[1]?t[1]:"-";return t[2].branchBond=e,t[2]},d=function(t){return t},f=/^[\-=#$:\/\\.]/,p=Ft(["-","=","#","$",":","/","\\","."],!1,!1),v=function(t){return t},m="[",y=Bt("[",!1),b="se",w=Bt("se",!1),x="as",A=Bt("as",!1),C="]",S=Bt("]",!1),M=function(t){return{isotope:t[1],element:t[2],chirality:t[3],hcount:t[4],charge:t[5],class:t[6]}},_="B",$=Bt("B",!1),T="r",R=Bt("r",!1),k="C",N=Bt("C",!1),P="l",I=Bt("l",!1),L=/^[NOPSFI]/,D=Ft(["N","O","P","S","F","I"],!1,!1),O=function(t){return t.length>1?t.join(""):t},E=/^[bcnops]/,B=Ft(["b","c","n","o","p","s"],!1,!1),F="*",j=Bt("*",!1),z=function(t){return t},H=/^[A-Z]/,U=Ft([["A","Z"]],!1,!1),V=/^[a-z]/,q=Ft([["a","z"]],!1,!1),W=function(t){return t.join("")},Y="%",X=Bt("%",!1),Z=/^[1-9]/,G=Ft([["1","9"]],!1,!1),K=/^[0-9]/,Q=Ft([["0","9"]],!1,!1),J=function(t){return 1==t.length?Number(t):Number(t.join("").replace("%",""))},tt="@",et=Bt("@",!1),nt="TH",rt=Bt("TH",!1),it=/^[12]/,ot=Ft(["1","2"],!1,!1),st="AL",at=Bt("AL",!1),lt="SP",ut=Bt("SP",!1),ht=/^[1-3]/,ct=Ft([["1","3"]],!1,!1),gt="TB",dt=Bt("TB",!1),ft="OH",pt=Bt("OH",!1),vt=function(t){return t[1]?"@"==t[1]?"@@":t[1].join("").replace(",",""):"@"},mt=function(t){return t},yt="+",bt=Bt("+",!1),wt=function(t){return t[1]?"+"!=t[1]?Number(t[1].join("")):2:1},xt="-",At=Bt("-",!1),Ct=function(t){return t[1]?"-"!=t[1]?-Number(t[1].join("")):-2:-1},St="H",Mt=Bt("H",!1),_t=function(t){return t[1]?Number(t[1]):1},$t=":",Tt=Bt(":",!1),Rt=/^[0]/,kt=Ft(["0"],!1,!1),Nt=function(t){return Number(t[1][0]+t[1][1].join(""))},Pt=function(t){return Number(t.join(""))},It=0,Lt=[{line:1,column:1}],Dt=0,Ot=[],Et=0;if("startRule"in n){if(!(n.startRule in o))throw new Error("Can't start parsing from rule \""+n.startRule+'".');s=o[n.startRule]}function Bt(t,e){return{type:"literal",text:t,ignoreCase:e}}function Ft(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function jt(t){var n,r=Lt[t];if(r)return r;for(n=t-1;!Lt[n];)n--;for(r={line:(r=Lt[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return Lt[t]=r,r}function zt(t,e){var n=jt(t),r=jt(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function Ht(t){It<Dt||(It>Dt&&(Dt=It,Ot=[]),Ot.push(t))}function Ut(e,n){return new t(e,null,null,n)}function Vt(e,n,r){return new t(t.buildMessage(e,n),e,n,r)}function qt(){var t,n,r,o,s,l,u,h,c;if(It,t=It,(n=function(){var t;return It,(t=function(){var t,n,r;return It,t=It,66===e.charCodeAt(It)?(n=_,It++):(n=i,0===Et&&Ht($)),n!==i?(114===e.charCodeAt(It)?(r=T,It++):(r=i,0===Et&&Ht(R)),r===i&&(r=null),r!==i?t=n=[n,r]:(It=t,t=i)):(It=t,t=i),t===i&&(t=It,67===e.charCodeAt(It)?(n=k,It++):(n=i,0===Et&&Ht(N)),n!==i?(108===e.charCodeAt(It)?(r=P,It++):(r=i,0===Et&&Ht(I)),r===i&&(r=null),r!==i?t=n=[n,r]:(It=t,t=i)):(It=t,t=i),t===i&&(L.test(e.charAt(It))?(t=e.charAt(It),It++):(t=i,0===Et&&Ht(D)))),t!==i&&(t=O(t)),t}())===i&&(t=Xt())===i&&(t=function(){var t,n,r,o,s,a,l,u,h;return It,t=It,91===e.charCodeAt(It)?(n=m,It++):(n=i,0===Et&&Ht(y)),n!==i?((r=function(){var t,n,r,o;return It,t=It,Z.test(e.charAt(It))?(n=e.charAt(It),It++):(n=i,0===Et&&Ht(G)),n!==i?(K.test(e.charAt(It))?(r=e.charAt(It),It++):(r=i,0===Et&&Ht(Q)),r===i&&(r=null),r!==i?(K.test(e.charAt(It))?(o=e.charAt(It),It++):(o=i,0===Et&&Ht(Q)),o===i&&(o=null),o!==i?t=n=[n,r,o]:(It=t,t=i)):(It=t,t=i)):(It=t,t=i),t!==i&&(t=Pt(t)),t}())===i&&(r=null),r!==i?(e.substr(It,2)===b?(o=b,It+=2):(o=i,0===Et&&Ht(w)),o===i&&(e.substr(It,2)===x?(o=x,It+=2):(o=i,0===Et&&Ht(A)),o===i&&(o=Xt())===i&&(o=function(){var t,n,r;return It,t=It,H.test(e.charAt(It))?(n=e.charAt(It),It++):(n=i,0===Et&&Ht(U)),n!==i?(V.test(e.charAt(It))?(r=e.charAt(It),It++):(r=i,0===Et&&Ht(q)),r===i&&(r=null),r!==i?t=n=[n,r]:(It=t,t=i)):(It=t,t=i),t!==i&&(t=W(t)),t}())===i&&(o=Zt())),o!==i?((s=function(){var t,n,r,o,s,a;return It,t=It,64===e.charCodeAt(It)?(n=tt,It++):(n=i,0===Et&&Ht(et)),n!==i?(64===e.charCodeAt(It)?(r=tt,It++):(r=i,0===Et&&Ht(et)),r===i&&(r=It,e.substr(It,2)===nt?(o=nt,It+=2):(o=i,0===Et&&Ht(rt)),o!==i?(it.test(e.charAt(It))?(s=e.charAt(It),It++):(s=i,0===Et&&Ht(ot)),s!==i?r=o=[o,s]:(It=r,r=i)):(It=r,r=i),r===i&&(r=It,e.substr(It,2)===st?(o=st,It+=2):(o=i,0===Et&&Ht(at)),o!==i?(it.test(e.charAt(It))?(s=e.charAt(It),It++):(s=i,0===Et&&Ht(ot)),s!==i?r=o=[o,s]:(It=r,r=i)):(It=r,r=i),r===i&&(r=It,e.substr(It,2)===lt?(o=lt,It+=2):(o=i,0===Et&&Ht(ut)),o!==i?(ht.test(e.charAt(It))?(s=e.charAt(It),It++):(s=i,0===Et&&Ht(ct)),s!==i?r=o=[o,s]:(It=r,r=i)):(It=r,r=i),r===i&&(r=It,e.substr(It,2)===gt?(o=gt,It+=2):(o=i,0===Et&&Ht(dt)),o!==i?(Z.test(e.charAt(It))?(s=e.charAt(It),It++):(s=i,0===Et&&Ht(G)),s!==i?(K.test(e.charAt(It))?(a=e.charAt(It),It++):(a=i,0===Et&&Ht(Q)),a===i&&(a=null),a!==i?r=o=[o,s,a]:(It=r,r=i)):(It=r,r=i)):(It=r,r=i),r===i&&(r=It,e.substr(It,2)===ft?(o=ft,It+=2):(o=i,0===Et&&Ht(pt)),o!==i?(Z.test(e.charAt(It))?(s=e.charAt(It),It++):(s=i,0===Et&&Ht(G)),s!==i?(K.test(e.charAt(It))?(a=e.charAt(It),It++):(a=i,0===Et&&Ht(Q)),a===i&&(a=null),a!==i?r=o=[o,s,a]:(It=r,r=i)):(It=r,r=i)):(It=r,r=i)))))),r===i&&(r=null),r!==i?t=n=[n,r]:(It=t,t=i)):(It=t,t=i),t!==i&&(t=vt(t)),t}())===i&&(s=null),s!==i?((a=function(){var t,n,r;return It,t=It,72===e.charCodeAt(It)?(n=St,It++):(n=i,0===Et&&Ht(Mt)),n!==i?(K.test(e.charAt(It))?(r=e.charAt(It),It++):(r=i,0===Et&&Ht(Q)),r===i&&(r=null),r!==i?t=n=[n,r]:(It=t,t=i)):(It=t,t=i),t!==i&&(t=_t(t)),t}())===i&&(a=null),a!==i?((l=function(){var t;return It,(t=function(){var t,n,r,o,s;return It,t=It,43===e.charCodeAt(It)?(n=yt,It++):(n=i,0===Et&&Ht(bt)),n!==i?(43===e.charCodeAt(It)?(r=yt,It++):(r=i,0===Et&&Ht(bt)),r===i&&(r=It,Z.test(e.charAt(It))?(o=e.charAt(It),It++):(o=i,0===Et&&Ht(G)),o!==i?(K.test(e.charAt(It))?(s=e.charAt(It),It++):(s=i,0===Et&&Ht(Q)),s===i&&(s=null),s!==i?r=o=[o,s]:(It=r,r=i)):(It=r,r=i)),r===i&&(r=null),r!==i?t=n=[n,r]:(It=t,t=i)):(It=t,t=i),t!==i&&(t=wt(t)),t}())===i&&(t=function(){var t,n,r,o,s;return It,t=It,45===e.charCodeAt(It)?(n=xt,It++):(n=i,0===Et&&Ht(At)),n!==i?(45===e.charCodeAt(It)?(r=xt,It++):(r=i,0===Et&&Ht(At)),r===i&&(r=It,Z.test(e.charAt(It))?(o=e.charAt(It),It++):(o=i,0===Et&&Ht(G)),o!==i?(K.test(e.charAt(It))?(s=e.charAt(It),It++):(s=i,0===Et&&Ht(Q)),s===i&&(s=null),s!==i?r=o=[o,s]:(It=r,r=i)):(It=r,r=i)),r===i&&(r=null),r!==i?t=n=[n,r]:(It=t,t=i)):(It=t,t=i),t!==i&&(t=Ct(t)),t}()),t!==i&&(t=mt(t)),t}())===i&&(l=null),l!==i?((u=function(){var t,n,r,o,s,a;if(It,t=It,58===e.charCodeAt(It)?(n=$t,It++):(n=i,0===Et&&Ht(Tt)),n!==i){if(r=It,Z.test(e.charAt(It))?(o=e.charAt(It),It++):(o=i,0===Et&&Ht(G)),o!==i){for(s=[],K.test(e.charAt(It))?(a=e.charAt(It),It++):(a=i,0===Et&&Ht(Q));a!==i;)s.push(a),K.test(e.charAt(It))?(a=e.charAt(It),It++):(a=i,0===Et&&Ht(Q));s!==i?r=o=[o,s]:(It=r,r=i)}else It=r,r=i;r===i&&(Rt.test(e.charAt(It))?(r=e.charAt(It),It++):(r=i,0===Et&&Ht(kt))),r!==i?t=n=[n,r]:(It=t,t=i)}else It=t,t=i;return t!==i&&(t=Nt(t)),t}())===i&&(u=null),u!==i?(93===e.charCodeAt(It)?(h=C,It++):(h=i,0===Et&&Ht(S)),h!==i?t=n=[n,r,o,s,a,l,u,h]:(It=t,t=i)):(It=t,t=i)):(It=t,t=i)):(It=t,t=i)):(It=t,t=i)):(It=t,t=i)):(It=t,t=i)):(It=t,t=i),t!==i&&(t=M(t)),t}())===i&&(t=Zt()),t!==i&&(t=d(t)),t}())!==i){for(r=[],o=Wt();o!==i;)r.push(o),o=Wt();if(r!==i){for(o=[],s=It,(l=Yt())===i&&(l=null),l!==i&&(u=Gt())!==i?s=l=[l,u]:(It=s,s=i);s!==i;)o.push(s),s=It,(l=Yt())===i&&(l=null),l!==i&&(u=Gt())!==i?s=l=[l,u]:(It=s,s=i);if(o!==i){for(s=[],l=Wt();l!==i;)s.push(l),l=Wt();if(s!==i)if((l=Yt())===i&&(l=null),l!==i)if((u=qt())===i&&(u=null),u!==i){for(h=[],c=Wt();c!==i;)h.push(c),c=Wt();h!==i?t=n=[n,r,o,s,l,u,h]:(It=t,t=i)}else It=t,t=i;else It=t,t=i;else It=t,t=i}else It=t,t=i}else It=t,t=i}else It=t,t=i;return t!==i&&(t=a(t)),t}function Wt(){var t,n,r,o,s;return It,t=It,40===e.charCodeAt(It)?(n=l,It++):(n=i,0===Et&&Ht(u)),n!==i?((r=Yt())===i&&(r=null),r!==i&&(o=qt())!==i?(41===e.charCodeAt(It)?(s=h,It++):(s=i,0===Et&&Ht(c)),s!==i?t=n=[n,r,o,s]:(It=t,t=i)):(It=t,t=i)):(It=t,t=i),t!==i&&(t=g(t)),t}function Yt(){var t;return It,f.test(e.charAt(It))?(t=e.charAt(It),It++):(t=i,0===Et&&Ht(p)),t!==i&&(t=v(t)),t}function Xt(){var t;return It,E.test(e.charAt(It))?(t=e.charAt(It),It++):(t=i,0===Et&&Ht(B)),t!==i&&(t=d(t)),t}function Zt(){var t;return It,42===e.charCodeAt(It)?(t=F,It++):(t=i,0===Et&&Ht(j)),t!==i&&(t=z(t)),t}function Gt(){var t,n,r,o;return It,t=It,37===e.charCodeAt(It)?(n=Y,It++):(n=i,0===Et&&Ht(X)),n!==i?(Z.test(e.charAt(It))?(r=e.charAt(It),It++):(r=i,0===Et&&Ht(G)),r!==i?(K.test(e.charAt(It))?(o=e.charAt(It),It++):(o=i,0===Et&&Ht(Q)),o!==i?t=n=[n,r,o]:(It=t,t=i)):(It=t,t=i)):(It=t,t=i),t===i&&(K.test(e.charAt(It))?(t=e.charAt(It),It++):(t=i,0===Et&&Ht(Q))),t!==i&&(t=J(t)),t}if((r=s())!==i&&It===e.length)return r;throw r!==i&&It<e.length&&Ht({type:"end"}),Vt(Ot,Dt<e.length?e.charAt(Dt):null,Dt<e.length?zt(Dt,Dt+1):zt(Dt,Dt))}}}()},function(t,e,n){"use strict";n.r(e);var r,i,o=n(0),s=n(8),a=0,l=0,u=0,h=1e3,c=0,g=0,d=0,f="object"==typeof performance&&performance.now?performance:Date,p="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function v(){return g||(p(m),g=f.now()+d)}function m(){g=0}function y(){this._call=this._time=this._next=null}function b(t,e,n){var r=new y;return r.restart(t,e,n),r}function w(){g=(c=f.now())+d,a=l=0;try{!function(){v(),++a;for(var t,e=r;e;)(t=g-e._time)>=0&&e._call.call(null,t),e=e._next;--a}()}finally{a=0,function(){var t,e,n=r,o=1/0;for(;n;)n._call?(o>n._time&&(o=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:r=e);i=t,A(o)}(),g=0}}function x(){var t=f.now(),e=t-c;e>h&&(d-=e,c=t)}function A(t){a||(l&&(l=clearTimeout(l)),t-g>24?(t<1/0&&(l=setTimeout(w,t-f.now()-d)),u&&(u=clearInterval(u))):(u||(c=f.now(),u=setInterval(x,h)),a=1,p(w)))}y.prototype=b.prototype={constructor:y,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?v():+n)+(null==e?0:+e),this._next||i===this||(i?i._next=this:r=this,i=this),this._call=t,this._time=n,A()},stop:function(){this._call&&(this._call=null,this._time=1/0,A())}};var C=function(t,e,n){var r=new y;return e=null==e?0:+e,r.restart(function(n){r.stop(),t(n+e)},e,n),r},S=Object(s.a)("start","end","interrupt"),M=[],_=0,$=1,T=2,R=3,k=4,N=5,P=6,I=function(t,e,n,r,i,o){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(l){var u,h,c,g;if(n.state!==$)return a();for(u in i)if((g=i[u]).name===n.name){if(g.state===R)return C(o);g.state===k?(g.state=P,g.timer.stop(),g.on.call("interrupt",t,t.__data__,g.index,g.group),delete i[u]):+u<e&&(g.state=P,g.timer.stop(),delete i[u])}if(C(function(){n.state===R&&(n.state=k,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=T,n.on.call("start",t,t.__data__,n.index,n.group),n.state===T){for(n.state=R,r=new Array(c=n.tween.length),u=0,h=-1;u<c;++u)(g=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++h]=g);r.length=h+1}}function s(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=N,1),o=-1,s=r.length;++o<s;)r[o].call(null,i);n.state===N&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var r in n.state=P,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=b(function(t){n.state=$,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)},0,n.time)}(t,n,{name:e,index:r,group:i,on:S,tween:M,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:_})};function L(t,e){var n=O(t,e);if(n.state>_)throw new Error("too late; already scheduled");return n}function D(t,e){var n=O(t,e);if(n.state>T)throw new Error("too late; already started");return n}function O(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var E=function(t,e){var n,r,i,o=t.__transition,s=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>T&&n.state<N,n.state=P,n.timer.stop(),r&&n.on.call("interrupt",t,t.__data__,n.index,n.group),delete o[i]):s=!1;s&&delete t.__transition}},B=n(2);function F(t,e,n){var r=t._id;return t.each(function(){var t=D(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return O(t,r).value[e]}}var j=n(1),z=function(t,e){var n;return("number"==typeof e?B.b:e instanceof j.a?B.c:(n=Object(j.a)(e))?(e=n,B.c):B.e)(t,e)};var H=o.selection.prototype.constructor;var U=0;function V(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function q(t){return Object(o.selection)().transition(t)}function W(){return++U}var Y=o.selection.prototype;V.prototype=q.prototype={constructor:V,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Object(o.selector)(t));for(var r=this._groups,i=r.length,s=new Array(i),a=0;a<i;++a)for(var l,u,h=r[a],c=h.length,g=s[a]=new Array(c),d=0;d<c;++d)(l=h[d])&&(u=t.call(l,l.__data__,d,h))&&("__data__"in l&&(u.__data__=l.__data__),g[d]=u,I(g[d],e,n,d,g,O(l,n)));return new V(s,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Object(o.selectorAll)(t));for(var r=this._groups,i=r.length,s=[],a=[],l=0;l<i;++l)for(var u,h=r[l],c=h.length,g=0;g<c;++g)if(u=h[g]){for(var d,f=t.call(u,u.__data__,g,h),p=O(u,n),v=0,m=f.length;v<m;++v)(d=f[v])&&I(d,e,n,v,f,p);s.push(f),a.push(u)}return new V(s,a,e,n)},filter:function(t){"function"!=typeof t&&(t=Object(o.matcher)(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s,a=e[i],l=a.length,u=r[i]=[],h=0;h<l;++h)(s=a[h])&&t.call(s,s.__data__,h,a)&&u.push(s);return new V(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var l,u=e[a],h=n[a],c=u.length,g=s[a]=new Array(c),d=0;d<c;++d)(l=u[d]||h[d])&&(g[d]=l);for(;a<r;++a)s[a]=e[a];return new V(s,this._parents,this._name,this._id)},selection:function(){return new H(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=W(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,u=0;u<l;++u)if(s=a[u]){var h=O(s,e);I(s,t,n,u,a,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new V(r,this._parents,t,n)},call:Y.call,nodes:Y.nodes,node:Y.node,size:Y.size,empty:Y.empty,each:Y.each,on:function(t,e){var n=this._id;return arguments.length<2?O(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(e)?L:D;return function(){var s=o(this,t),a=s.on;a!==r&&(i=(r=a).copy()).on(e,n),s.on=i}}(n,t,e))},attr:function(t,e){var n=Object(o.namespace)(t),r="transform"===n?B.g:z;return this.attrTween(t,"function"==typeof e?(n.local?function(t,e,n){var r,i,o;return function(){var s,a=n(this);if(null!=a)return(s=this.getAttributeNS(t.space,t.local))===a?null:s===r&&a===i?o:o=e(r=s,i=a);this.removeAttributeNS(t.space,t.local)}}:function(t,e,n){var r,i,o;return function(){var s,a=n(this);if(null!=a)return(s=this.getAttribute(t))===a?null:s===r&&a===i?o:o=e(r=s,i=a);this.removeAttribute(t)}})(n,r,F(this,"attr."+t,e)):null==e?(n.local?function(t){return function(){this.removeAttributeNS(t.space,t.local)}}:function(t){return function(){this.removeAttribute(t)}})(n):(n.local?function(t,e,n){var r,i;return function(){var o=this.getAttributeNS(t.space,t.local);return o===n?null:o===r?i:i=e(r=o,n)}}:function(t,e,n){var r,i;return function(){var o=this.getAttribute(t);return o===n?null:o===r?i:i=e(r=o,n)}})(n,r,e+""))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=Object(o.namespace)(t);return this.tween(n,(r.local?function(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttributeNS(t.space,t.local,r(e))}}return n._value=e,n}:function(t,e){function n(){var n=this,r=e.apply(n,arguments);return r&&function(e){n.setAttribute(t,r(e))}}return n._value=e,n})(r,e))},style:function(t,e,n){var r="transform"==(t+="")?B.f:z;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var s=Object(o.style)(this,t),a=(this.style.removeProperty(t),Object(o.style)(this,t));return s===a?null:s===n&&a===r?i:i=e(n=s,r=a)}}(t,r)).on("end.style."+t,function(t){return function(){this.style.removeProperty(t)}}(t)):this.styleTween(t,"function"==typeof e?function(t,e,n){var r,i,s;return function(){var a=Object(o.style)(this,t),l=n(this);return null==l&&(this.style.removeProperty(t),l=Object(o.style)(this,t)),a===l?null:a===r&&l===i?s:s=e(r=a,i=l)}}(t,r,F(this,"style."+t,e)):function(t,e,n){var r,i;return function(){var s=Object(o.style)(this,t);return s===n?null:s===r?i:i=e(r=s,n)}}(t,r,e+""),n)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){function r(){var r=this,i=e.apply(r,arguments);return i&&function(e){r.style.setProperty(t,i(e),n)}}return r._value=e,r}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(F(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=O(this.node(),n).tween,o=0,s=i.length;o<s;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?function(t,e){var n,r;return function(){var i=D(this,t),o=i.tween;if(o!==n)for(var s=0,a=(r=n=o).length;s<a;++s)if(r[s].name===e){(r=r.slice()).splice(s,1);break}i.tween=r}}:function(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=D(this,t),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=a;break}l===u&&i.push(a)}o.tween=i}})(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){L(this,t).delay=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){L(this,t).delay=e}})(e,t)):O(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?function(t,e){return function(){D(this,t).duration=+e.apply(this,arguments)}}:function(t,e){return e=+e,function(){D(this,t).duration=e}})(e,t)):O(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){D(this,t).ease=e}}(e,t)):O(this.node(),e).ease}};(function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n})(3),function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(3),function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(3),Math.PI;(function t(e){function n(t){return t*t*((e+1)*t-e)}return e=+e,n.overshoot=t,n})(1.70158),function t(e){function n(t){return--t*t*((e+1)*t+e)+1}return e=+e,n.overshoot=t,n}(1.70158),function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(1.70158);var X=2*Math.PI,Z=(function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=X);function i(t){return e*Math.pow(2,10*--t)*Math.sin((r-t)/n)}return i.amplitude=function(e){return t(e,n*X)},i.period=function(n){return t(e,n)},i}(1,.3),function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=X);function i(t){return 1-e*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/n)}return i.amplitude=function(e){return t(e,n*X)},i.period=function(n){return t(e,n)},i}(1,.3),function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=X);function i(t){return((t=2*t-1)<0?e*Math.pow(2,10*t)*Math.sin((r-t)/n):2-e*Math.pow(2,-10*t)*Math.sin((r+t)/n))/2}return i.amplitude=function(e){return t(e,n*X)},i.period=function(n){return t(e,n)},i}(1,.3),{time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}});function G(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return Z.time=v(),Z;return n}o.selection.prototype.interrupt=function(t){return this.each(function(){E(this,t)})},o.selection.prototype.transition=function(t){var e,n;t instanceof V?(e=t._id,t=t._name):(e=W(),(n=Z).time=v(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,u=0;u<l;++u)(s=a[u])&&I(s,t,e,u,a,n||G(s,e));return new V(r,this._parents,t,e)};var K=[null],Q=function(t,e){var n,r,i=t.__transition;if(i)for(r in e=null==e?null:e+"",i)if((n=i[r]).state>$&&n.name===e)return new V([[t]],K,e,+r);return null};n.d(e,"transition",function(){return q}),n.d(e,"active",function(){return Q}),n.d(e,"interrupt",function(){return E})},function(t,e,n){"use strict";n.r(e);var r=n(8),i=n(0);function o(){i.event.stopImmediatePropagation()}var s=function(){i.event.preventDefault(),i.event.stopImmediatePropagation()},a=function(t){var e=t.document.documentElement,n=Object(i.select)(t).on("dragstart.drag",s,!0);"onselectstart"in e?n.on("selectstart.drag",s,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function l(t,e){var n=t.document.documentElement,r=Object(i.select)(t).on("dragstart.drag",null);e&&(r.on("click.drag",s,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var u=function(t){return function(){return t}};function h(t,e,n,r,i,o,s,a,l,u){this.target=t,this.type=e,this.subject=n,this.identifier=r,this.active=i,this.x=o,this.y=s,this.dx=a,this.dy=l,this._=u}function c(){return!i.event.button}function g(){return this.parentNode}function d(t){return null==t?{x:i.event.x,y:i.event.y}:t}function f(){return"ontouchstart"in this}h.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var p=function(){var t,e,n,p,v=c,m=g,y=d,b=f,w={},x=Object(r.a)("start","drag","end"),A=0,C=0;function S(t){t.on("mousedown.drag",M).filter(b).on("touchstart.drag",T).on("touchmove.drag",R).on("touchend.drag touchcancel.drag",k).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function M(){if(!p&&v.apply(this,arguments)){var r=N("mouse",m.apply(this,arguments),i.mouse,this,arguments);r&&(Object(i.select)(i.event.view).on("mousemove.drag",_,!0).on("mouseup.drag",$,!0),a(i.event.view),o(),n=!1,t=i.event.clientX,e=i.event.clientY,r("start"))}}function _(){if(s(),!n){var r=i.event.clientX-t,o=i.event.clientY-e;n=r*r+o*o>C}w.mouse("drag")}function $(){Object(i.select)(i.event.view).on("mousemove.drag mouseup.drag",null),l(i.event.view,n),s(),w.mouse("end")}function T(){if(v.apply(this,arguments)){var t,e,n=i.event.changedTouches,r=m.apply(this,arguments),s=n.length;for(t=0;t<s;++t)(e=N(n[t].identifier,r,i.touch,this,arguments))&&(o(),e("start"))}}function R(){var t,e,n=i.event.changedTouches,r=n.length;for(t=0;t<r;++t)(e=w[n[t].identifier])&&(s(),e("drag"))}function k(){var t,e,n=i.event.changedTouches,r=n.length;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),t=0;t<r;++t)(e=w[n[t].identifier])&&(o(),e("end"))}function N(t,e,n,r,o){var s,a,l,u=n(e,t),c=x.copy();if(Object(i.customEvent)(new h(S,"beforestart",s,t,A,u[0],u[1],0,0,c),function(){return null!=(i.event.subject=s=y.apply(r,o))&&(a=s.x-u[0]||0,l=s.y-u[1]||0,!0)}))return function g(d){var f,p=u;switch(d){case"start":w[t]=g,f=A++;break;case"end":delete w[t],--A;case"drag":u=n(e,t),f=A}Object(i.customEvent)(new h(S,d,s,t,f,u[0]+a,u[1]+l,u[0]-p[0],u[1]-p[1],c),c.apply,c,[d,r,o])}}return S.filter=function(t){return arguments.length?(v="function"==typeof t?t:u(!!t),S):v},S.container=function(t){return arguments.length?(m="function"==typeof t?t:u(t),S):m},S.subject=function(t){return arguments.length?(y="function"==typeof t?t:u(t),S):y},S.touchable=function(t){return arguments.length?(b="function"==typeof t?t:u(!!t),S):b},S.on=function(){var t=x.on.apply(x,arguments);return t===x?S:t},S.clickDistance=function(t){return arguments.length?(C=(t=+t)*t,S):Math.sqrt(C)},S};n.d(e,"drag",function(){return p}),n.d(e,"dragDisable",function(){return a}),n.d(e,"dragEnable",function(){return l})},function(t,e,n){"use strict";n.r(e);var r=Array.prototype.slice,i=function(t){return t},o=1,s=2,a=3,l=4,u=1e-6;function h(t){return"translate("+(t+.5)+",0)"}function c(t){return"translate(0,"+(t+.5)+")"}function g(){return!this.__axis}function d(t,e){var n=[],d=null,f=null,p=6,v=6,m=3,y=t===o||t===l?-1:1,b=t===l||t===s?"x":"y",w=t===o||t===a?h:c;function x(r){var h=null==d?e.ticks?e.ticks.apply(e,n):e.domain():d,c=null==f?e.tickFormat?e.tickFormat.apply(e,n):i:f,x=Math.max(p,0)+m,A=e.range(),C=+A[0]+.5,S=+A[A.length-1]+.5,M=(e.bandwidth?function(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}:function(t){return function(e){return+t(e)}})(e.copy()),_=r.selection?r.selection():r,$=_.selectAll(".domain").data([null]),T=_.selectAll(".tick").data(h,e).order(),R=T.exit(),k=T.enter().append("g").attr("class","tick"),N=T.select("line"),P=T.select("text");$=$.merge($.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),T=T.merge(k),N=N.merge(k.append("line").attr("stroke","currentColor").attr(b+"2",y*p)),P=P.merge(k.append("text").attr("fill","currentColor").attr(b,y*x).attr("dy",t===o?"0em":t===a?"0.71em":"0.32em")),r!==_&&($=$.transition(r),T=T.transition(r),N=N.transition(r),P=P.transition(r),R=R.transition(r).attr("opacity",u).attr("transform",function(t){return isFinite(t=M(t))?w(t):this.getAttribute("transform")}),k.attr("opacity",u).attr("transform",function(t){var e=this.parentNode.__axis;return w(e&&isFinite(e=e(t))?e:M(t))})),R.remove(),$.attr("d",t===l||t==s?v?"M"+y*v+","+C+"H0.5V"+S+"H"+y*v:"M0.5,"+C+"V"+S:v?"M"+C+","+y*v+"V0.5H"+S+"V"+y*v:"M"+C+",0.5H"+S),T.attr("opacity",1).attr("transform",function(t){return w(M(t))}),N.attr(b+"2",y*p),P.attr(b,y*x).text(c),_.filter(g).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===s?"start":t===l?"end":"middle"),_.each(function(){this.__axis=M})}return x.scale=function(t){return arguments.length?(e=t,x):e},x.ticks=function(){return n=r.call(arguments),x},x.tickArguments=function(t){return arguments.length?(n=null==t?[]:r.call(t),x):n.slice()},x.tickValues=function(t){return arguments.length?(d=null==t?null:r.call(t),x):d&&d.slice()},x.tickFormat=function(t){return arguments.length?(f=t,x):f},x.tickSize=function(t){return arguments.length?(p=v=+t,x):p},x.tickSizeInner=function(t){return arguments.length?(p=+t,x):p},x.tickSizeOuter=function(t){return arguments.length?(v=+t,x):v},x.tickPadding=function(t){return arguments.length?(m=+t,x):m},x}function f(t){return d(o,t)}function p(t){return d(s,t)}function v(t){return d(a,t)}function m(t){return d(l,t)}n.d(e,"axisTop",function(){return f}),n.d(e,"axisRight",function(){return p}),n.d(e,"axisBottom",function(){return v}),n.d(e,"axisLeft",function(){return m})},function(t,e,n){"use strict";n.r(e);var r=Math.PI,i=2*r,o=i-1e-6;function s(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function a(){return new s}s.prototype=a.prototype={constructor:s,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,i,o){t=+t,e=+e,n=+n,i=+i,o=+o;var s=this._x1,a=this._y1,l=n-t,u=i-e,h=s-t,c=a-e,g=h*h+c*c;if(o<0)throw new Error("negative radius: "+o);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(g>1e-6)if(Math.abs(c*l-u*h)>1e-6&&o){var d=n-s,f=i-a,p=l*l+u*u,v=d*d+f*f,m=Math.sqrt(p),y=Math.sqrt(g),b=o*Math.tan((r-Math.acos((p+g-v)/(2*m*y)))/2),w=b/y,x=b/m;Math.abs(w-1)>1e-6&&(this._+="L"+(t+w*h)+","+(e+w*c)),this._+="A"+o+","+o+",0,0,"+ +(c*d>h*f)+","+(this._x1=t+x*l)+","+(this._y1=e+x*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,s,a,l){t=+t,e=+e;var u=(n=+n)*Math.cos(s),h=n*Math.sin(s),c=t+u,g=e+h,d=1^l,f=l?s-a:a-s;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+g:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-g)>1e-6)&&(this._+="L"+c+","+g),n&&(f<0&&(f=f%i+i),f>o?this._+="A"+n+","+n+",0,1,"+d+","+(t-u)+","+(e-h)+"A"+n+","+n+",0,1,"+d+","+(this._x1=c)+","+(this._y1=g):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=r)+","+d+","+(this._x1=t+n*Math.cos(a))+","+(this._y1=e+n*Math.sin(a))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var l=a;n.d(e,"path",function(){return l})}]);